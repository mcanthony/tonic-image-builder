<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Tonic Image Builder</title>
  <meta name="description" content="JavaScript library meant to gather algorithms for image generation.">

  <link rel="stylesheet" href="/tonic-image-builder/css/main.css">
  <link rel="stylesheet" href="assets_/css/shCore.css">
  <link rel="stylesheet" href="assets_/css/shThemeDefault.css">
  <link rel="stylesheet" href="assets_/css/main.css">
</head>

<body data-root-path="">

<header class="site-header">

    <nav class="mobile-nav show-on-mobiles">
        <a class="page-link" href="/tonic-image-builder/"><i class="fa fa-home fa-fw fa-lg"></i></a>
        <a class="page-link" href="/tonic-image-builder/docs/home"><i class="fa fa-book fa-fw fa-lg"></i></a>
        <a class="page-link" href="/tonic-image-builder/news"><i class="fa fa-newspaper-o fa-fw fa-lg"></i></a>
    </nav>
    <div class="wrapper">

        <a class="site-title center-on-mobiles" href="/">
            <img src="/tonic-image-builder/img/logo.png" height="40" alt="Logo">
            Tonic Image Builder
        </a>
        <nav class="site-nav hide-on-mobiles">
            <a href="#" class="menu-icon">
                <svg viewBox="0 0 18 15">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </a>
            <div class="trigger">
                <a class="page-link" href="/tonic-image-builder/">Home</a>
                <a class="page-link" href="/tonic-image-builder/docs/home">Docs</a>
                <a class="page-link" href="/tonic-image-builder/news">News</a>
            </div>
        </nav>
    </div>

</header>

<div class="wrapper">
    <nav class="docs-nav hide-on-mobiles">
        <a href="#" class="menu-icon">
            <svg viewBox="0 0 18 15">
                <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
        </a>
    </nav>
</div>
<div id="wrapper">
   <div id="content">
<ul id="topnav">
    <li><a href="index.html">Index</a></li>
    <li><a href="#toc">TOC</a></li>
</ul>
<h1>WebGlCompositeImageBuilder</h1>

<p>Similar image builder as the CompositeImageBuilder except that it is using WebGL
code based to do the compositing and support different data structures.</p>

<pre class="brush:js">
var WebGlCompositeImageBuilder = require('tonic-image-builder/lib/builder/WebGlComposite'),
    instance = new WebGlCompositeImageBuilder(queryDataModel, pipelineModel, lookupTableManager);
</pre>

<h2>Table of Contents <a href="#toc" name="toc" class="deep-link">#</a></h2>

<ul>
<li><a href="#constructor">constructor()</a></li>
<li><a href="#update">update()</a></li>
<li><a href="#setPushMethodAsBuffer">setPushMethodAsBuffer()</a></li>
<li><a href="#setPushMethodAsImage">setPushMethodAsImage()</a></li>
<li><a href="#setPipelineQuery">setPipelineQuery()</a></li>
<li><a href="#render">render()</a></li>
<li><a href="#onImageReady">onImageReady()</a></li>
<li><a href="#destroy">destroy()</a></li>
<li><a href="#setLightProperties">setLightProperties()</a></li>
<li><a href="#getListeners">getListeners</a></li>
<li><a href="#getControlWidgets">getControlWidgets</a></li>
<li><a href="#getQueryDataModel">getQueryDataModel</a></li>
<li><a href="#getPipelineModel">getPipelineModel</a></li>
<li><a href="#getLookupTableManager">getLookupTableManager()</a></li>
<li><a href="#getLightProperties">getLightProperties()</a></li>
</ul>

<h2>constructor(queryDataModel, pipelineModel, lookupTableManager) <a href="#constructor" id="constructor" class="deep-link">#</a></h2>

<p>Create an instance of a CompositeImageBuilder using the associated
<strong>queryDataModel</strong> that should be used to fetch the data.</p>

<p>And the <strong>pipelineModel</strong> that should be used for controlling the ImageBuilder.</p>

<p>Under the hood this will create an off-screen canvas for the image generation.
Then, depending if the method setPushMethodAsImage() has been called,
the 'image-ready' notification will not contain the same object.
By default we use the setPushMethodAsBuffer() configuration.</p>

<p>Below are the two event structures</p>

<pre class="brush:js">
// setPushMethodAsBuffer()
var eventAsBuffer = {
    canvas: DOMElement,
    imageData: ImageDataFromCanvas,
    area: [0, 0, width, height],
    outputSize: [width, height],
    type: 'composite'
};

// setPushMethodAsImage()
var eventAsImage = {
    url: 'data:image/png:ASDGFsdfgsdgf...'
    type: 'composite'
};
</pre>

<h2>update() <a href="#update" id="update" class="deep-link">#</a></h2>

<p>Trigger the fetching of the data (composite.json + rgb.jpg).</p>

<h2>setPushMethodAsBuffer() <a href="#setPushMethodAsBuffer" id="setPushMethodAsBuffer" class="deep-link">#</a></h2>

<p>Change the method to share the image to the outside world.
After that method get called, the notification event will look as follow.</p>

<pre class="brush:js">
{
    canvas: DOMElement,
    imageData: ImageDataFromCanvas,
    area: [0, 0, width, height],
    outputSize: [width, height],
    type: 'composite'
}
</pre>

<h2>setPushMethodAsImage() <a href="#setPushMethodAsImage" id="setPushMethodAsImage" class="deep-link">#</a></h2>

<p>Change the method to share the image to the outside world.
After the method gets called, the notification event will look as follows:</p>

<pre class="brush:js">
{
    url: 'data:image/png:ASDGFsdfgsdgf...'
    type: 'composite'
}
</pre>

<h2>setPipelineQuery(pipelineQuery) <a href="#setPipelineQuery" id="setPipelineQuery" class="deep-link">#</a></h2>

<p>Should be called each time the pipeline setting is changed.</p>

<p>The <strong>pipelineQuery</strong> is a string that encodes the pipeline configuration such as
which layer is visible or not and which field should be rendered for a given layer.</p>

<p>The <strong>pipelineQuery</strong> is structured as follows:</p>

<pre class="brush:js">
var pipelineQuery = "A_BBCAD_EA";

// In that example we have the following setting
var layerSettings = [
    "A_", // Layer A is invisible
    "BB", // Layer B is using field B
    "CA", // Layer C is using field A
    "D_", // Layer D is invisible
    "EA"  // Layer E is using field A
];
</pre>

<h2>render() <a href="#render" id="render" class="deep-link">#</a></h2>

<p>Process the current set of loaded data and render it into the background canvas.
Once done, an event gets triggered to let the application know that the image is
ready to be rendered/displayed somewhere.</p>

<h2>onImageReady(callback) : subscription <a href="#onImageReady" id="onImageReady" class="deep-link">#</a></h2>

<p>Allows the registration of a <strong>callback(data, envelope)</strong> function when the
actual generated image is ready.</p>

<h2>destroy() <a href="#destroy" id="destroy" class="deep-link">#</a></h2>

<p>Free the internal resources of the current instance.</p>

<h2>setLightProperties(lightProps) <a href="#setLightProperties" id="setLightProperties" class="deep-link">#</a></h2>

<pre class="brush:js">
{
    'lightTerms': {
        ka: 0.1,
        kd: 0.6,
        ks: 0.3,
        alpha: 20
    },
    'lightPosition': {
        x: -1,
        y: 1
    },
    'lightColor': [ 0.8, 0.8, 0.8 ]
}
</pre>

<h2>getListeners <a href="#getListeners" id="getListeners" class="deep-link">#</a></h2>

<p>Returns a list of TonicMouseHandler listeners.</p>

<h2>getControlWidgets <a href="#getControlWidgets" id="getControlWidgets" class="deep-link">#</a></h2>

<p>Returns an array of control widgets, that is meant to be used with the
WidgetFactory.</p>

<h2>getQueryDataModel <a href="#getQueryDataModel" id="getQueryDataModel" class="deep-link">#</a></h2>

<p>Returns the builder's QueryDataModel.</p>

<h2>getPipelineModel <a href="#getPipelineModel" id="getPipelineModel" class="deep-link">#</a></h2>

<p>Returns the builder's PipelineModel.</p>

<h2>getLookupTableManager() <a href="#getLookupTableManager" id="getLookupTableManager" class="deep-link">#</a></h2>

<p>Returns the builder's LookupTableManager.</p>

<h2>getLightProperties() : {} <a href="#getLightProperties" id="getLightProperties" class="deep-link">#</a></h2>

<p>Return the current set of light properties if any.</p>
        </div>
        <script src="assets_/js/lib/jquery.js"></script>
        <script src="assets_/js/lib/syntax-highlighter/shCore.js"></script>
        <script src="assets_/js/lib/syntax-highlighter/shAutoloader.js"></script>
        <script src="assets_/js/main.js"></script>
    </body>
</html>
