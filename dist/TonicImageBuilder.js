!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){(function(e){t.exports=e.TonicImageBuilder=r(20)}).call(e,function(){return this}())},function(t,e){t.exports="\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n    gl_Position = vec4(a_position.xy, 0.0, 1.0);\n    v_texCoord = a_texCoord;\n}\n"},function(t,e,r){var n,i;!function(o,a){n=[r(51),r(52)],i=function(t,e){return a(t,e,o)}.apply(e,n),!(void 0!==i&&(t.exports=i))}(this,function(t,e,r,n){function i(t,e){return function(){if(console.warn||console.log){var r="Warning, the "+t+" method has been deprecated. Please use "+e+" instead.";console.warn?console.warn(r):console.log(r)}return c.prototype[e].apply(this,arguments)}}function o(t,e,r){return function(n){b.resolver.compare(n.topic,t)&&(e.push(n),n.cacheKeys.push(t),r&&r(n))}}function a(t,e,r){return function(n,i,o){n===t&&o.splice(i,1),0===o.length&&delete r[e]}}function s(e,r,n,i){if(e.inactive=!0,i.splice(n,1),e.cacheKeys&&e.cacheKeys.length)for(var o;o=e.cacheKeys.pop();)t.each(r._cache[o],a(e,o,r._cache))}var u="|",l={cache:{},regex:{},compare:function(e,r){var n,i,o,a=this.cache[r+u+e];return a===!0?a:-1===e.indexOf("#")&&-1===e.indexOf("*")?a=this.cache[r+u+e]=r===e:((i=this.regex[e])||(n="^"+t.map(e.split("."),function(t){var e="";return o&&(e="#"!==o?"\\.\\b":"\\b"),e+="#"===t?"[\\s\\S]*":"*"===t?"[^.]+":t,o=t,e}).join("")+"$",i=this.regex[e]=new RegExp(n)),a=this.cache[r+u+e]=i.test(r))},reset:function(){this.cache={},this.regex={}},purge:function(e){var r=this,n=function(t,n){var i=n.split(u),o=i[0],a=i[1];"undefined"!=typeof e.topic&&e.topic!==o||"undefined"!=typeof e.binding&&e.binding!==a||delete r.cache[n]};"undefined"==typeof e?this.reset():t.each(this.cache,n)}},c=function(t,e,r){this.topic=t,this.callback=e,this.pipeline=[],this.cacheKeys=[],this._context=n,this.emitter=r},h=function(){var e;return function(r){var n=!1;return t.isString(r)?(n=r===e,e=r):(n=t.isEqual(r,e),e=t.clone(r)),!n}},f=function(){var e=[];return function(r){var n=!t.any(e,function(e){return t.isObject(r)||t.isArray(r)?t.isEqual(r,e):r===e});return n&&e.push(r),n}};c.prototype={"catch":function(t){var e=this.callback,r=function(){try{e.apply(this,arguments)}catch(r){t(r,arguments[0])}};return this.callback=r,this},defer:function(){return this.delay(0)},disposeAfter:function(e){if(!t.isNumber(e)||0>=e)throw new Error("The value provided to disposeAfter (maxCalls) must be a number greater than zero.");var r=this,n=t.after(e,t.bind(function(){r.unsubscribe()}));return r.pipeline.push(function(t,e,r){r(t,e),n()}),r},distinct:function(){return this.constraint(new f)},distinctUntilChanged:function(){return this.constraint(new h)},invokeSubscriber:function(t,e){if(!this.inactive){var r=this,n=r.pipeline,i=n.length,o=r._context,a=-1;if(i){n=n.concat([r.callback]);var s=function u(t,e){a+=1,i>a?n[a].call(o,t,e,u):r.callback.call(o,t,e)};s(t,e,0)}else r.callback.call(o,t,e)}},logError:function(){if(console){var t;t=console.warn?console.warn:console.log,this["catch"](t)}return this},once:function(){return this.disposeAfter(1)},unsubscribe:function(){this.inactive||this.emitter.off(this)},constraint:function(e){if(!t.isFunction(e))throw new Error("Predicate constraint must be a function");return this.pipeline.push(function(t,r,n){e.call(this,t,r)&&n(t,r)}),this},constraints:function(e){var r=this;return t.isArray(e)&&t.each(e,function(t){r.constraint(t)}),r},context:function(t){return this._context=t,this},debounce:function(e,r){if(!t.isNumber(e))throw new Error("Milliseconds must be a number");return this.pipeline.push(t.debounce(function(t,e,r){r(t,e)},e,!!r)),this},delay:function(e){if(!t.isNumber(e))throw new Error("Milliseconds must be a number");var r=this;return r.pipeline.push(function(t,r,n){setTimeout(function(){n(t,r)},e)}),this},throttle:function(e){if(!t.isNumber(e))throw new Error("Milliseconds must be a number");var r=function(t,e,r){r(t,e)};return this.pipeline.push(t.throttle(r,e)),this}},c.prototype.off=c.prototype.unsubscribe;for(var g=["withConstraint","withConstraints","withContext","withDebounce","withDelay","withThrottle"],p=["constraint","constraints","context","debounce","delay","throttle"],d=0;6>d;d++){var v=g[d];c.prototype[v]=i(v,p[d])}var m=Array.prototype.slice,b=function(){};return b.prototype={on:function(e,r){var n=this;n._subscriptions=n._subscriptions||{},n._subscriptions[e]=n._subscriptions[e]||[];var i=new c(e,r,n);return n._subscriptions[e].push(i),t.each(n._cache,function(t,e){o(e,t)(i)}),n._subscriptions[e][n._subscriptions[e].length-1]},once:function(t,e){return this.on(t,e).once()},off:function(e,r){var n=this;switch(n._subscriptions=n._subscriptions||{},n._cache=n._cache||{},arguments.length){case 0:t.each(n._subscriptions,function(e){t.each(e,function(t,r){s(t,n,r,e)})}),n._subscriptions={};break;case 1:var i="[object String]"===Object.prototype.toString.call(e)?"topic":e instanceof c?"def":"context";switch(i){case"topic":n._subscriptions[e]&&t.each(n._subscriptions[e],function(t,r){s(t,n,r,n._subscriptions[e])});break;case"context":t.each(n._subscriptions,function(r){t.each(t.clone(r),function(t,i){t._context===e&&s(t,n,i,r)})});break;default:t.each(n._subscriptions[e.topic],function(t,r){t===e&&s(t,n,r,n._subscriptions[e.topic])})}break;default:t.each(t.clone(n._subscriptions[e]),function(t,i){t._context===r&&s(t,n,i,n._subscriptions[e])})}},emit:function(e,r){var n=this.getEnvelope(e,r);this._cache=this._cache||{};var i=this._cache[e],a=function(t){t.invokeSubscriber(n.data,n)};if(i)t.each(m.call(i,0),a);else{i=this._cache[e]=[];var s=o(e,i,a);t.each(this._subscriptions,function(e){t.each(m.call(e,0),s)})}},getEnvelope:function(t,e){return{topic:t,timeStamp:new Date,data:e}}},b.resolver=l,b.debug=!1,b.SubscriptionDefinition=c,e(b),b.mixInto=function(t){e.punch(t,b.prototype)},b})},function(t,e){"use strict";function r(t,e){this.id="CanvasOffscreenBuffer_"+ ++n,this.el=document.createElement("canvas"),this.width=t,this.height=e,this.el.style.display="none",this.el.setAttribute("width",this.width),this.el.setAttribute("height",this.height),document.body.appendChild(this.el)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var n=0;r.prototype.size=function(t,e){return t&&this.el.setAttribute("width",this.width=t),e&&this.el.setAttribute("height",this.height=e),[Number(this.width),Number(this.height)]},r.prototype.get2DContext=function(){return this.el.getContext("2d")},r.prototype.get3DContext=function(){var t=arguments.length<=0||void 0===arguments[0]?{preserveDrawingBuffer:!0,premultipliedAlpha:!1}:arguments[0];return this.el.getContext("webgl",t)||this.el.getContext("experimental-webgl",t)},r.prototype.destroy=function(){this.el.parentNode.removeChild(this.el),this.el=null,this.width=null,this.height=null},r.prototype.toDataURL=function(t,e){return this.el.toDataURL(t,e)},t.exports=e["default"]},function(t,e){"use strict";function r(t){var e=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),r=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),n=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);console.log("vertex texture image units: "+e),console.log("fragment texture image units: "+r),console.log("combined texture image units: "+n)}function n(t,e,r){var n=t.createShader(r);t.shaderSource(n,e),t.compileShader(n);var i=t.getShaderParameter(n,t.COMPILE_STATUS);if(!i){var o=t.getShaderInfoLog(n);return console.error("Error compiling shader '"+n+"':"+o),t.deleteShader(n),null}return n}function i(t,e){for(var r=t.createProgram(),n=0;n<e.length;n+=1)t.attachShader(r,e[n]);t.linkProgram(r);var i=t.getProgramParameter(r,t.LINK_STATUS);if(!i){var o=t.getProgramInfoLog(r);return console.error("Error in program linking:"+o),t.deleteProgram(r),null}return r.shaders=e,t.useProgram(r),r}function o(t,e,r,o){var a=r.programs[e],s=n(t,a.vertexShader,t.VERTEX_SHADER),u=n(t,a.fragmentShader,t.FRAGMENT_SHADER),c=i(t,[s,u]);return o.programs[e]=c,a.mapping&&l(t,e,a.mapping,r,o),c}function a(t,e,r){t.bindFramebuffer(t.FRAMEBUFFER,e),t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.width,e.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var n=t.checkFramebufferStatus(t.FRAMEBUFFER);n!==t.FRAMEBUFFER_COMPLETE&&console.log("ERROR: There is a problem with the framebuffer: "+n),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)}function s(t){var e=t.gl;for(var r in t.programs){for(var n=t.programs[r],i=n.shaders,o=i.length;o--;)e.deleteShader(i[o]);e.deleteProgram(n)}for(var a in t.framebuffers)e.deleteFramebuffer(t.framebuffers[a]);for(var s in t.textures)e.deleteTexture(t.textures[s]);for(var u in t.buffers)e.deleteBuffer(t.buffers[u])}function u(t,e){var r={gl:t,buffers:{},textures:{},framebuffers:{},programs:{}},n=e.resources.buffers||[],i=e.resources.textures||[],a=e.resources.framebuffers||[];n.forEach(function(e){var n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e.data,t.STATIC_DRAW),r.buffers[e.id]=n}),i.forEach(function(e){var n=t.createTexture(),i=e.pixelStore||[],o=e.texParameter||[];t.bindTexture(t.TEXTURE_2D,n),i.forEach(function(e){t.pixelStorei(t[e[0]],e[1])}),o.forEach(function(e){t.texParameteri(t.TEXTURE_2D,t[e[0]],t[e[1]])}),r.textures[e.id]=n}),a.forEach(function(e){var n=t.createFramebuffer();n.width=e.width,n.height=e.height,r.framebuffers[e.id]=n});for(var u in e.programs)o(t,u,e,r);return r.destroy=function(){s(r)},r}function l(t,e,r,n,i){var o=i.programs[e],a=n.mappings[r];a.forEach(function(e){var r=i.buffers[e.id];t.bindBuffer(t.ARRAY_BUFFER,r),o[e.name]=t.getAttribLocation(o,e.attribute),t.enableVertexAttribArray(o[e.name]),t.vertexAttribPointer.apply(t,[o[e.name]].concat(e.format)),t.bindBuffer(t.ARRAY_BUFFER,null)})}function c(t,e,r){this.gl=t,this.idx=0,this.fbos=e,this.textures=r,a(this.gl,this.fbos[0],this.textures[1]),a(this.gl,this.fbos[1],this.textures[0])}function h(t,e,r){for(var n in e){var i=e[n],o=RegExp("\\$\\{"+n+"\\}","g");t=t.replace(o,i)}if(r.inlineLoops)for(var a=/\/\/@INLINE_LOOP([\s\S]+?)(?=\/\/@INLINE_LOOP)\/\/@INLINE_LOOP/,s=t.match(a);s;){for(var u=(s[0],s[1]),l=/^\s*\(([^\),]+)\s*,\s*([^\),]+)\s*,\s*([^\)]+)\)/,c=u.match(l),h=c[1],f=c[2],g=c[3],p=u.replace(l,""),d=/^\s*[^\{]+\{([\s\S]+?)\s*\}\s*$/,v=p.match(d),m=v[1],b="",y=new RegExp(h,"g"),_=f;g>_;++_)b+=m.replace(y,_),b+="\n";t=t.replace(a,b),s=t.match(a)}return r.debug&&(console.log("Transformed shader string:"),console.log(t)),t}Object.defineProperty(e,"__esModule",{value:!0}),e.showGlInfo=r,e.bindTextureToFramebuffer=a,e.createGLResources=u,e.applyProgramDataMapping=l,e.PingPong=c,e.TransformShader=h,c.prototype.swap=function(){this.idx++,this.idx%=2},c.prototype.clearFbo=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[0]),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[1]),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.idx=0},c.prototype.getFramebuffer=function(){return this.fbos[this.idx]},c.prototype.getRenderingTexture=function(){return this.textures[this.idx]}},function(t,e,r){function n(t,e){return i(o(t),e)}var i=r(53),o=r(62);t.exports=n},function(t,e,r){(function(t,n){function i(t,e){this._id=t,this._clearFn=e}var o=r(42).nextTick,a=Function.prototype.apply,s=Array.prototype.slice,u={},l=0;e.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var r=l++,n=arguments.length<2?!1:s.call(arguments,1);return u[r]=!0,o(function(){u[r]&&(n?t.apply(null,n):t.call(null),e.clearImmediate(r))}),r},e.clearImmediate="function"==typeof n?n:function(t){delete u[t]}}).call(e,r(6).setImmediate,r(6).clearImmediate)},function(t,e){t.exports="\nprecision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\n\nvoid main() {\n    vec4 color = texture2D(u_image, v_texCoord);\n    gl_FragColor = vec4(color.rgb, 1.0);\n}\n"},function(t,e){function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=r},function(t,e,r){var n;n=function(){function t(t){return null===t?"Null":t===e?"Undefined":r.exec(n.call(t))[1]}var e,r=/^\[object (.*)\]$/,n=Object.prototype.toString;return t}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,r){var n;n=function(){function t(t,e){return Object.prototype.hasOwnProperty.call(t,e)}return t}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,r){"use strict";function n(t,e,r){return(e-t)*r+t}function i(t,e,r){var i=(r-t[0])/(e[0]-t[0]);return[n(t[1],e[1],i),n(t[2],e[2],i),n(t[3],e[3],i),255]}function o(t,e){return[t[e].x,t[e].r,t[e].g,t[e].b]}function a(t,e){return t.x-e.x}function s(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];this.name=t,this.scalarRange=[0,1],this.delta=1,this.controlPoints=null,this.colorTableSize=256,this.colorTable=null,this.colorNaN=[0,0,0,0],this.setPreset("spectralflip"),this.discrete=e,this.scale=1,this.build()}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=s;var u=r(12),l=r(2),c="lookuptable.change",h=[];for(var f in u.lookuptables)h.push(f);l.mixInto(s),s.prototype.getName=function(){return this.name},s.prototype.getPresets=function(){return h},s.prototype.setPreset=function(t){this.colorTable=null,this.controlPoints=[];for(var e=u.lookuptables[t].controlpoints,r=e.length,n=0;r>n;n++)this.controlPoints.push({x:e[n].x,r:e[n].r,g:e[n].g,b:e[n].b});this.build(),this.emit(c,{change:"preset",lut:this})},s.prototype.updateControlPoints=function(t){this.colorTable=null,this.controlPoints=[];for(var e=t.length,r=0;e>r;r++)this.controlPoints.push({x:t[r].x,r:t[r].r,g:t[r].g,b:t[r].b});this.build(),this.emit(c,{change:"controlPoints",lut:this})},s.prototype.setColorForNaN=function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2],n=arguments.length<=3||void 0===arguments[3]?0:arguments[3];this.colorNaN=[t,e,r,n]},s.prototype.getColorForNaN=function(){return this.colorNaN},s.prototype.getScalarRange=function(){return[Number(this.scalarRange[0]),Number(this.scalarRange[1])]},s.prototype.setScalarRange=function(t,e){this.scalarRange=[t,e],this.delta=e-t,this.emit(c,{change:"scalarRange",lut:this})},s.prototype.build=function(t){if(!this.colorTable){this.colorTable=[];var e=0;if(this.discrete){this.colorTableSize=this.controlPoints.length,this.scale=50;for(var r=0;r<this.colorTableSize;r++){var n=this.controlPoints[r];this.colorTable.push([n.r,n.g,n.b,255])}}else{this.scale=1;for(var r=0;r<this.colorTableSize;r++){var a=r/(this.colorTableSize-1),s=o(this.controlPoints,e),u=o(this.controlPoints,e+1);a>u[0]&&(e+=1,s=o(this.controlPoints,e),u=o(this.controlPoints,e+1)),this.colorTable.push(i(s,u,a))}}t&&this.emit(c,{change:"controlPoints",lut:this})}},s.prototype.setNumberOfColors=function(t){this.colorTableSize=t,this.colorTable=null,this.build(),this.emit(c,{change:"numberOfColors",lut:this})},s.prototype.getNumberOfControlPoints=function(){return this.controlPoints?this.controlPoints.length:0},s.prototype.removeControlPoint=function(t){return t>0&&t<this.controlPoints.length-1?(this.controlPoints.splice(t,1),this.colorTable=null,this.build(!0),!0):!1},s.prototype.getControlPoint=function(t){return this.controlPoints[t]},s.prototype.updateControlPoint=function(t,e){this.controlPoints[t]=e;var r=e.x;this.controlPoints.sort(a),this.colorTable=null,this.build(!0);for(var n=0;n<this.controlPoints.length;n++)if(this.controlPoints[n].x===r)return n;return 0},s.prototype.addControlPoint=function(t){this.controlPoints.push(t);var e=t.x;this.controlPoints.sort(a),this.colorTable=null,this.build(!0);for(var r=0;r<this.controlPoints.length;r++)if(this.controlPoints[r].x===e)return r;return-1},s.prototype.drawToCanvas=function(t){for(var e=this.colorTable,r=this.scale*e.length,n=t.getContext("2d"),i=n.getImageData(0,0,r,1),o=0;r>o;o++){var a=Math.floor(o/this.scale);i.data[4*o+0]=Math.floor(255*e[a][0]),i.data[4*o+1]=Math.floor(255*e[a][1]),i.data[4*o+2]=Math.floor(255*e[a][2]),i.data[4*o+3]=255}n.putImageData(i,0,0)},s.prototype.getColor=function(t){if(isNaN(t))return this.colorNaN;var e=Math.floor(this.colorTableSize*(t-this.scalarRange[0])/this.delta);return 0>e?this.colorTable[0]:e>=this.colorTableSize?this.colorTable[this.colorTable.length-1]:this.colorTable[e]},s.prototype.destroy=function(){this.off(c)},s.prototype.onChange=function(t){return this.on(c,t)},t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={lookuptables:{spectralflip:{controlpoints:[{x:0,r:.3686274509803922,g:.3098039215686275,b:.6352941176470588},{x:.1,r:.196078431372549,g:.5333333333333333,b:.7411764705882353},{x:.2,r:.4,g:.7607843137254902,b:.6470588235294118},{x:.3,r:.6705882352941176,g:.8666666666666667,b:.6431372549019608},{x:.4,r:.9019607843137255,g:.9607843137254902,b:.596078431372549},{x:.5,r:1,g:1,b:.7490196078431373},{x:.6,r:.996078431372549,g:.8784313725490196,b:.5450980392156862},{x:.7,r:.9921568627450981,g:.6823529411764706,b:.3803921568627451},{x:.8,r:.9568627450980393,g:.4274509803921568,b:.2627450980392157},{x:.9,r:.8352941176470589,g:.2431372549019608,b:.3098039215686275},{x:1,r:.6196078431372549,g:.00392156862745098,b:.2588235294117647}],range:[0,1]},cold2warm:{controlpoints:[{x:0,r:.23137254902,g:.298039215686,b:.752941176471},{x:.5,r:.865,g:.865,b:.865},{x:1,r:.705882352941,g:.0156862745098,b:.149019607843}],range:[0,1]},rainbow:{controlpoints:[{x:0,r:0,g:0,b:1},{x:.25,r:0,g:1,b:1},{x:.5,r:0,g:1,b:0},{x:.75,r:1,g:1,b:0},{x:1,r:1,g:0,b:0}],range:[0,1]},"gray scale":{controlpoints:[{x:0,r:0,g:0,b:0},{x:1,r:1,g:1,b:1}],range:[0,1]},"gray scale flip":{controlpoints:[{x:0,r:1,g:1,b:1},{x:1,r:0,g:0,b:0}],range:[0,1]},spectral:{controlpoints:[{x:0,r:.6196078431372549,g:.00392156862745098,b:.2588235294117647},{x:.1,r:.8352941176470589,g:.2431372549019608,b:.3098039215686275},{x:.2,r:.9568627450980393,g:.4274509803921568,b:.2627450980392157},{x:.3,r:.9921568627450981,g:.6823529411764706,b:.3803921568627451},{x:.4,r:.996078431372549,g:.8784313725490196,b:.5450980392156862},{x:.5,r:1,g:1,b:.7490196078431373},{x:.6,r:.9019607843137255,g:.9607843137254902,b:.596078431372549},{x:.7,r:.6705882352941176,g:.8666666666666667,b:.6431372549019608},{x:.8,r:.4,g:.7607843137254902,b:.6470588235294118},{x:.9,r:.196078431372549,g:.5333333333333333,b:.7411764705882353},{x:1,r:.3686274509803922,g:.3098039215686275,b:.6352941176470588}],range:[0,1]},warm:{controlpoints:[{x:0,r:.4745098039215686,g:.09019607843137255,b:.09019607843137255},{x:.2,r:.7098039215686275,g:.00392156862745098,b:.00392156862745098},{x:.4,r:.9372549019607843,g:.2784313725490196,b:.09803921568627451},{x:.6,r:.9764705882352941,g:.5137254901960784,b:.1411764705882353},{x:.8,r:1,g:.7058823529411765,b:0},{x:1,r:1,g:.8980392156862745,b:.02352941176470588}],range:[0,1]},cool:{controlpoints:[{x:0,r:.4588235294117647,g:.6941176470588235,b:.00392156862745098},{x:.1666666666666667,r:.3450980392156863,g:.5019607843137255,b:.1607843137254902},{x:.3333333333333333,r:.3137254901960784,g:.8431372549019608,b:.7490196078431373},{x:.5,r:.1098039215686274,g:.5843137254901961,b:.803921568627451},{x:.6666666666666666,r:.2313725490196079,g:.407843137254902,b:.6705882352941176},{x:.8333333333333334,r:.6039215686274509,g:.407843137254902,b:1},{x:1,r:.3725490196078431,g:.2,b:.5019607843137255}],range:[0,1]},blues:{controlpoints:[{x:0,r:.2313725490196079,g:.407843137254902,b:.6705882352941176},{x:.1666666666666667,r:.1098039215686274,g:.5843137254901961,b:.803921568627451},{x:.3333333333333333,r:.3058823529411765,g:.8509803921568627,b:.9176470588235294},{x:.5,r:.4509803921568628,g:.6039215686274509,b:.8352941176470589},{x:.6666666666666666,r:.2588235294117647,g:.2392156862745098,b:.6627450980392157},{x:.8333333333333334,r:.3137254901960784,g:.3294117647058823,b:.5294117647058824},{x:1,r:.06274509803921569,g:.1647058823529412,b:.3215686274509804}],range:[0,1]},wildflower:{controlpoints:[{x:0,r:.1098039215686274,g:.5843137254901961,b:.803921568627451},{x:.1666666666666667,r:.2313725490196079,g:.407843137254902,b:.6705882352941176},{x:.3333333333333333,r:.4,g:.2431372549019608,b:.7176470588235294},{x:.5,r:.6352941176470588,g:.3294117647058823,b:.8117647058823529},{x:.6666666666666666,r:.8705882352941177,g:.3803921568627451,b:.807843137254902},{x:.8333333333333334,r:.8627450980392157,g:.3803921568627451,b:.5843137254901961},{x:1,r:.2392156862745098,g:.06274509803921569,b:.3215686274509804}],range:[0,1]},citrus:{controlpoints:[{x:0,r:.396078431372549,g:.4862745098039216,b:.2156862745098039},{x:.2,r:.4588235294117647,g:.6941176470588235,b:.00392156862745098},{x:.4,r:.6980392156862745,g:.7294117647058823,b:.1882352941176471},{x:.6,r:1,g:.8980392156862745,b:.02352941176470588},{x:.8,r:1,g:.7058823529411765,b:0},{x:1,r:.9764705882352941,g:.5137254901960784,b:.1411764705882353}],range:[0,1]},organge2purple:{controlpoints:[{x:0,r:.4980392156862745,g:.2313725490196079,b:.03137254901960784},{x:.1,r:.7019607843137254,g:.3450980392156863,b:.02352941176470588},{x:.2,r:.8784313725490196,g:.5098039215686274,b:.0784313725490196},{x:.3,r:.9921568627450981,g:.7215686274509804,b:.3882352941176471},{x:.4,r:.996078431372549,g:.8784313725490196,b:.7137254901960784},{x:.5,r:.9686274509803922,g:.9686274509803922,b:.9686274509803922},{x:.6,r:.8470588235294118,g:.8549019607843137,b:.9215686274509803},{x:.7,r:.6980392156862745,g:.6705882352941176,b:.8235294117647058},{x:.8,r:.5019607843137255,g:.4509803921568628,b:.6745098039215687},{x:.9,r:.3294117647058823,g:.1529411764705882,b:.5333333333333333},{x:1,r:.1764705882352941,g:0,b:.2941176470588235}],range:[0,1]},brown2green:{controlpoints:[{x:0,r:.3294117647058823,g:.1882352941176471,b:.0196078431372549},{x:.1,r:.5490196078431373,g:.3176470588235294,b:.0392156862745098},{x:.2,r:.7490196078431373,g:.5058823529411764,b:.1764705882352941},{x:.3,r:.8745098039215686,g:.7607843137254902,b:.4901960784313725},{x:.4,r:.9647058823529412,g:.9098039215686274,b:.7647058823529411},{x:.5,r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},{x:.6,r:.7803921568627451,g:.9176470588235294,b:.8980392156862745},{x:.7,r:.5019607843137255,g:.803921568627451,b:.7568627450980392},{x:.8,r:.207843137254902,g:.592156862745098,b:.5607843137254902},{x:.9,r:.00392156862745098,g:.4,b:.3686274509803922},{x:1,r:0,g:.2352941176470588,b:.1882352941176471}],range:[0,1]},blue2green:{controlpoints:[{x:0,r:.9686274509803922,g:.9882352941176471,b:.9921568627450981},{x:.125,r:.8980392156862745,g:.9607843137254902,b:.9764705882352941},{x:.25,r:.8,g:.9254901960784314,b:.9019607843137255},{x:.375,r:.6,g:.8470588235294118,b:.788235294117647},{x:.5,r:.4,g:.7607843137254902,b:.6431372549019608},{x:.625,r:.2549019607843137,g:.6823529411764706,b:.4627450980392157},{x:.75,r:.1372549019607843,g:.5450980392156862,b:.2705882352941176},{x:.875,r:0,g:.4274509803921568,b:.1725490196078431},{x:1,r:0,g:.2666666666666667,b:.1058823529411765}],range:[0,1]},yellow2brown:{controlpoints:[{x:0,r:1,g:1,b:.8980392156862745},{x:.125,r:1,g:.9686274509803922,b:.7372549019607844},{x:.25,r:.996078431372549,g:.8901960784313725,b:.5686274509803921},{x:.375,r:.996078431372549,g:.7686274509803922,b:.3098039215686275},{x:.5,r:.996078431372549,g:.6,b:.1607843137254902},{x:.625,r:.9254901960784314,g:.4392156862745098,b:.0784313725490196},{x:.75,r:.8,g:.2980392156862745,b:.00784313725490196},{x:.875,r:.6,g:.203921568627451,b:.01568627450980392},{x:1,r:.4,g:.1450980392156863,b:.02352941176470588}],range:[0,1]},blue2purple:{controlpoints:[{x:0,r:.9686274509803922,g:.9882352941176471,b:.9921568627450981},{x:.125,r:.8784313725490196,g:.9254901960784314,b:.9568627450980393},{x:.25,r:.7490196078431373,g:.8274509803921568,b:.9019607843137255},{x:.375,r:.6196078431372549,g:.7372549019607844,b:.8549019607843137},{x:.5,r:.5490196078431373,g:.5882352941176471,b:.7764705882352941},{x:.625,r:.5490196078431373,g:.4196078431372549,b:.6941176470588235},{x:.75,r:.5333333333333333,g:.2549019607843137,b:.615686274509804},{x:.875,r:.5058823529411764,g:.05882352941176471,b:.4862745098039216},{x:1,r:.3019607843137255,g:0,b:.2941176470588235}],range:[0,1]},ocean:{controlpoints:[{x:0,r:.039215,g:.090195,b:.25098},{x:.125,r:.133333,g:.364706,b:.521569},{x:.25,r:.321569,g:.760784,b:.8},{x:.375,r:.690196,g:.960784,b:.894118},{x:.5,r:.552941,g:.921569,b:.552941},{x:.625,r:.329412,g:.6,b:.239216},{x:.75,r:.211765,g:.34902,b:.078435},{x:.875,r:.011765,g:.207843,b:.023525},{x:1,r:.286275,g:.294118,b:.301961}],range:[0,1]},earth:{controlpoints:[{x:0,r:.392157,g:.392157,b:.392157},{x:.586175,r:.392157,g:.392157,b:.392157},{x:.589041,r:.141176,g:.345098,b:.478431},{x:.589042,r:.501961,g:.694118,b:.172549},{x:.617699,r:.74902,g:.560784,b:.188235},{x:.789648,r:.752941,g:.741176,b:.729412},{x:.993079,r:.796078,g:.780392,b:.772549},{x:1,r:.796078,g:.780392,b:.772549}],range:[0,1]}},swatches:{colors:[{r:255,g:255,b:255},{r:204,g:255,b:255},{r:204,g:204,b:255},{r:204,g:204,b:255},{r:204,g:204,b:255},{r:204,g:204,b:255},{r:204,g:204,b:255},{r:204,g:204,b:255},{r:204,g:204,b:255},{r:204,g:204,b:255},{r:204,g:204,b:255},{r:255,g:204,b:255},{r:255,g:204,b:204},{r:255,g:204,b:204},{r:255,g:204,b:204},{r:255,g:204,b:204},{r:255,g:204,b:204},{r:255,g:204,b:204},{r:255,g:204,b:204},{r:255,g:204,b:204},{r:255,g:204,b:204},{r:255,g:255,b:204},{r:204,g:255,b:204},{r:204,g:255,b:204},{r:204,g:255,b:204},{r:204,g:255,b:204},{r:204,g:255,b:204},{r:204,g:255,b:204},{r:204,g:255,b:204},{r:204,g:255,b:204},{r:204,g:255,b:204},{r:204,g:204,b:204},{r:153,g:255,b:255},{r:153,g:204,b:255},{r:153,g:153,b:255},{r:153,g:153,b:255},{r:153,g:153,b:255},{r:153,g:153,b:255},{r:153,g:153,b:255},{r:153,g:153,b:255},{r:153,g:153,b:255},{r:204,g:153,b:255},{r:255,g:153,b:255},{r:255,g:153,b:204},{r:255,g:153,b:153},{r:255,g:153,b:153},{r:255,g:153,b:153},{r:255,g:153,b:153},{r:255,g:153,b:153},{r:255,g:153,b:153},{r:255,g:153,b:153},{r:255,g:204,b:153},{r:255,g:255,b:153},{r:204,g:255,b:153},{r:153,g:255,b:153},{r:153,g:255,b:153},{r:153,g:255,b:153},{r:153,g:255,b:153},{r:153,g:255,b:153},{r:153,g:255,b:153},{r:153,g:255,b:153},{r:153,g:255,b:204},{r:204,g:204,b:204},{r:102,g:255,b:255},{r:102,g:204,b:255},{r:102,g:153,b:255},{r:102,g:102,b:255},{r:102,g:102,b:255},{r:102,g:102,b:255},{r:102,g:102,b:255},{r:102,g:102,b:255},{r:153,g:102,b:255},{r:204,g:102,b:255},{r:255,g:102,b:255},{r:255,g:102,b:204},{r:255,g:102,b:153},{r:255,g:102,b:102},{r:255,g:102,b:102},{r:255,g:102,b:102},{r:255,g:102,b:102},{r:255,g:102,b:102},{r:255,g:153,b:102},{r:255,g:204,b:102},{r:255,g:255,b:102},{r:204,g:255,b:102},{r:153,g:255,b:102},{r:102,g:255,b:102},{r:102,g:255,b:102},{r:102,g:255,b:102},{r:102,g:255,b:102},{r:102,g:255,b:102},{r:102,g:255,b:153},{r:102,g:255,b:204},{r:153,g:153,b:153},{r:51,g:255,b:255},{r:51,g:204,b:255},{r:51,g:153,b:255},{r:51,g:102,b:255},{r:51,g:51,b:255},{r:51,g:51,b:255},{r:51,g:51,b:255},{r:102,g:51,b:255},{r:153,g:51,b:255},{r:204,g:51,b:255},{r:255,g:51,b:255},{r:255,g:51,b:204},{r:255,g:51,b:153},{r:255,g:51,b:102},{r:255,g:51,b:51},{r:255,g:51,b:51},{r:255,g:51,b:51},{r:255,g:102,b:51},{r:255,g:153,b:51},{r:255,g:204,b:51},{r:255,g:255,b:51},{r:204,g:255,b:51},{r:153,g:255,b:51},{r:102,g:255,b:51},{r:51,g:255,b:51},{r:51,g:255,b:51},{r:51,g:255,b:51},{r:51,g:255,b:102},{r:51,g:255,b:153},{r:51,g:255,b:204},{r:153,g:153,b:153},{r:0,g:255,b:255},{r:0,g:204,b:255},{r:0,g:153,b:255},{r:0,g:102,b:255},{r:0,g:51,b:255},{r:0,g:0,b:255},{r:51,g:0,b:255},{r:102,g:0,b:255},{r:153,g:0,b:255},{r:204,g:0,b:255},{r:255,g:0,b:255},{r:255,g:0,b:204},{r:255,g:0,b:153},{r:255,g:0,b:102},{r:255,g:0,b:51},{r:255,g:0,b:0},{r:255,g:51,b:0},{r:255,g:102,b:0},{r:255,g:153,b:0},{r:255,g:204,b:0},{r:255,g:255,b:0},{r:204,g:255,b:0},{r:153,g:255,b:0},{r:102,g:255,b:0},{r:51,g:255,b:0},{r:0,g:255,b:0},{r:0,g:255,b:51},{r:0,g:255,b:102},{r:0,g:255,b:153},{r:0,g:255,b:204},{r:102,g:102,b:102},{r:0,g:204,b:204},{r:0,g:204,b:204},{r:0,g:153,b:204},{r:0,g:102,b:204},{r:0,g:51,b:204},{r:0,g:0,b:204},{r:51,g:0,b:204},{r:102,g:0,b:204},{r:153,g:0,b:204},{r:204,g:0,b:204},{r:204,g:0,b:204},{r:204,g:0,b:204},{r:204,g:0,b:153},{r:204,g:0,b:102},{r:204,g:0,b:51},{r:204,g:0,b:0},{r:204,g:51,b:0},{r:204,g:102,b:0},{r:204,g:153,b:0},{r:204,g:204,b:0},{r:204,g:204,b:0},{r:204,g:204,b:0},{r:153,g:204,b:0},{r:102,g:204,b:0},{r:51,g:204,b:0},{r:0,g:204,b:0},{r:0,g:204,b:51},{r:0,g:204,b:102},{r:0,g:204,b:153},{r:0,g:204,b:204},{r:102,g:102,b:102},{r:0,g:153,b:153},{r:0,g:153,b:153},{r:0,g:153,b:153},{r:0,g:102,b:153},{r:0,g:51,b:153},{r:0,g:0,b:153},{r:51,g:0,b:153},{r:102,g:0,b:153},{r:153,g:0,b:153},{r:153,g:0,b:153},{r:153,g:0,b:153},{r:153,g:0,b:153},{r:153,g:0,b:153},{r:153,g:0,b:102},{r:153,g:0,b:51},{r:153,g:0,b:0},{r:153,g:51,b:0},{r:153,g:102,b:0},{r:153,g:153,b:0},{r:153,g:153,b:0},{r:153,g:153,b:0},{r:153,g:153,b:0},{r:153,g:153,b:0},{r:102,g:153,b:0},{r:51,g:153,b:0},{r:0,g:153,b:0},{r:0,g:153,b:51},{r:0,g:153,b:102},{r:0,g:153,b:153},{r:0,g:153,b:153},{r:51,g:51,b:51},{r:0,g:102,b:102},{r:0,g:102,b:102},{r:0,g:102,b:102},{r:0,g:102,b:102},{r:0,g:51,b:102},{r:0,g:0,b:102},{r:51,g:0,b:102},{r:102,g:0,b:102},{r:102,g:0,b:102},{r:102,g:0,b:102},{r:102,g:0,b:102},{r:102,g:0,b:102},{r:102,g:0,b:102},{r:102,g:0,b:102},{r:102,g:0,b:51},{r:102,g:0,b:0},{r:102,g:51,b:0},{r:102,g:102,b:0},{r:102,g:102,b:0},{r:102,g:102,b:0},{r:102,g:102,b:0},{r:102,g:102,b:0},{r:102,g:102,b:0},{r:102,g:102,b:0},{r:51,g:102,b:0},{r:0,g:102,b:0},{r:0,g:102,b:51},{r:0,g:102,b:102},{r:0,g:102,b:102},{r:0,g:102,b:102},{r:0,g:0,b:0},{r:0,g:51,b:51},{r:0,g:51,b:51},{r:0,g:51,b:51},{r:0,g:51,b:51},{r:0,g:51,b:51},{r:0,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:51},{r:51,g:0,b:0},{r:51,g:51,b:0},{r:51,g:51,b:0},{r:51,g:51,b:0},{r:51,g:51,b:0},{r:51,g:51,b:0},{r:51,g:51,b:0},{r:51,g:51,b:0},{r:51,g:51,b:0},{r:0,g:51,b:0},{r:0,g:51,b:51},{r:0,g:51,b:51},{r:0,g:51,b:51},{r:0,g:51,b:51},{r:51,g:51,b:51}],columns:31,rows:9}},t.exports=e["default"]},function(t,e){t.exports="\nprecision mediump float;\n\nuniform sampler2D compositeSampler;\nuniform sampler2D layerSampler;\nvarying vec2 v_texCoord;\n\nvoid main() {\n    // Sample the texture containing what we have composited so far\n    vec4 color = texture2D(compositeSampler, v_texCoord);\n\n    // Sample the new layer to be composited in\n    vec4 compColor = texture2D(layerSampler, v_texCoord);\n\n/*\n    // Choose the fragment with the greater depth value\n    if (color.a > compColor.a) {\n        gl_FragColor = color;\n    } else {\n        gl_FragColor = compColor;\n    }\n*/\n\n    // Another way to choose the fragment with the greater depth value\n    float stepVal = step((compColor.a - color.a), 0.0);\n    gl_FragColor = (stepVal * color) + ((1.0 - stepVal) * compColor);\n\n}\n"},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,
r.setMatrixArrayType=function(t){GLMAT_ARRAY_TYPE=t};var n=Math.PI/180;r.toRadian=function(t){return t*n},t.exports=r},function(t,e,r){var n;(function(t,i){(function(){function o(t,e,r){for(var n=(r||0)-1,i=t?t.length:0;++n<i;)if(t[n]===e)return n;return-1}function a(t,e){var r=typeof e;if(t=t.cache,"boolean"==r||null==e)return t[e]?0:-1;"number"!=r&&"string"!=r&&(r="object");var n="number"==r?e:E+e;return t=(t=t[r])&&t[n],"object"==r?t&&o(t,e)>-1?0:-1:t?0:-1}function s(t){var e=this.cache,r=typeof t;if("boolean"==r||null==t)e[t]=!0;else{"number"!=r&&"string"!=r&&(r="object");var n="number"==r?t:E+t,i=e[r]||(e[r]={});"object"==r?(i[n]||(i[n]=[])).push(t):i[n]=!0}}function u(t){return t.charCodeAt(0)}function l(t,e){for(var r=t.criteria,n=e.criteria,i=-1,o=r.length;++i<o;){var a=r[i],s=n[i];if(a!==s){if(a>s||"undefined"==typeof a)return 1;if(s>a||"undefined"==typeof s)return-1}}return t.index-e.index}function c(t){var e=-1,r=t.length,n=t[0],i=t[r/2|0],o=t[r-1];if(n&&"object"==typeof n&&i&&"object"==typeof i&&o&&"object"==typeof o)return!1;var a=g();a["false"]=a["null"]=a["true"]=a.undefined=!1;var u=g();for(u.array=t,u.cache=a,u.push=s;++e<r;)u.push(t[e]);return u}function h(t){return"\\"+it[t]}function f(){return _.pop()||[]}function g(){return x.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function p(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function d(t){t.length=0,_.length<R&&_.push(t)}function v(t){var e=t.cache;e&&v(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,x.length<R&&x.push(t)}function m(t,e,r){e||(e=0),"undefined"==typeof r&&(r=t?t.length:0);for(var n=-1,i=r-e||0,o=Array(0>i?0:i);++n<i;)o[n]=t[e+n];return o}function b(t){function e(t){return t&&"object"==typeof t&&!hn(t)&&Yr.call(t,"__wrapped__")?t:new r(t)}function r(t,e){this.__chain__=!!e,this.__wrapped__=t}function n(t){function e(){if(n){var t=m(n);Gr.apply(t,arguments)}if(this instanceof e){var o=s(r.prototype),a=r.apply(o,t||arguments);return Ot(a)?a:o}return r.apply(i,t||arguments)}var r=t[0],n=t[2],i=t[4];return cn(e,t),e}function i(t,e,r,n,o){if(r){var a=r(t);if("undefined"!=typeof a)return a}var s=Ot(t);if(!s)return t;var u=Ur.call(t);if(!J[u]||!un.nodeClass&&p(t))return t;var l=an[u];switch(u){case q:case W:return new l(+t);case Z:case H:return new l(t);case K:return a=l(t.source,L.exec(t)),a.lastIndex=t.lastIndex,a}var c=hn(t);if(e){var h=!n;n||(n=f()),o||(o=f());for(var g=n.length;g--;)if(n[g]==t)return o[g];a=c?l(t.length):{}}else a=c?m(t):Tn({},t);return c&&(Yr.call(t,"index")&&(a.index=t.index),Yr.call(t,"input")&&(a.input=t.input)),e?(n.push(t),o.push(a),(c?xn:wn)(t,function(t,s){a[s]=i(t,e,r,n,o)}),h&&(d(n),d(o)),a):a}function s(t,e){return Ot(t)?$r(t):{}}function _(t,e,r){if("function"!=typeof t)return ir;if("undefined"==typeof e||!("prototype"in t))return t;var n=t.__bindData__;if("undefined"==typeof n&&(un.funcNames&&(n=!t.name),n=n||!un.funcDecomp,!n)){var i=jr.call(t);un.funcNames||(n=!I.test(i)),n||(n=N.test(i),cn(t,n))}if(n===!1||n!==!0&&1&n[1])return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)}}return je(t,e)}function x(t){function e(){var t=l?a:this;if(i){var p=m(i);Gr.apply(p,arguments)}if((o||h)&&(p||(p=m(arguments)),o&&Gr.apply(p,o),h&&p.length<u))return n|=16,x([r,f?n:-4&n,p,null,a,u]);if(p||(p=arguments),c&&(r=t[g]),this instanceof e){t=s(r.prototype);var d=r.apply(t,p);return Ot(d)?d:t}return r.apply(t,p)}var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],u=t[5],l=1&n,c=2&n,h=4&n,f=8&n,g=r;return cn(e,t),e}function R(t,e){var r=-1,n=dt(),i=t?t.length:0,s=i>=w&&n===o,u=[];if(s){var l=c(e);l?(n=a,e=l):s=!1}for(;++r<i;){var h=t[r];n(e,h)<0&&u.push(h)}return s&&v(e),u}function it(t,e,r,n){for(var i=(n||0)-1,o=t?t.length:0,a=[];++i<o;){var s=t[i];if(s&&"object"==typeof s&&"number"==typeof s.length&&(hn(s)||yt(s))){e||(s=it(s,e,r));var u=-1,l=s.length,c=a.length;for(a.length+=l;++u<l;)a[c++]=s[u]}else r||a.push(s)}return a}function at(t,e,r,n,i,o){if(r){var a=r(t,e);if("undefined"!=typeof a)return!!a}if(t===e)return 0!==t||1/t==1/e;var s=typeof t,u=typeof e;if(!(t!==t||t&&nt[s]||e&&nt[u]))return!1;if(null==t||null==e)return t===e;var l=Ur.call(t),c=Ur.call(e);if(l==Y&&(l=$),c==Y&&(c=$),l!=c)return!1;switch(l){case q:case W:return+t==+e;case Z:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case K:case H:return t==Mr(e)}var h=l==G;if(!h){var g=Yr.call(t,"__wrapped__"),v=Yr.call(e,"__wrapped__");if(g||v)return at(g?t.__wrapped__:t,v?e.__wrapped__:e,r,n,i,o);if(l!=$||!un.nodeClass&&(p(t)||p(e)))return!1;var m=!un.argsObject&&yt(t)?Pr:t.constructor,b=!un.argsObject&&yt(e)?Pr:e.constructor;if(m!=b&&!(Ut(m)&&m instanceof m&&Ut(b)&&b instanceof b)&&"constructor"in t&&"constructor"in e)return!1}var y=!i;i||(i=f()),o||(o=f());for(var _=i.length;_--;)if(i[_]==t)return o[_]==e;var x=0;if(a=!0,i.push(t),o.push(e),h){if(_=t.length,x=e.length,a=x==_,a||n)for(;x--;){var T=_,C=e[x];if(n)for(;T--&&!(a=at(t[T],C,r,n,i,o)););else if(!(a=at(t[x],C,r,n,i,o)))break}}else En(e,function(e,s,u){return Yr.call(u,s)?(x++,a=Yr.call(t,s)&&at(t[s],e,r,n,i,o)):void 0}),a&&!n&&En(t,function(t,e,r){return Yr.call(r,e)?a=--x>-1:void 0});return i.pop(),o.pop(),y&&(d(i),d(o)),a}function st(t,e,r,n,i){(hn(e)?ne:wn)(e,function(e,o){var a,s,u=e,l=t[o];if(e&&((s=hn(e))||Rn(e))){for(var c=n.length;c--;)if(a=n[c]==e){l=i[c];break}if(!a){var h;r&&(u=r(l,e),(h="undefined"!=typeof u)&&(l=u)),h||(l=s?hn(l)?l:[]:Rn(l)?l:{}),n.push(e),i.push(l),h||st(l,e,r,n,i)}}else r&&(u=r(l,e),"undefined"==typeof u&&(u=e)),"undefined"!=typeof u&&(l=u);t[o]=l})}function ut(t,e){return t+Br(on()*(e-t+1))}function ct(t,e,r){var n=-1,i=dt(),s=t?t.length:0,u=[],l=!e&&s>=w&&i===o,h=r||l?f():u;if(l){var g=c(h);i=a,h=g}for(;++n<s;){var p=t[n],m=r?r(p,n,t):p;(e?!n||h[h.length-1]!==m:i(h,m)<0)&&((r||l)&&h.push(m),u.push(p))}return l?(d(h.array),v(h)):r&&d(h),u}function ht(t){return function(r,n,i){var o={};if(n=e.createCallback(n,i,3),hn(r))for(var a=-1,s=r.length;++a<s;){var u=r[a];t(o,u,n(u,a,r),r)}else xn(r,function(e,r,i){t(o,e,n(e,r,i),i)});return o}}function ft(t,e,r,i,o,a){var s=1&e,u=2&e,l=4&e,c=16&e,h=32&e;if(!u&&!Ut(t))throw new Sr;c&&!r.length&&(e&=-17,c=r=!1),h&&!i.length&&(e&=-33,h=i=!1);var f=t&&t.__bindData__;if(f&&f!==!0)return f=m(f),f[2]&&(f[2]=m(f[2])),f[3]&&(f[3]=m(f[3])),!s||1&f[1]||(f[4]=o),!s&&1&f[1]&&(e|=8),!l||4&f[1]||(f[5]=a),c&&Gr.apply(f[2]||(f[2]=[]),r),h&&Qr.apply(f[3]||(f[3]=[]),i),f[1]|=e,ft.apply(null,f);var g=1==e||17===e?n:x;return g([t,e,r,i,o,a])}function gt(){rt.shadowedProps=j,rt.array=rt.bottom=rt.loop=rt.top="",rt.init="iterable",rt.useHas=!0;for(var t,e=0;t=arguments[e];e++)for(var r in t)rt[r]=t[r];var n=rt.args;rt.firstArg=/^[^,]+/.exec(n)[0];var i=Er("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+n+") {\n"+ln(rt)+"\n}");return i(_,V,Lr,Yr,C,yt,hn,zt,rt.keys,Ir,nt,sn,H,kr,Ur)}function pt(t){return mn[t]}function dt(){var t=(t=e.indexOf)===Ee?o:t;return t}function vt(t){return"function"==typeof t&&Or.test(t)}function mt(t){var e,r;return!t||Ur.call(t)!=$||(e=t.constructor,Ut(e)&&!(e instanceof e))||!un.argsClass&&yt(t)||!un.nodeClass&&p(t)?!1:un.ownLast?(En(t,function(t,e,n){return r=Yr.call(n,e),!1}),r!==!1):(En(t,function(t,e){r=e}),"undefined"==typeof r||Yr.call(t,r))}function bt(t){return bn[t]}function yt(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Ur.call(t)==Y||!1}function _t(t,e,r,n){return"boolean"!=typeof e&&null!=e&&(n=r,r=e,e=!1),i(t,e,"function"==typeof r&&_(r,n,1))}function xt(t,e,r){return i(t,!0,"function"==typeof e&&_(e,r,1))}function Tt(t,e){var r=s(t);return e?Tn(r,e):r}function Ct(t,r,n){var i;return r=e.createCallback(r,n,3),wn(t,function(t,e,n){return r(t,e,n)?(i=e,!1):void 0}),i}function Et(t,r,n){var i;return r=e.createCallback(r,n,3),Rt(t,function(t,e,n){return r(t,e,n)?(i=e,!1):void 0}),i}function wt(t,e,r){var n=[];En(t,function(t,e){n.push(e,t)});var i=n.length;for(e=_(e,r,3);i--&&e(n[i--],n[i],t)!==!1;);return t}function Rt(t,e,r){var n=gn(t),i=n.length;for(e=_(e,r,3);i--;){var o=n[i];if(e(t[o],o,t)===!1)break}return t}function Pt(t){var e=[];return En(t,function(t,r){Ut(t)&&e.push(r)}),e.sort()}function Dt(t,e){return t?Yr.call(t,e):!1}function Mt(t){for(var e=-1,r=gn(t),n=r.length,i={};++e<n;){var o=r[e];i[t[o]]=o}return i}function St(t){return t===!0||t===!1||t&&"object"==typeof t&&Ur.call(t)==q||!1}function At(t){return t&&"object"==typeof t&&Ur.call(t)==W||!1}function Lt(t){return t&&1===t.nodeType||!1}function It(t){var e=!0;if(!t)return e;var r=Ur.call(t),n=t.length;return r==G||r==H||(un.argsClass?r==Y:yt(t))||r==$&&"number"==typeof n&&Ut(t.splice)?!n:(wn(t,function(){return e=!1}),e)}function kt(t,e,r,n){return at(t,e,"function"==typeof r&&_(r,n,2))}function Ft(t){return Hr(t)&&!Jr(parseFloat(t))}function Ut(t){return"function"==typeof t}function Ot(t){return!(!t||!nt[typeof t])}function Nt(t){return Bt(t)&&t!=+t}function Xt(t){return null===t}function Bt(t){return"number"==typeof t||t&&"object"==typeof t&&Ur.call(t)==Z||!1}function jt(t){return t&&nt[typeof t]&&Ur.call(t)==K||!1}function zt(t){return"string"==typeof t||t&&"object"==typeof t&&Ur.call(t)==H||!1}function Yt(t){return"undefined"==typeof t}function Gt(t,r,n){var i={};return r=e.createCallback(r,n,3),wn(t,function(t,e,n){i[e]=r(t,e,n)}),i}function qt(t){var e=arguments,r=2;if(!Ot(t))return t;if("number"!=typeof e[2]&&(r=e.length),r>3&&"function"==typeof e[r-2])var n=_(e[--r-1],e[r--],2);else r>2&&"function"==typeof e[r-1]&&(n=e[--r]);for(var i=m(arguments,1,r),o=-1,a=f(),s=f();++o<r;)st(t,i[o],n,a,s);return d(a),d(s),t}function Wt(t,r,n){var i={};if("function"!=typeof r){var o=[];En(t,function(t,e){o.push(e)}),o=R(o,it(arguments,!0,!1,1));for(var a=-1,s=o.length;++a<s;){var u=o[a];i[u]=t[u]}}else r=e.createCallback(r,n,3),En(t,function(t,e,n){r(t,e,n)||(i[e]=t)});return i}function Vt(t){for(var e=-1,r=gn(t),n=r.length,i=_r(n);++e<n;){var o=r[e];i[e]=[o,t[o]]}return i}function Qt(t,r,n){var i={};if("function"!=typeof r)for(var o=-1,a=it(arguments,!0,!1,1),s=Ot(t)?a.length:0;++o<s;){var u=a[o];u in t&&(i[u]=t[u])}else r=e.createCallback(r,n,3),En(t,function(t,e,n){r(t,e,n)&&(i[e]=t)});return i}function Zt(t,r,n,i){var o=hn(t);if(null==n)if(o)n=[];else{var a=t&&t.constructor,u=a&&a.prototype;n=s(u)}return r&&(r=e.createCallback(r,i,4),(o?xn:wn)(t,function(t,e,i){return r(n,t,e,i)})),n}function $t(t){for(var e=-1,r=gn(t),n=r.length,i=_r(n);++e<n;)i[e]=t[r[e]];return i}function Kt(t){var e=arguments,r=-1,n=it(e,!0,!1,1),i=e[2]&&e[2][e[1]]===t?1:n.length,o=_r(i);for(un.unindexedChars&&zt(t)&&(t=t.split(""));++r<i;)o[r]=t[n[r]];return o}function Ht(t,e,r){var n=-1,i=dt(),o=t?t.length:0,a=!1;return r=(0>r?en(0,o+r):r)||0,hn(t)?a=i(t,e,r)>-1:"number"==typeof o?a=(zt(t)?t.indexOf(e,r):i(t,e,r))>-1:xn(t,function(t){return++n>=r?!(a=t===e):void 0}),a}function Jt(t,r,n){var i=!0;if(r=e.createCallback(r,n,3),hn(t))for(var o=-1,a=t.length;++o<a&&(i=!!r(t[o],o,t)););else xn(t,function(t,e,n){return i=!!r(t,e,n)});return i}function te(t,r,n){var i=[];if(r=e.createCallback(r,n,3),hn(t))for(var o=-1,a=t.length;++o<a;){var s=t[o];r(s,o,t)&&i.push(s)}else xn(t,function(t,e,n){r(t,e,n)&&i.push(t)});return i}function ee(t,r,n){if(r=e.createCallback(r,n,3),!hn(t)){var i;return xn(t,function(t,e,n){return r(t,e,n)?(i=t,!1):void 0}),i}for(var o=-1,a=t.length;++o<a;){var s=t[o];if(r(s,o,t))return s}}function re(t,r,n){var i;return r=e.createCallback(r,n,3),ie(t,function(t,e,n){return r(t,e,n)?(i=t,!1):void 0}),i}function ne(t,e,r){if(e&&"undefined"==typeof r&&hn(t))for(var n=-1,i=t.length;++n<i&&e(t[n],n,t)!==!1;);else xn(t,e,r);return t}function ie(t,e,r){var n=t,i=t?t.length:0;if(e=e&&"undefined"==typeof r?e:_(e,r,3),hn(t))for(;i--&&e(t[i],i,t)!==!1;);else{if("number"!=typeof i){var o=gn(t);i=o.length}else un.unindexedChars&&zt(t)&&(n=t.split(""));xn(t,function(t,r,a){return r=o?o[--i]:--i,e(n[r],r,a)})}return t}function oe(t,e){var r=m(arguments,2),n=-1,i="function"==typeof e,o=t?t.length:0,a=_r("number"==typeof o?o:0);return ne(t,function(t){a[++n]=(i?e:t[e]).apply(t,r)}),a}function ae(t,r,n){var i=-1,o=t?t.length:0,a=_r("number"==typeof o?o:0);if(r=e.createCallback(r,n,3),hn(t))for(;++i<o;)a[i]=r(t[i],i,t);else xn(t,function(t,e,n){a[++i]=r(t,e,n)});return a}function se(t,r,n){var i=-(1/0),o=i;if("function"!=typeof r&&n&&n[r]===t&&(r=null),null==r&&hn(t))for(var a=-1,s=t.length;++a<s;){var l=t[a];l>o&&(o=l)}else r=null==r&&zt(t)?u:e.createCallback(r,n,3),xn(t,function(t,e,n){var a=r(t,e,n);a>i&&(i=a,o=t)});return o}function ue(t,r,n){var i=1/0,o=i;if("function"!=typeof r&&n&&n[r]===t&&(r=null),null==r&&hn(t))for(var a=-1,s=t.length;++a<s;){var l=t[a];o>l&&(o=l)}else r=null==r&&zt(t)?u:e.createCallback(r,n,3),xn(t,function(t,e,n){var a=r(t,e,n);i>a&&(i=a,o=t)});return o}function le(t,r,n,i){var o=arguments.length<3;if(r=e.createCallback(r,i,4),hn(t)){var a=-1,s=t.length;for(o&&(n=t[++a]);++a<s;)n=r(n,t[a],a,t)}else xn(t,function(t,e,i){n=o?(o=!1,t):r(n,t,e,i)});return n}function ce(t,r,n,i){var o=arguments.length<3;return r=e.createCallback(r,i,4),ie(t,function(t,e,i){n=o?(o=!1,t):r(n,t,e,i)}),n}function he(t,r,n){return r=e.createCallback(r,n,3),te(t,function(t,e,n){return!r(t,e,n)})}function fe(t,e,r){if(t&&"number"!=typeof t.length?t=$t(t):un.unindexedChars&&zt(t)&&(t=t.split("")),null==e||r)return t?t[ut(0,t.length-1)]:y;var n=ge(t);return n.length=rn(en(0,e),n.length),n}function ge(t){var e=-1,r=t?t.length:0,n=_r("number"==typeof r?r:0);return ne(t,function(t){var r=ut(0,++e);n[e]=n[r],n[r]=t}),n}function pe(t){var e=t?t.length:0;return"number"==typeof e?e:gn(t).length}function de(t,r,n){var i;if(r=e.createCallback(r,n,3),hn(t))for(var o=-1,a=t.length;++o<a&&!(i=r(t[o],o,t)););else xn(t,function(t,e,n){return!(i=r(t,e,n))});return!!i}function ve(t,r,n){var i=-1,o=hn(r),a=t?t.length:0,s=_r("number"==typeof a?a:0);for(o||(r=e.createCallback(r,n,3)),ne(t,function(t,e,n){var a=s[++i]=g();o?a.criteria=ae(r,function(e){return t[e]}):(a.criteria=f())[0]=r(t,e,n),a.index=i,a.value=t}),a=s.length,s.sort(l);a--;){var u=s[a];s[a]=u.value,o||d(u.criteria),v(u)}return s}function me(t){return t&&"number"==typeof t.length?un.unindexedChars&&zt(t)?t.split(""):m(t):$t(t)}function be(t){for(var e=-1,r=t?t.length:0,n=[];++e<r;){var i=t[e];i&&n.push(i)}return n}function ye(t){return R(t,it(arguments,!0,!0,1))}function _e(t,r,n){var i=-1,o=t?t.length:0;for(r=e.createCallback(r,n,3);++i<o;)if(r(t[i],i,t))return i;return-1}function xe(t,r,n){var i=t?t.length:0;for(r=e.createCallback(r,n,3);i--;)if(r(t[i],i,t))return i;return-1}function Te(t,r,n){var i=0,o=t?t.length:0;if("number"!=typeof r&&null!=r){var a=-1;for(r=e.createCallback(r,n,3);++a<o&&r(t[a],a,t);)i++}else if(i=r,null==i||n)return t?t[0]:y;return m(t,0,rn(en(0,i),o))}function Ce(t,e,r,n){return"boolean"!=typeof e&&null!=e&&(n=r,r="function"!=typeof e&&n&&n[e]===t?null:e,e=!1),null!=r&&(t=ae(t,r,n)),it(t,e)}function Ee(t,e,r){if("number"==typeof r){var n=t?t.length:0;r=0>r?en(0,n+r):r||0}else if(r){var i=Ie(t,e);return t[i]===e?i:-1}return o(t,e,r)}function we(t,r,n){var i=0,o=t?t.length:0;if("number"!=typeof r&&null!=r){var a=o;for(r=e.createCallback(r,n,3);a--&&r(t[a],a,t);)i++}else i=null==r||n?1:r||i;return m(t,0,rn(en(0,o-i),o))}function Re(){for(var t=[],e=-1,r=arguments.length,n=f(),i=dt(),s=i===o,u=f();++e<r;){var l=arguments[e];(hn(l)||yt(l))&&(t.push(l),n.push(s&&l.length>=w&&c(e?t[e]:u)))}var h=t[0],g=-1,p=h?h.length:0,m=[];t:for(;++g<p;){var b=n[0];if(l=h[g],(b?a(b,l):i(u,l))<0){for(e=r,(b||u).push(l);--e;)if(b=n[e],(b?a(b,l):i(t[e],l))<0)continue t;m.push(l)}}for(;r--;)b=n[r],b&&v(b);return d(n),d(u),m}function Pe(t,r,n){var i=0,o=t?t.length:0;if("number"!=typeof r&&null!=r){var a=o;for(r=e.createCallback(r,n,3);a--&&r(t[a],a,t);)i++}else if(i=r,null==i||n)return t?t[o-1]:y;return m(t,en(0,o-i))}function De(t,e,r){var n=t?t.length:0;for("number"==typeof r&&(n=(0>r?en(0,n+r):rn(r,n-1))+1);n--;)if(t[n]===e)return n;return-1}function Me(t){for(var e=arguments,r=0,n=e.length,i=t?t.length:0;++r<n;)for(var o=-1,a=e[r];++o<i;)t[o]===a&&(Vr.call(t,o--,1),i--);return t}function Se(t,e,r){t=+t||0,r="number"==typeof r?r:+r||1,null==e&&(e=t,t=0);for(var n=-1,i=en(0,Nr((e-t)/(r||1))),o=_r(i);++n<i;)o[n]=t,t+=r;return o}function Ae(t,r,n){var i=-1,o=t?t.length:0,a=[];for(r=e.createCallback(r,n,3);++i<o;){var s=t[i];r(s,i,t)&&(a.push(s),Vr.call(t,i--,1),o--)}return a}function Le(t,r,n){if("number"!=typeof r&&null!=r){var i=0,o=-1,a=t?t.length:0;for(r=e.createCallback(r,n,3);++o<a&&r(t[o],o,t);)i++}else i=null==r||n?1:en(0,r);return m(t,i)}function Ie(t,r,n,i){var o=0,a=t?t.length:o;for(n=n?e.createCallback(n,i,1):ir,r=n(r);a>o;){var s=o+a>>>1;n(t[s])<r?o=s+1:a=s}return o}function ke(){return ct(it(arguments,!0,!0))}function Fe(t,r,n,i){return"boolean"!=typeof r&&null!=r&&(i=n,n="function"!=typeof r&&i&&i[r]===t?null:r,r=!1),null!=n&&(n=e.createCallback(n,i,3)),ct(t,r,n)}function Ue(t){return R(t,m(arguments,1))}function Oe(){for(var t=-1,e=arguments.length;++t<e;){var r=arguments[t];if(hn(r)||yt(r))var n=n?ct(R(n,r).concat(R(r,n))):r}return n||[]}function Ne(){for(var t=arguments.length>1?arguments:arguments[0],e=-1,r=t?se(Sn(t,"length")):0,n=_r(0>r?0:r);++e<r;)n[e]=Sn(t,e);return n}function Xe(t,e){var r=-1,n=t?t.length:0,i={};for(e||!n||hn(t[0])||(e=[]);++r<n;){var o=t[r];e?i[o]=e[r]:o&&(i[o[0]]=o[1])}return i}function Be(t,e){if(!Ut(e))throw new Sr;return function(){return--t<1?e.apply(this,arguments):void 0}}function je(t,e){return arguments.length>2?ft(t,17,m(arguments,2),null,e):ft(t,1,null,null,e)}function ze(t){for(var e=arguments.length>1?it(arguments,!0,!1,1):Pt(t),r=-1,n=e.length;++r<n;){var i=e[r];t[i]=ft(t[i],1,null,null,t)}return t}function Ye(t,e){return arguments.length>2?ft(e,19,m(arguments,2),null,t):ft(e,3,null,null,t)}function Ge(){for(var t=arguments,e=t.length;e--;)if(!Ut(t[e]))throw new Sr;return function(){for(var e=arguments,r=t.length;r--;)e=[t[r].apply(this,e)];return e[0]}}function qe(t,e){return e="number"==typeof e?e:+e||t.length,ft(t,4,null,null,null,e)}function We(t,e,r){var n,i,o,a,s,u,l,c=0,h=!1,f=!0;if(!Ut(t))throw new Sr;if(e=en(0,e)||0,r===!0){var g=!0;f=!1}else Ot(r)&&(g=r.leading,h="maxWait"in r&&(en(e,r.maxWait)||0),f="trailing"in r?r.trailing:f);var p=function(){var r=e-(Ln()-a);if(0>=r){i&&Xr(i);var h=l;i=u=l=y,h&&(c=Ln(),o=t.apply(s,n),u||i||(n=s=null))}else u=Wr(p,r)},d=function(){u&&Xr(u),i=u=l=y,(f||h!==e)&&(c=Ln(),o=t.apply(s,n),u||i||(n=s=null))};return function(){if(n=arguments,a=Ln(),s=this,l=f&&(u||!g),h===!1)var r=g&&!u;else{i||g||(c=a);var v=h-(a-c),m=0>=v;m?(i&&(i=Xr(i)),c=a,o=t.apply(s,n)):i||(i=Wr(d,v))}return m&&u?u=Xr(u):u||e===h||(u=Wr(p,e)),r&&(m=!0,o=t.apply(s,n)),!m||u||i||(n=s=null),o}}function Ve(t){if(!Ut(t))throw new Sr;var e=m(arguments,1);return Wr(function(){t.apply(y,e)},1)}function Qe(t,e){if(!Ut(t))throw new Sr;var r=m(arguments,2);return Wr(function(){t.apply(y,r)},e)}function Ze(t,e){if(!Ut(t))throw new Sr;var r=function(){var n=r.cache,i=e?e.apply(this,arguments):E+arguments[0];return Yr.call(n,i)?n[i]:n[i]=t.apply(this,arguments)};return r.cache={},r}function $e(t){var e,r;if(!Ut(t))throw new Sr;return function(){return e?r:(e=!0,r=t.apply(this,arguments),t=null,r)}}function Ke(t){return ft(t,16,m(arguments,1))}function He(t){return ft(t,32,null,m(arguments,1))}function Je(t,e,r){var n=!0,i=!0;if(!Ut(t))throw new Sr;return r===!1?n=!1:Ot(r)&&(n="leading"in r?r.leading:n,i="trailing"in r?r.trailing:i),tt.leading=n,tt.maxWait=e,tt.trailing=i,We(t,e,tt)}function tr(t,e){return ft(e,16,[t])}function er(t){return function(){return t}}function rr(t,e,r){var n=typeof t;if(null==t||"function"==n)return _(t,e,r);if("object"!=n)return ur(t);var i=gn(t),o=i[0],a=t[o];return 1!=i.length||a!==a||Ot(a)?function(e){for(var r=i.length,n=!1;r--&&(n=at(e[i[r]],t[i[r]],null,!0)););return n}:function(t){var e=t[o];return a===e&&(0!==a||1/a==1/e)}}function nr(t){return null==t?"":Mr(t).replace(_n,pt)}function ir(t){return t}function or(t,n,i){var o=!0,a=n&&Pt(n);n&&(i||a.length)||(null==i&&(i=n),s=r,n=t,t=e,a=Pt(n)),i===!1?o=!1:Ot(i)&&"chain"in i&&(o=i.chain);var s=t,u=Ut(s);ne(a,function(e){var r=t[e]=n[e];u&&(s.prototype[e]=function(){var e=this.__chain__,n=this.__wrapped__,i=[n];Gr.apply(i,arguments);var a=r.apply(t,i);if(o||e){if(n===a&&Ot(a))return this;a=new s(a),a.__chain__=e}return a})})}function ar(){return t._=Fr,this}function sr(){}function ur(t){return function(e){return e[t]}}function lr(t,e,r){var n=null==t,i=null==e;if(null==r&&("boolean"==typeof t&&i?(r=t,t=1):i||"boolean"!=typeof e||(r=e,i=!0)),n&&i&&(e=1),t=+t||0,i?(e=t,t=0):e=+e||0,r||t%1||e%1){var o=on();return rn(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e)}return ut(t,e)}function cr(t,e){if(t){var r=t[e];return Ut(r)?t[e]():r}}function hr(t,r,n){var i=e.templateSettings;t=Mr(t||""),n=Cn({},n,i);var o,a=Cn({},n.imports,i.imports),s=gn(a),u=$t(a),l=0,c=n.interpolate||O,f="__p += '",g=Dr((n.escape||O).source+"|"+c.source+"|"+(c===F?A:O).source+"|"+(n.evaluate||O).source+"|$","g");t.replace(g,function(e,r,n,i,a,s){return n||(n=i),f+=t.slice(l,s).replace(X,h),r&&(f+="' +\n__e("+r+") +\n'"),a&&(o=!0,f+="';\n"+a+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=s+e.length,e}),f+="';\n";var p=n.variable,d=p;d||(p="obj",f="with ("+p+") {\n"+f+"\n}\n"),f=(o?f.replace(D,""):f).replace(M,"$1").replace(S,"$1;"),f="function("+p+") {\n"+(d?"":p+" || ("+p+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+z++ +"]")+"\n*/";try{var m=Er(s,"return "+f+v).apply(y,u)}catch(b){throw b.source=f,b}return r?m(r):(m.source=f,m)}function fr(t,e,r){t=(t=+t)>-1?t:0;var n=-1,i=_r(t);for(e=_(e,r,1);++n<t;)i[n]=e(n);return i}function gr(t){return null==t?"":Mr(t).replace(yn,bt)}function pr(t){var e=++T;return Mr(null==t?"":t)+e}function dr(t){return t=new r(t),t.__chain__=!0,t}function vr(t,e){return e(t),t}function mr(){return this.__chain__=!0,this}function br(){return Mr(this.__wrapped__)}function yr(){return this.__wrapped__}t=t?lt.defaults(ot.Object(),t,lt.pick(ot,B)):ot;var _r=t.Array,xr=t.Boolean,Tr=t.Date,Cr=t.Error,Er=t.Function,wr=t.Math,Rr=t.Number,Pr=t.Object,Dr=t.RegExp,Mr=t.String,Sr=t.TypeError,Ar=[],Lr=Cr.prototype,Ir=Pr.prototype,kr=Mr.prototype,Fr=t._,Ur=Ir.toString,Or=Dr("^"+Mr(Ur).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Nr=wr.ceil,Xr=t.clearTimeout,Br=wr.floor,jr=Er.prototype.toString,zr=vt(zr=Pr.getPrototypeOf)&&zr,Yr=Ir.hasOwnProperty,Gr=Ar.push,qr=Ir.propertyIsEnumerable,Wr=t.setTimeout,Vr=Ar.splice,Qr=Ar.unshift,Zr=function(){try{var t={},e=vt(e=Pr.defineProperty)&&e,r=e(t,t,t)&&e}catch(n){}return r}(),$r=vt($r=Pr.create)&&$r,Kr=vt(Kr=_r.isArray)&&Kr,Hr=t.isFinite,Jr=t.isNaN,tn=vt(tn=Pr.keys)&&tn,en=wr.max,rn=wr.min,nn=t.parseInt,on=wr.random,an={};an[G]=_r,an[q]=xr,an[W]=Tr,an[Q]=Er,an[$]=Pr,an[Z]=Rr,an[K]=Dr,an[H]=Mr;var sn={};sn[G]=sn[W]=sn[Z]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},sn[q]=sn[H]={constructor:!0,toString:!0,valueOf:!0},sn[V]=sn[Q]=sn[K]={constructor:!0,toString:!0},sn[$]={constructor:!0},function(){for(var t=j.length;t--;){var e=j[t];for(var r in sn)Yr.call(sn,r)&&!Yr.call(sn[r],e)&&(sn[r][e]=!1)}}(),r.prototype=e.prototype;var un=e.support={};!function(){var e=function(){this.x=1},r={0:1,length:1},n=[];e.prototype={valueOf:1,y:1};for(var i in new e)n.push(i);for(i in arguments);un.argsClass=Ur.call(arguments)==Y,un.argsObject=arguments.constructor==Pr&&!(arguments instanceof _r),un.enumErrorProps=qr.call(Lr,"message")||qr.call(Lr,"name"),un.enumPrototypes=qr.call(e,"prototype"),un.funcDecomp=!vt(t.WinRTError)&&N.test(b),un.funcNames="string"==typeof Er.name,un.nonEnumArgs=0!=i,un.nonEnumShadows=!/valueOf/.test(n),un.ownLast="x"!=n[0],un.spliceObjects=(Ar.splice.call(r,0,1),!r[0]),un.unindexedChars="x"[0]+Pr("x")[0]!="xx";try{un.nodeClass=!(Ur.call(document)==$&&!({toString:0}+""))}catch(o){un.nodeClass=!0}}(1),e.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:F,variable:"",imports:{_:e}};var ln=function(t){var e="var index, iterable = "+t.firstArg+", result = "+t.init+";\nif (!iterable) return result;\n"+t.top+";";t.array?(e+="\nvar length = iterable.length; index = -1;\nif ("+t.array+") {  ",un.unindexedChars&&(e+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),e+="\n  while (++index < length) {\n    "+t.loop+";\n  }\n}\nelse {  "):un.nonEnumArgs&&(e+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+t.loop+";\n    }\n  } else {  "),un.enumPrototypes&&(e+="\n  var skipProto = typeof iterable == 'function';\n  "),un.enumErrorProps&&(e+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var r=[];if(un.enumPrototypes&&r.push('!(skipProto && index == "prototype")'),un.enumErrorProps&&r.push('!(skipErrorProps && (index == "message" || index == "name"))'),t.useHas&&t.keys)e+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",r.length&&(e+="    if ("+r.join(" && ")+") {\n  "),e+=t.loop+";    ",r.length&&(e+="\n    }"),e+="\n  }  ";else if(e+="\n  for (index in iterable) {\n",t.useHas&&r.push("hasOwnProperty.call(iterable, index)"),r.length&&(e+="    if ("+r.join(" && ")+") {\n  "),e+=t.loop+";    ",r.length&&(e+="\n    }"),e+="\n  }    ",un.nonEnumShadows){for(e+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;k<7;k++)e+="\n    index = '"+t.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",t.useHas||(e+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),e+=") {\n      "+t.loop+";\n    }      ";e+="\n  }    "}return(t.array||un.nonEnumArgs)&&(e+="\n}"),e+=t.bottom+";\nreturn result"};$r||(s=function(){function e(){}return function(r){if(Ot(r)){e.prototype=r;var n=new e;e.prototype=null}return n||t.Object()}}());var cn=Zr?function(t,e){et.value=e,Zr(t,"__bindData__",et),et.value=null}:sr;un.argsClass||(yt=function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Yr.call(t,"callee")&&!qr.call(t,"callee")||!1});var hn=Kr||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Ur.call(t)==G||!1},fn=gt({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),gn=tn?function(t){return Ot(t)?un.enumPrototypes&&"function"==typeof t||un.nonEnumArgs&&t.length&&yt(t)?fn(t):tn(t):[]}:fn,pn={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:gn,loop:"if (callback(iterable[index], index, collection) === false) return result"},dn={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:gn,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},vn={top:"if (!objectTypes[typeof iterable]) return result;\n"+pn.top,array:!1},mn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},bn=Mt(mn),yn=Dr("("+gn(bn).join("|")+")","g"),_n=Dr("["+gn(mn).join("")+"]","g"),xn=gt(pn),Tn=gt(dn,{top:dn.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),Cn=gt(dn),En=gt(pn,vn,{useHas:!1}),wn=gt(pn,vn);Ut(/x/)&&(Ut=function(t){return"function"==typeof t&&Ur.call(t)==Q});var Rn=zr?function(t){if(!t||Ur.call(t)!=$||!un.argsClass&&yt(t))return!1;var e=t.valueOf,r=vt(e)&&(r=zr(e))&&zr(r);return r?t==r||zr(t)==r:mt(t)}:mt,Pn=ht(function(t,e,r){Yr.call(t,r)?t[r]++:t[r]=1}),Dn=ht(function(t,e,r){(Yr.call(t,r)?t[r]:t[r]=[]).push(e)}),Mn=ht(function(t,e,r){t[r]=e}),Sn=ae,An=te,Ln=vt(Ln=Tr.now)&&Ln||function(){return(new Tr).getTime()},In=8==nn(P+"08")?nn:function(t,e){return nn(zt(t)?t.replace(U,""):t,e||0)};return e.after=Be,e.assign=Tn,e.at=Kt,e.bind=je,e.bindAll=ze,e.bindKey=Ye,e.chain=dr,e.compact=be,e.compose=Ge,e.constant=er,e.countBy=Pn,e.create=Tt,e.createCallback=rr,e.curry=qe,e.debounce=We,e.defaults=Cn,e.defer=Ve,e.delay=Qe,e.difference=ye,e.filter=te,e.flatten=Ce,e.forEach=ne,e.forEachRight=ie,e.forIn=En,e.forInRight=wt,e.forOwn=wn,e.forOwnRight=Rt,e.functions=Pt,e.groupBy=Dn,e.indexBy=Mn,e.initial=we,e.intersection=Re,e.invert=Mt,e.invoke=oe,e.keys=gn,e.map=ae,e.mapValues=Gt,e.max=se,e.memoize=Ze,e.merge=qt,e.min=ue,e.omit=Wt,e.once=$e,e.pairs=Vt,e.partial=Ke,e.partialRight=He,e.pick=Qt,e.pluck=Sn,e.property=ur,e.pull=Me,e.range=Se,e.reject=he,e.remove=Ae,e.rest=Le,e.shuffle=ge,e.sortBy=ve,e.tap=vr,e.throttle=Je,e.times=fr,e.toArray=me,e.transform=Zt,e.union=ke,e.uniq=Fe,e.values=$t,e.where=An,e.without=Ue,e.wrap=tr,e.xor=Oe,e.zip=Ne,e.zipObject=Xe,e.collect=ae,e.drop=Le,e.each=ne,e.eachRight=ie,e.extend=Tn,e.methods=Pt,e.object=Xe,e.select=te,e.tail=Le,e.unique=Fe,e.unzip=Ne,or(e),e.clone=_t,e.cloneDeep=xt,e.contains=Ht,e.escape=nr,e.every=Jt,e.find=ee,e.findIndex=_e,e.findKey=Ct,e.findLast=re,e.findLastIndex=xe,e.findLastKey=Et,e.has=Dt,e.identity=ir,e.indexOf=Ee,e.isArguments=yt,e.isArray=hn,e.isBoolean=St,e.isDate=At,e.isElement=Lt,e.isEmpty=It,e.isEqual=kt,e.isFinite=Ft,e.isFunction=Ut,e.isNaN=Nt,e.isNull=Xt,e.isNumber=Bt,e.isObject=Ot,e.isPlainObject=Rn,e.isRegExp=jt,e.isString=zt,e.isUndefined=Yt,e.lastIndexOf=De,e.mixin=or,e.noConflict=ar,e.noop=sr,e.now=Ln,e.parseInt=In,e.random=lr,e.reduce=le,e.reduceRight=ce,e.result=cr,e.runInContext=b,e.size=pe,e.some=de,e.sortedIndex=Ie,e.template=hr,e.unescape=gr,e.uniqueId=pr,e.all=Jt,e.any=de,e.detect=ee,e.findWhere=ee,e.foldl=le,e.foldr=ce,e.include=Ht,e.inject=le,or(function(){var t={};return wn(e,function(r,n){e.prototype[n]||(t[n]=r)}),t}(),!1),e.first=Te,e.last=Pe,e.sample=fe,e.take=Te,e.head=Te,wn(e,function(t,n){var i="sample"!==n;e.prototype[n]||(e.prototype[n]=function(e,n){var o=this.__chain__,a=t(this.__wrapped__,e,n);return o||null!=e&&(!n||i&&"function"==typeof e)?new r(a,o):a})}),e.VERSION="2.4.2",e.prototype.chain=mr,e.prototype.toString=br,e.prototype.value=yr,e.prototype.valueOf=yr,xn(["join","pop","shift"],function(t){var n=Ar[t];e.prototype[t]=function(){var t=this.__chain__,e=n.apply(this.__wrapped__,arguments);return t?new r(e,t):e}}),xn(["push","reverse","sort","unshift"],function(t){var r=Ar[t];e.prototype[t]=function(){return r.apply(this.__wrapped__,arguments),this}}),xn(["concat","slice","splice"],function(t){var n=Ar[t];e.prototype[t]=function(){return new r(n.apply(this.__wrapped__,arguments),this.__chain__)}}),un.spliceObjects||xn(["pop","shift","splice"],function(t){var n=Ar[t],i="splice"==t;e.prototype[t]=function(){var t=this.__chain__,e=this.__wrapped__,o=n.apply(e,arguments);
return 0===e.length&&delete e[0],t||i?new r(o,t):o}}),e}var y,_=[],x=[],T=0,C={},E=+new Date+"",w=75,R=40,P=" 	\f\ufeff\n\r\u2028\u2029",D=/\b__p \+= '';/g,M=/\b(__p \+=) '' \+/g,S=/(__e\(.*?\)|\b__t\)) \+\n'';/g,A=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,L=/\w*$/,I=/^\s*function[ \n\r\t]+\w/,F=/<%=([\s\S]+?)%>/g,U=RegExp("^["+P+"]*0+(?=.$)"),O=/($^)/,N=/\bthis\b/,X=/['\n\r\t\u2028\u2029\\]/g,B=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],j=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],z=0,Y="[object Arguments]",G="[object Array]",q="[object Boolean]",W="[object Date]",V="[object Error]",Q="[object Function]",Z="[object Number]",$="[object Object]",K="[object RegExp]",H="[object String]",J={};J[Q]=!1,J[Y]=J[G]=J[q]=J[W]=J[Z]=J[$]=J[K]=J[H]=!0;var tt={leading:!1,maxWait:0,trailing:!1},et={configurable:!1,enumerable:!1,value:null,writable:!1},rt={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},nt={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},it={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},ot=nt[typeof window]&&window||this,at=nt[typeof e]&&e&&!e.nodeType&&e,st=nt[typeof t]&&t&&!t.nodeType&&t,ut=(st&&st.exports===at&&at,nt[typeof i]&&i);!ut||ut.global!==ut&&ut.window!==ut||(ot=ut);var lt=b();ot._=lt,n=function(){return lt}.call(e,r,e,t),!(n!==y&&(t.exports=n))}).call(this)}).call(e,r(14)(t),function(){return this}())},function(t,e,r){function n(t,e,r){o(t,function(n,o){return i(t,o)?e.call(r,t[o],o,t):void 0})}var i=r(8),o=r(61);t.exports=n},function(t,e,r){var n;n=function(){function t(t){return!!t&&"object"==typeof t&&t.constructor===Object}return t}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,r){var n,i;n=[r(10),r(69)],i=function(t,e){function r(r,n,i){e(r,function(e,o){return t(r,o)?n.call(i,r[o],o,r):void 0})}return r}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(34),i=r(38),o=r(40),a=r(41);e.builder=n,e.model=i,e.painter=o,e.util=a},function(t,e,r){"use strict";function n(t,e){var r=this;this.handleRecord=!0,this.handleExploration=!0,this.queryDataModel=t,this.pipelineModel=e,this.metadata=t.originalData.CompositePipeline,this.pushMethod="pushToFrontAsBuffer",this.compositeMap={},this.offsetMap={},this.spriteSize=o(this.metadata.offset),this.query=null,this.composite=null,this.bgCanvas=new i(this.metadata.dimensions[0],this.metadata.dimensions[1]),this.fgCanvas=null,this.dataSubscription=t.onDataChange(function(t,e){r.sprite=t.sprite,r.composite=t.composite.data["pixel-order"].split("+"),r.updateCompositeMap(r.query,r.composite),r.render()}),this.pipelineSubscription=this.pipelineModel.onChange(function(t,e){r.setPipelineQuery(t)}),this.setPipelineQuery(this.pipelineModel.getPipelineQuery())}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(3),o=r(5),a=r(2),s="image-ready";a.mixInto(n),n.prototype.getDimensions=function(){return this.metadata.dimensions},n.prototype.updateOffsetMap=function(t){var e=this.metadata.layers,r=e.length,n=this.metadata.offset;this.offsetMap={},this.compositeMap={};for(var i=0;r>i;i++){var o=t[2*i+1];"_"===o?this.offsetMap[e[i]]=-1:this.offsetMap[e[i]]=this.spriteSize-n[e[i]+o]}},n.prototype.update=function(){this.queryDataModel.fetchData()},n.prototype.setPushMethodAsBuffer=function(){this.pushMethod="pushToFrontAsBuffer"},n.prototype.setPushMethodAsImage=function(){this.pushMethod="pushToFrontAsImage"},n.prototype.setPipelineQuery=function(t){this.query!==t&&(this.query=t,this.updateOffsetMap(t),this.updateCompositeMap(t,this.composite),this.render())},n.prototype.updateCompositeMap=function(t,e){if(null!==t&&null!==e)for(var r=e,n=r.length,i=this.compositeMap;n--;){var o=r[n];if("@"===o[0]);else if(i.hasOwnProperty(o));else{for(var a=-1,s=0,u=o.length;u>s;s++)a=this.offsetMap[o[s]],-1!==a&&(s=u);i[o]=a}}},n.prototype.render=function(){function t(t){s+=t,u+=Math.floor(s/l),s%=l}var e=this;if(!this.sprite)return void this.queryDataModel.fetchData();if(null!==this.query){var r=this.bgCanvas.get2DContext(),n=this.metadata.dimensions,i=1,o=this.composite,a=o.length,s=0,u=0,l=n[0];if(this.sprite.image.complete){this.sprite.image.onload&&(this.sprite.image.onload=null),r.clearRect(0,0,n[0],n[1]);for(var c=0;a>c;c++){var h=o[c];"@"===h[0]?t(Number(h.replace(/@/,"+"))):(i=this.compositeMap[h],-1!==i&&r.drawImage(this.sprite.image,s,u+n[1]*i,1,1,s,u,1,1),t(1))}this.pushToFront(n[0],n[1])}else this.sprite.image.onload=function(){e.render()}}},n.prototype.pushToFront=function(t,e){this[this.pushMethod](t,e)},n.prototype.pushToFrontAsImage=function(t,e){var r=null;this.fgCanvas?this.fgCanvas.size(t,e):this.fgCanvas=new i(t,e),r=this.fgCanvas.get2DContext(),r.drawImage(this.bgCanvas.el,0,0,t,e,0,0,t,e);var n={url:this.fgCanvas.toDataURL(),builder:this};this.emit(s,n)},n.prototype.pushToFrontAsBuffer=function(t,e){var r={canvas:this.bgCanvas.el,imageData:this.bgCanvas.el.getContext("2d").getImageData(0,0,t,e),area:[0,0,t,e],outputSize:[t,e],builder:this,arguments:this.queryDataModel.getQuery()};r.arguments.pipeline=this.query,this.emit(s,r),this.queryDataModel.nextExploration()},n.prototype.onImageReady=function(t){return this.on(s,t)},n.prototype.destroy=function(){this.off(s),this.dataSubscription.unsubscribe(),this.dataSubscription=null,this.pipelineSubscription.unsubscribe(),this.pipelineSubscription=null,this.queryDataModel=null,this.bgCanvas.destroy(),this.bgCanvas=null},n.prototype.getListeners=function(){return this.queryDataModel.getTonicMouseListener()},n.prototype.getControlWidgets=function(){return["CompositeControl","QueryDataModelWidget"]},n.prototype.getQueryDataModel=function(){return this.queryDataModel},n.prototype.getPipelineModel=function(){return this.pipelineModel},t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e){var r=this;this.queryDataModel=t,this.metadata=t.originalData.InSituDataProber||t.originalData.DataProber,this.lookupTableManager=e,this.fieldIndex=0,this.renderMethodMutable=!0,this.renderMethod="XY",this.lastImageStack=null,this.workImage=new Image,this.triggerProbeLines=!1,this.broadcastCrossHair=!0,this.scalars={},this.probeValue=0,this.probeXYZ=[Math.floor(this.metadata.dimensions[0]/2),Math.floor(this.metadata.dimensions[1]/2),Math.floor(this.metadata.dimensions[2]/2)],this.setField(this.metadata.fields[this.fieldIndex]),this.pushMethod="pushToFrontAsBuffer",this.lookupTableManager.addFields(this.metadata.ranges,this.queryDataModel.originalData.LookupTables),this.lutActiveSubscription=this.lookupTableManager.onActiveLookupTableChange(function(t,e){r.getField()!==t&&(r.setField(t),r.render())});for(var n=0,o=0;3>o;++o){var a=this.metadata.dimensions[o];n=a>n?a:n}this.bgCanvas=new i(n,n),this.fgCanvas=null,this.dataSubscription=t.onDataChange(function(t,e){r.lastImageStack=t;var n=!0,i=function(){r.render()};for(var o in t){var a=t[o].image;a.addEventListener("load",i),n=n&&a.complete}n&&r.render()}),this.lutChangeSubscription=this.lookupTableManager.onChange(function(t,e){r.update()});var s=this;this.mouseListener={click:function(t,e){if(!t.activeArea)return!1;var r=[s.probeXYZ[0],s.probeXYZ[1],s.probeXYZ[2]],n=h[s.renderMethod].idx,i=s.metadata.dimensions,o=t.activeArea,a=(t.relative.x-o[0])/o[2],u=(t.relative.y-o[1])/o[3];if(t.modifier)return!1;a=0>a?0:a>1?1:a,u=0>u?0:u>1?1:u;var l=Math.floor(a*i[n[0]]),c=Math.floor(u*i[n[1]]);return r[n[0]]=l,r[n[1]]=c,s.setProbe(r[0],r[1],r[2]),!0},drag:function(t,e){if(!t.activeArea)return!1;var r=[s.probeXYZ[0],s.probeXYZ[1],s.probeXYZ[2]],n=h[s.renderMethod].idx,i=s.metadata.dimensions,o=t.activeArea,a=(t.relative.x-o[0])/o[2],u=(t.relative.y-o[1])/o[3];if(t.modifier)return!1;a=0>a?0:a>1?1:a,u=0>u?0:u>1?1:u;var l=Math.floor(a*i[n[0]]),c=Math.floor(u*i[n[1]]);return r[n[0]]=l,r[n[1]]=c,s.setProbe(r[0],r[1],r[2]),!0},zoom:function(t,e){var r=[s.probeXYZ[0],s.probeXYZ[1],s.probeXYZ[2]],n=h[s.renderMethod].idx,i=n[2];return t.modifier?!1:(r[i]+=t.deltaY<0?-1:1,r[i]<0?(r[i]=0,!0):r[i]>=s.metadata.dimensions[i]?(r[i]=s.metadata.dimensions[i]-1,!0):(s.setProbe(r[0],r[1],r[2]),!0))}}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(3),o=r(2),a="image-ready",s="ProbeImageBuilder.chart.data.ready",u="ProbeImageBuilder.probe.location.change",l="ProbeImageBuilder.crosshair.visibility.change",c="ProbeImageBuilder.render.change",h={XY:{idx:[0,1,2],hasChange:function(t,e,r,n){return t[2]!==n},updateProbeValue:function(t,e,r,n){var i=t.metadata.dimensions[0],o=e+r*i,a=t.scalars[t.getField()];a&&(t.probeValue=a[o])}},XZ:{idx:[0,2,1],hasChange:function(t,e,r,n){return t[1]!==r},updateProbeValue:function(t,e,r,n){var i=t.metadata.dimensions[0],o=e+n*i,a=t.scalars[t.getField()];a&&(t.probeValue=a[o])}},ZY:{idx:[2,1,0],hasChange:function(t,e,r,n){return t[0]!==e},updateProbeValue:function(t,e,r,n){var i=t.metadata.dimensions[2],o=n+r*i,a=t.scalars[t.getField()];a&&(t.probeValue=a[o])}}};o.mixInto(n),n.prototype.setPushMethodAsBuffer=function(){this.pushMethod="pushToFrontAsBuffer"},n.prototype.setPushMethodAsImage=function(){this.pushMethod="pushToFrontAsImage"},n.prototype.setProbeLineNotification=function(t){this.triggerProbeLines=t},n.prototype.getYOffset=function(t){return void 0===t&&(t=this.probeXYZ[2]),this.metadata.sprite_size-t%this.metadata.sprite_size-1},n.prototype.getImage=function(t,e){void 0===t&&(t=this.probeXYZ[2]);var r=this.metadata.slices.length-1,n=Math.floor(t/this.metadata.sprite_size);n=0>n?0:n>r?r:n;var i=this.lastImageStack[this.metadata.slices[n]],o=i.image;o?o.complete?e.call(o):o.addEventListener("load",e):(this.workImage.addEventListener("load",e),this.workImage.src=i.url)},n.prototype.update=function(){this.queryDataModel.fetchData()},n.prototype.setProbe=function(t,e,r){var n=h[this.renderMethod].hasChange,i=h[this.renderMethod].idx,o=[].concat(this.probeXYZ);if(Array.isArray(t)&&(r=t[2],e=t[1],t=t[0]),n(this.probeXYZ,t,e,r))this.probeXYZ=[t,e,r],this.render();else{this.probeXYZ=[t,e,r];var a=this.metadata.dimensions,s=this.metadata.spacing;h[this.renderMethod].updateProbeValue(this,t,e,r),this.pushToFront(a[i[0]],a[i[1]],s[i[0]],s[i[1]],this.probeXYZ[i[0]],this.probeXYZ[i[1]])}(o[0]!==t||o[1]!==e||o[2]!==r)&&this.emit(u,[t,e,r])},n.prototype.getProbe=function(){return this.probeXYZ},n.prototype.getFieldValueAtProbeLocation=function(){return this.probeValue},n.prototype.getProbeLine=function(t){for(var e={name:this.getField(),data:[]},r={xRange:[0,100],fields:[e]},n=-1,i=h[this.renderMethod].idx,o=0;2>o;o++)t===i[o]&&(n=o);if(-1!==n){var a=this.scalars[e.name],s=this.metadata.dimensions,u=s[i[0]],l=s[i[1]],c=0===n?1:u,f=0===n?this.probeXYZ[i[1]]*u:this.probeXYZ[i[0]],g=0===n?u:l;if(this.metadata.origin&&this.metadata.spacing&&(r.xRange[0]=this.metadata.origin[t],r.xRange[1]=this.metadata.origin[t]+this.metadata.spacing[t]*s[t]),a)for(var p=0;g>p;p++)e.data.push(a[f+p*c])}return r},n.prototype.render=function(){this.lastImageStack&&(this["render"+this.renderMethod](),h[this.renderMethod].updateProbeValue(this,this.probeXYZ[0],this.probeXYZ[1],this.probeXYZ[2]))},n.prototype.pushToFront=function(t,e,r,n,i,o){this[this.pushMethod](t,e,r,n,i,o),this.triggerProbeLines&&this.emit(s,{x:this.getProbeLine(0),y:this.getProbeLine(1),z:this.getProbeLine(2)})},n.prototype.pushToFrontAsImage=function(t,e,r,n,o,s){var u=Math.floor(t*r),l=Math.floor(e*n),c=null;this.fgCanvas?this.fgCanvas.size(u,l):this.fgCanvas=new i(u,l),c=this.fgCanvas.get2DContext(),c.drawImage(this.bgCanvas.el,0,0,t,e,0,0,u,l),c.beginPath(),c.moveTo(o*r,0),c.lineTo(o*r,l),c.moveTo(0,s*n),c.lineTo(u,s*n),c.strokeStyle="#ffffff",c.lineWidth=1,c.stroke();var h={url:this.fgCanvas.toDataURL(),type:this.renderMethod,builder:this};this.emit(a,h)},n.prototype.pushToFrontAsBuffer=function(t,e,r,n,i,o){var s=Math.floor(t*r),u=Math.floor(e*n),l={canvas:this.bgCanvas.el,imageData:this.bgCanvas.el.getContext("2d").getImageData(0,0,t,e),area:[0,0,t,e],outputSize:[s,u],type:this.renderMethod,builder:this};this.broadcastCrossHair&&(l.crosshair=[i,o]),this.emit(a,l)},n.prototype.renderXY=function(){var t=this,e=this.bgCanvas.get2DContext(),r=this.getYOffset(),n=this.probeXYZ,i=this.metadata.dimensions,o=this.metadata.spacing;this.getImage(this.probeXYZ[2],function(){var a=this;e.drawImage(a,0,i[1]*r,i[0],i[1],0,0,i[0],i[1]),t.extractNumericalValues(i[0],i[1]),t.applyLookupTable(i[0],i[1]),t.pushToFront(i[0],i[1],o[0],o[1],n[0],n[1])})},n.prototype.renderZY=function(){function t(){var s=e.getYOffset(o),u=this;r.drawImage(u,n[0],i[1]*s,1,i[1],o,0,1,i[1]),o--?e.getImage(o,t):(e.extractNumericalValues(i[2],i[1]),e.applyLookupTable(i[2],i[1]),e.pushToFront(i[2],i[1],a[2],a[1],n[2],n[1]))}var e=this,r=this.bgCanvas.get2DContext(),n=(this.getYOffset(),this.probeXYZ),i=this.metadata.dimensions,o=i[2],a=this.metadata.spacing;o--&&e.getImage(o,t)},n.prototype.renderXZ=function(){function t(){var s=e.getYOffset(a),u=this;r.drawImage(u,0,i[1]*s+n[1],i[0],1,0,a,i[0],1),a--?e.getImage(a,t):(e.extractNumericalValues(i[0],i[2]),e.applyLookupTable(i[0],i[2]),e.pushToFront(i[0],i[2],o[0],o[2],n[0],n[2]))}var e=this,r=this.bgCanvas.get2DContext(),n=(this.getYOffset(),this.probeXYZ),i=this.metadata.dimensions,o=this.metadata.spacing,a=i[2];a--&&e.getImage(a,t)},n.prototype.isCrossHairEnabled=function(){return this.broadcastCrossHair},n.prototype.setCrossHairEnable=function(t){this.broadcastCrossHair!==t&&(this.broadcastCrossHair=t,this.emit(l,t),this.setProbe(this.probeXYZ[0],this.probeXYZ[1],this.probeXYZ[2]))},n.prototype.extractNumericalValues=function(t,e){for(var r=this.bgCanvas.get2DContext(),n=this.getField(),i=r.getImageData(0,0,t,e),o=i.data,a=o.length,s=0,u=this.metadata.ranges[n],l=u[1]-u[0],c=0,h=new Float32Array(t*e);a>s;){var f=(o[s]+256*o[s+1]+65536*o[s+2])/16777216*l+u[0];h[c++]=f,s+=4}this.scalars[n]=h},n.prototype.applyLookupTable=function(t,e){var r=this.bgCanvas.get2DContext(),n=this.getField(),i=this.lookupTableManager.getLookupTable(n),o=r.getImageData(0,0,t,e),a=o.data,s=a.length,u=0,l=0,c=this.scalars[n];if(i){for(;s>u;){var h=i.getColor(c[l++]);a[u]=Math.floor(255*h[0]),a[u+1]=Math.floor(255*h[1]),a[u+2]=Math.floor(255*h[2]),u+=4}r.putImageData(o,0,0)}},n.prototype.setField=function(t){this.queryDataModel.setValue("field",t)},n.prototype.getField=function(){return this.queryDataModel.getValue("field")},n.prototype.getFields=function(){return this.metadata.fields},n.prototype.setRenderMethod=function(t){this.renderMethodMutable&&this.renderMethod!==t&&(this.renderMethod=t,this.render(),this.emit(c,t))},n.prototype.getRenderMethod=function(){return this.renderMethod},n.prototype.getRenderMethods=function(){return["XY","ZY","XZ"]},n.prototype.isRenderMethodMutable=function(){return this.renderMethodMutable},n.prototype.setRenderMethodImutable=function(){this.renderMethodMutable=!1},n.prototype.setRenderMethodMutable=function(){this.renderMethodMutable=!0},n.prototype.getListeners=function(){return this.mouseListener},n.prototype.onImageReady=function(t){return this.on(a,t)},n.prototype.onProbeLineReady=function(t){return this.on(s,t)},n.prototype.onProbeChange=function(t){return this.on(u,t)},n.prototype.onRenderMethodChange=function(t){return this.on(c,t)},n.prototype.onCrosshairVisibilityChange=function(t){return this.on(l,t)},n.prototype.destroy=function(){this.off(),this.lutActiveSubscription.unsubscribe(),this.lutActiveSubscription=null,this.lutChangeSubscription.unsubscribe(),this.lutChangeSubscription=null,this.dataSubscription.unsubscribe(),this.dataSubscription=null,this.queryDataModel=null,this.bgCanvas.destroy(),this.bgCanvas=null,this.workImage=null},n.prototype.getControlWidgets=function(){return["LookupTableManagerWidget","ProbeControl","QueryDataModelWidget"]},n.prototype.getQueryDataModel=function(){return this.queryDataModel},n.prototype.getLookupTable=function(){return this.lookupTableManager.getLookupTable(this.getField())},n.prototype.getOriginalRange=function(){return this.metadata.ranges[this.getField()]},n.prototype.getLookupTableManager=function(){return this.lookupTableManager},t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(3),a=r(2),s="image-ready",u="model-change",l=function(){function t(e,r){var i=arguments.length<=2||void 0===arguments[2]?"#ff0000":arguments[2],a=this,s=arguments.length<=3||void 0===arguments[3]?.1:arguments[3],u=arguments.length<=4||void 0===arguments[4]?.5:arguments[4];n(this,t),this.frontImageBuilder=e,this.backImageBuilder=r,this.frontEvent=null,this.backEvent=null,this.frontSubscription=this.frontImageBuilder.onImageReady(function(t,e){a.frontEvent=t,a.draw()}),this.backSubscription=this.backImageBuilder.onImageReady(function(t,e){a.backEvent=t,a.draw()}),this.width=e.getDimensions()[0],this.height=e.getDimensions()[1],this.frontActive=!0,this.minZoom=this.width*s,this.maxZoom=this.width*u,this.lensColor=i,this.lensCenterX=this.width/2,this.lensCenterY=this.height/2,this.lensOriginalCenterX=this.lensCenterX,this.lensOriginalCenterY=this.lensCenterY,this.lensRadius=Math.floor(Math.min(this.width,this.height)/5),this.lensOriginalRadius=this.lensRadius,this.bgCanvas=new o(this.width,this.height),this.listener={drag:function(t,e){var r=!1,n=t.activeArea,i=(t.relative.x-n[0])/n[2],o=(t.relative.y-n[1])/n[3];i=0>i?0:i>1?1:i,o=0>o?0:o>1?1:o;var s=Math.floor(i*a.width),u=Math.floor(o*a.height),l=Math.pow(s-a.lensCenterX,2)+Math.pow(u-a.lensCenterY,2);t.isFirst&&(a.lensOriginalCenterX=a.lensCenterX,a.lensOriginalCenterY=a.lensCenterY),l<Math.pow(a.lensRadius,2)&&0===t.modifier&&(r=!0,a.lensCenterX=a.lensOriginalCenterX+t.deltaX,a.lensCenterY=a.lensOriginalCenterY+t.deltaY,a.lensCenterX=Math.max(a.lensCenterX,a.lensRadius),a.lensCenterY=Math.max(a.lensCenterY,a.lensRadius),a.lensCenterX=Math.min(a.lensCenterX,a.width-a.lensRadius),a.lensCenterY=Math.min(a.lensCenterY,a.height-a.lensRadius),t.isFinal&&(a.lensOriginalCenterX=a.lensCenterX,a.lensOriginalCenterY=a.lensCenterY),a.draw());var c=a.frontImageBuilder.getListeners();return!r&&c&&c.drag&&(r=c.drag(t,e)),r},zoom:function l(t,e){var r=!1,n=t.activeArea,i=(t.relative.x-n[0])/n[2],o=(t.relative.y-n[1])/n[3];i=0>i?0:i>1?1:i,o=0>o?0:o>1?1:o;var s=Math.floor(i*a.width),u=Math.floor(o*a.height),c=Math.pow(s-a.lensCenterX,2)+Math.pow(u-a.lensCenterY,2);if(c<Math.pow(a.lensRadius,2)&&0===t.modifier){r=!0,t.isFirst&&(a.lensOriginalRadius=a.lensRadius);var l=a.lensOriginalRadius*t.scale;l<a.minZoom&&(l=a.minZoom),l>a.maxZoom&&(l=a.maxZoom),a.lensRadius!==l&&(a.lensRadius=l,a.draw()),t.isFinal&&(a.lensOriginalRadius=a.lensRadius)}var h=a.frontImageBuilder.getListeners();return!r&&h&&h.zoom&&(r=h.zoom(t,e)),r}}}return i(t,[{key:"draw",value:function(){if(this.frontEvent&&this.backEvent){var t=this.bgCanvas.get2DContext();t.clearRect(0,0,this.width,this.height),t.drawImage(this.backEvent.canvas,this.backEvent.area[0],this.backEvent.area[1],this.backEvent.area[2],this.backEvent.area[3],0,0,this.width,this.height),t.save(),t.beginPath(),t.arc(this.lensCenterX,this.lensCenterY,this.lensRadius,0,2*Math.PI),t.clip(),t.clearRect(0,0,this.width,this.height),t.drawImage(this.frontEvent.canvas,this.frontEvent.area[0],this.frontEvent.area[1],this.frontEvent.area[2],this.frontEvent.area[3],0,0,this.width,this.height),t.restore(),t.beginPath(),t.lineWidth=4,t.strokeStyle=this.lensColor,t.arc(this.lensCenterX,this.lensCenterY,this.lensRadius,0,2*Math.PI),t.closePath(),t.stroke();var e={canvas:this.bgCanvas.el,area:[0,0,this.width,this.height],outputSize:[this.width,this.height],builder:this,arguments:this.frontEvent.arguments};this.emit(s,e)}}},{key:"update",value:function(){this.frontImageBuilder.update(),this.backImageBuilder.update()}},{key:"render",value:function(){this.frontImageBuilder.render(),this.backImageBuilder.render()}},{key:"onImageReady",value:function(t){return this.on(s,t)}},{key:"onModelChange",value:function(t){return this.on(u,t)}},{key:"getListeners",value:function(){return this.listener}},{key:"destroy",value:function(){this.off(),this.listener=null,this.frontSubscription.unsubscribe(),this.frontSubscription=null,this.backSubscription.unsubscribe(),this.backSubscription=null,this.frontImageBuilder.destroy(),this.backImageBuilder.destroy()}},{key:"getActiveImageBuilder",value:function(){return this.frontActive?this.frontImageBuilder:this.backImageBuilder}},{key:"isFront",value:function(){return this.frontActive}},{key:"toggleLens",value:function(){this.frontActive=!this.frontActive,this.emit(u)}},{key:"getQueryDataModel",value:function(){return this.frontImageBuilder.getQueryDataModel()}}]),t}();e["default"]=l,a.mixInto(l),t.exports=e["default"]},function(t,e,r){"use strict";function n(){var t=arguments.length<=0||void 0===arguments[0]?"a-b":arguments[0],e=arguments.length<=1||void 0===arguments[1]?["a","b"]:arguments[1];this.data={},this.listeners={},this.dataSize=[200,200],this.operation=t,this.dependency=e,this.bgCanvas=new i(this.dataSize[0],this.dataSize[1])}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(3),o=r(2),a="image-ready";o.mixInto(n),n.prototype.getDimensions=function(){return this.dataSize},n.prototype.setOperation=function(t){this.operation=t,this.processData()},n.prototype.getOperation=function(){return this.operation},n.prototype.setDependencies=function(t){this.dependency=t},n.prototype.updateOperationFunction=function(){var t=this,e=[],r=!0;for(var n in this.data)e.push("var X = data.X[i];".replace(/X/g,n));return this.dependency.forEach(function(e){r=t.data[e]&&r}),e.push("return X;".replace(/X/g,this.operation)),this.fnOperation=new Function("data","i",e.join("")),r},n.prototype.updateData=function(t,e){var r=this,n=e.area,i=e.canvas,o=n[0],a=n[1],s=n[2],u=n[3],l=this.bgCanvas.get2DContext(),c=new Uint8ClampedArray(s*u*4),h=null;this.bgCanvas.size(s,u),l.drawImage(i,o,a,s,u,0,0,s,u),h=l.getImageData(0,0,s,u),c.set(h.data),this.data[t]=c,this.dataSize=[s,u];var f=!0;this.dependency.forEach(function(t){r.data[t]||(f=!1)}),f&&this.processData()},n.prototype.updateDataFromImage=function(t,e){var r=this,n=function i(){e.removeEventListener("load",i);var n=e.width,o=e.height,a=r.bgCanvas.get2DContext(),s=new Uint8ClampedArray(n*o*4),u=null;r.bgCanvas.size(n,o),a.drawImage(e,0,0),u=a.getImageData(0,0,n,o),s.set(u.data),r.data[t]=s,r.dataSize=[n,o];var l=!0;r.dependency.forEach(function(t){r.data[t]||(l=!1)}),l&&r.processData()};e.complete?n():e.addEventListener("load",n)},n.prototype.updateDataFromClampedArray=function(t,e,r){var n=this;this.data[t]=e,this.dataSize=r||this.dataSize;var i=!0;this.dependency.forEach(function(t){n.data[t]||(i=!1)}),i&&this.processData()},n.prototype.processData=function(){if(this.updateOperationFunction()){var t=-1,e=!0;for(var r in this.data){var n=this.data[r];-1===t?t=n.length:e=e&&t===n.length}if(!e||-1===t)return void console.log("The array size are invalid!!!",t);if(this.dataSize[0]*this.dataSize[1]*4!==t)return void console.log("The array size are invalid!!!",t,this.dataSize);for(var i=0,o=new Uint8ClampedArray(t);t>i;)o[i]=this.fnOperation(this.data,i),o[i+1]=this.fnOperation(this.data,i+1),o[i+2]=this.fnOperation(this.data,i+2),o[i+3]=255,i+=4;this.bgCanvas.size(this.dataSize[0],this.dataSize[1]);var s=this.bgCanvas.get2DContext(),u=s.getImageData(0,0,this.dataSize[0],this.dataSize[1]);u.data.set(o),s.putImageData(u,0,0);var l={canvas:this.bgCanvas.el,area:[0,0].concat(this.dataSize),outputSize:this.dataSize,builder:this};this.emit(a,l)}},n.prototype.onImageReady=function(t){return this.on(a,t)},n.prototype.destroy=function(){this.bgCanvas.destroy()},n.prototype.getListeners=function(){return this.listeners},n.prototype.setListeners=function(t){this.listeners=t},n.prototype.getControlWidgets=function(){return["PixelOperatorControl"]},t.exports=e["default"]},function(t,e,r){"use strict";function n(t){var e=this;this.queryDataModel=t,this.lastQueryImage=null,this.onLoadCallback=function(){e.lastQueryImage.removeEventListener("load",e.onLoadCallback),e.render()},this.dataSubscription=t.onDataChange(function(t,r){e.lastQueryImage&&e.lastQueryImage.removeEventListener("load",e.onLoadCallback),e.lastQueryImage=t.image.image,e.render()})}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(2),o="image-ready";i.mixInto(n),n.prototype.getDimensions=function(){return[this.lastQueryImage.width,this.lastQueryImage.height]},n.prototype.update=function(){this.queryDataModel.fetchData()},n.prototype.render=function(){if(!this.lastQueryImage)return void this.queryDataModel.fetchData();if(this.lastQueryImage.complete){var t=this.lastQueryImage.width,e=this.lastQueryImage.height;this.emit(o,{canvas:this.lastQueryImage,area:[0,0,t,e],outputSize:[t,e],builder:this})}else this.lastQueryImage.addEventListener("load",this.onLoadCallback)},n.prototype.onImageReady=function(t){return this.on(o,t)},n.prototype.getListeners=function(){return this.queryDataModel.getTonicMouseListener()},n.prototype.destroy=function(){this.off(),this.dataSubscription.unsubscribe(),this.dataSubscription=null,this.queryDataModel=null},n.prototype.getControlWidgets=function(){return["QueryDataModelWidget"]},n.prototype.getQueryDataModel=function(){return this.queryDataModel},t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e){for(var r in o)if(i(t,r))return new o[r](e);return console.error("No compositor found for type",t),null}Object.defineProperty(e,"__esModule",{value:!0}),e.createCompositor=n;var i=r(63),o={rgbd:r(29),"sxyz-light":r(30),"raw-rgbd":r(28)}},function(t,e,r){"use strict";function n(t,e,r){var n=this;this.queryDataModel=t,this.pipelineModel=e,this.lookupTableManager=r,this.compositePipeline=t.originalData.CompositePipeline,this.query=null,this.compositor=o.createCompositor(t.originalData.type,{queryDataModel:t,lookupTableManager:r,imageBuilder:this}),this.controlWidgets=this.compositor.WIDGETS||["CompositeControl","QueryDataModelWidget"],this.setPipelineQuery(this.pipelineModel.getPipelineQuery()),this.pipelineSubscription=this.pipelineModel.onChange(function(t,e){n.setPipelineQuery(t)})}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(2),o=r(26),a="image-ready";i.mixInto(n),n.prototype.getDimensions=function(){return this.compositePipeline.dimensions},n.prototype.setPipelineQuery=function(t){this.query!==t&&(this.query=t,this.compositor.updateQuery(t),this.render())},n.prototype.update=function(){this.queryDataModel.fetchData()},n.prototype.render=function(){this.query&&this.compositor.render()},n.prototype.destroy=function(){this.pipelineSubscription.unsubscribe(),this.pipelineSubscription=null,this.compositor.destroy(),this.compositor=null},n.prototype.IMAGE_READY_TOPIC=a,n.prototype.onImageReady=function(t){return this.on(a,t)},n.prototype.getListeners=function(){return this.queryDataModel.getTonicMouseListener()},n.prototype.setLightProperties=function(t){this.compositor.setLightProperties(t)},n.prototype.getControlWidgets=function(){return this.controlWidgets},n.prototype.getQueryDataModel=function(){return this.queryDataModel},n.prototype.getPipelineModel=function(){return this.pipelineModel},n.prototype.getLookupTableManager=function(){return this.lookupTableManager},n.prototype.getField=function(){return this.lookupTableManager.getActiveField()},n.prototype.getLightProperties=function(){return this.compositor.getLightProperties()},n.prototype.getLightingEnabled=function(){return this.compositor.getLightingEnabled()},n.prototype.setLightingEnabled=function(t){return this.compositor.setLightingEnabled(t)},t.exports=e["default"]},function(t,e,r){"use strict";function n(t){var e=this,n=t.queryDataModel,s=t.imageBuilder;return this.queryDataModel=n,this.imageBuilder=s,this.rgbdData=null,this.offsetList=[],this.spriteSize=a(this.queryDataModel.originalData.CompositePipeline.offset),this.dataSubscription=n.onDataChange(function(t,r){e.rgbdData=t.rgbdSprite.data,e.render()}),this.width=this.queryDataModel.originalData.CompositePipeline.dimensions[0],this.height=this.queryDataModel.originalData.CompositePipeline.dimensions[1],this.glCanvas=new i(this.width,this.height),this.gl=this.glCanvas.get3DContext(),this.gl?(this.gl.clearColor(1,1,1,0),this.glConfig={programs:{displayProgram:{vertexShader:r(1),fragmentShader:r(7),mapping:"default"},compositeProgram:{vertexShader:r(1),fragmentShader:r(13),mapping:"default"}},resources:{buffers:[{id:"texCoord",data:new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])},{id:"posCoord",data:new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1])}],textures:[{id:"texture2D",pixelStore:[["UNPACK_FLIP_Y_WEBGL",!0]],texParameter:[["TEXTURE_MAG_FILTER","NEAREST"],["TEXTURE_MIN_FILTER","NEAREST"],["TEXTURE_WRAP_S","CLAMP_TO_EDGE"],["TEXTURE_WRAP_T","CLAMP_TO_EDGE"]]},{id:"ping",pixelStore:[["UNPACK_FLIP_Y_WEBGL",!0]],texParameter:[["TEXTURE_MAG_FILTER","NEAREST"],["TEXTURE_MIN_FILTER","NEAREST"],["TEXTURE_WRAP_S","CLAMP_TO_EDGE"],["TEXTURE_WRAP_T","CLAMP_TO_EDGE"]]},{id:"pong",pixelStore:[["UNPACK_FLIP_Y_WEBGL",!0]],texParameter:[["TEXTURE_MAG_FILTER","NEAREST"],["TEXTURE_MIN_FILTER","NEAREST"],["TEXTURE_WRAP_S","CLAMP_TO_EDGE"],["TEXTURE_WRAP_T","CLAMP_TO_EDGE"]]}],framebuffers:[{id:"ping",width:this.width,height:this.height},{id:"pong",width:this.width,height:this.height}]},mappings:{"default":[{id:"posCoord",name:"positionLocation",attribute:"a_position",format:[2,this.gl.FLOAT,!1,0,0]},{id:"texCoord",name:"texCoordLocation",attribute:"a_texCoord",format:[2,this.gl.FLOAT,!1,0,0]}]}},this.glResources=o.createGLResources(this.gl,this.glConfig),void(this.pingPong=new o.PingPong(this.gl,[this.glResources.framebuffers.ping,this.glResources.framebuffers.pong],[this.glResources.textures.ping,this.glResources.textures.pong]))):(console.error("Unable to get WebGl context"),null)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(3),o=r(4),a=r(5);n.prototype.extractLayerData=function(t,e){var r=0,n=e,i=4*(n*this.width+r),o=this.width*this.height*4;return new Uint8Array(t,i,o)},n.prototype.updateQuery=function(t){var e=this.queryDataModel.originalData.CompositePipeline.layers,r=e.length,n=this.queryDataModel.originalData.CompositePipeline.offset;this.offsetList=[];for(var i=0;r>i;i++){var o=t[2*i+1];"_"!==o&&this.offsetList.push(this.spriteSize-n[e[i]+o])}},n.prototype.render=function(){var t=this;if(!this.rgbdData)return null;this.pingPong.clearFbo(),this.offsetList.forEach(function(e){t.drawCompositePass(t.extractLayerData(t.rgbdData,e*t.height))}),this.drawDisplayPass();var e={canvas:this.glCanvas.el,area:[0,0,this.width,this.height],outputSize:[this.width,this.height],builder:this.imageBuilder};this.imageBuilder.emit(this.imageBuilder.IMAGE_READY_TOPIC,e)},n.prototype.destroy=function(){this.dataSubscription.unsubscribe(),this.dataSubscription=null,this.glResources.destroy(),this.glResources=null,this.pingPong=null},n.prototype.drawDisplayPass=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.useProgram(this.glResources.programs.displayProgram),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.viewport(0,0,this.width,this.height);var t=this.gl.getUniformLocation(this.glResources.programs.displayProgram,"u_image");this.gl.uniform1i(t,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture()),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish()},n.prototype.drawCompositePass=function(t){
this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pingPong.getFramebuffer()),this.gl.useProgram(this.glResources.programs.compositeProgram),this.gl.viewport(0,0,this.width,this.height);var e=this.gl.getUniformLocation(this.glResources.programs.compositeProgram,"layerSampler");this.gl.uniform1i(e,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.texture2D),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t);var r=this.gl.getUniformLocation(this.glResources.programs.compositeProgram,"compositeSampler");this.gl.uniform1i(r,1),this.gl.activeTexture(this.gl.TEXTURE0+1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture()),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish(),this.pingPong.swap()},t.exports=e["default"]},function(t,e,r){"use strict";function n(t){var e=this,n=t.queryDataModel,s=t.imageBuilder;return this.queryDataModel=n,this.imageBuilder=s,this.rgbdSprite=null,this.offsetList=[],this.spriteSize=a(this.queryDataModel.originalData.CompositePipeline.offset),this.removeLoadCallback=!1,this.closureRenderMethod=function(){e.render()},this.dataSubscription=n.onDataChange(function(t,r){e.rgbdSprite=t.rgbdSprite.image,e.rgbdSprite.complete?e.render():(e.removeLoadCallback=!0,e.rgbdSprite.addEventListener("load",e.closureRenderMethod))}),this.width=this.queryDataModel.originalData.CompositePipeline.dimensions[0],this.height=this.queryDataModel.originalData.CompositePipeline.dimensions[1],this.glCanvas=new i(this.width,this.height),this.compositeCanvas=new i(this.width,this.height),this.compositeCtx=this.compositeCanvas.get2DContext(),this.gl=this.glCanvas.get3DContext(),this.gl?(this.gl.clearColor(1,1,1,0),this.glConfig={programs:{displayProgram:{vertexShader:r(1),fragmentShader:r(7),mapping:"default"},compositeProgram:{vertexShader:r(1),fragmentShader:r(13),mapping:"default"}},resources:{buffers:[{id:"texCoord",data:new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])},{id:"posCoord",data:new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1])}],textures:[{id:"texture2D",pixelStore:[["UNPACK_FLIP_Y_WEBGL",!0]],texParameter:[["TEXTURE_MAG_FILTER","NEAREST"],["TEXTURE_MIN_FILTER","NEAREST"],["TEXTURE_WRAP_S","CLAMP_TO_EDGE"],["TEXTURE_WRAP_T","CLAMP_TO_EDGE"]]},{id:"ping",pixelStore:[["UNPACK_FLIP_Y_WEBGL",!0]],texParameter:[["TEXTURE_MAG_FILTER","NEAREST"],["TEXTURE_MIN_FILTER","NEAREST"],["TEXTURE_WRAP_S","CLAMP_TO_EDGE"],["TEXTURE_WRAP_T","CLAMP_TO_EDGE"]]},{id:"pong",pixelStore:[["UNPACK_FLIP_Y_WEBGL",!0]],texParameter:[["TEXTURE_MAG_FILTER","NEAREST"],["TEXTURE_MIN_FILTER","NEAREST"],["TEXTURE_WRAP_S","CLAMP_TO_EDGE"],["TEXTURE_WRAP_T","CLAMP_TO_EDGE"]]}],framebuffers:[{id:"ping",width:this.width,height:this.height},{id:"pong",width:this.width,height:this.height}]},mappings:{"default":[{id:"posCoord",name:"positionLocation",attribute:"a_position",format:[2,this.gl.FLOAT,!1,0,0]},{id:"texCoord",name:"texCoordLocation",attribute:"a_texCoord",format:[2,this.gl.FLOAT,!1,0,0]}]}},this.glResources=o.createGLResources(this.gl,this.glConfig),void(this.pingPong=new o.PingPong(this.gl,[this.glResources.framebuffers.ping,this.glResources.framebuffers.pong],[this.glResources.textures.ping,this.glResources.textures.pong]))):(console.error("Unable to get WebGl context"),null)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(3),o=r(4),a=r(5);n.prototype.updateQuery=function(t){var e=this.queryDataModel.originalData.CompositePipeline.layers,r=e.length,n=this.queryDataModel.originalData.CompositePipeline.offset;this.offsetList=[];for(var i=0;r>i;i++){var o=t[2*i+1];"_"!==o&&this.offsetList.push(this.spriteSize-n[e[i]+o])}},n.prototype.render=function(){var t=this;if(!this.rgbdSprite||!this.rgbdSprite.complete)return null;this.removeLoadCallback&&(this.rgbdSprite.removeEventListener("load",this.closureRenderMethod),this.removeLoadCallback=!1),this.pingPong.clearFbo(),this.offsetList.forEach(function(e){var r=e*t.height;t.compositeCtx.clearRect(0,0,t.width,t.height),t.compositeCtx.drawImage(t.rgbdSprite,0,r,t.width,t.height,0,0,t.width,t.height),t.drawCompositePass()}),this.drawDisplayPass();var e={canvas:this.glCanvas.el,area:[0,0,this.width,this.height],outputSize:[this.width,this.height],builder:this.imageBuilder};this.imageBuilder.emit(this.imageBuilder.IMAGE_READY_TOPIC,e)},n.prototype.destroy=function(){this.dataSubscription.unsubscribe(),this.dataSubscription=null,this.glResources.destroy(),this.glResources=null,this.pingPong=null},n.prototype.drawDisplayPass=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.useProgram(this.glResources.programs.displayProgram),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.viewport(0,0,this.width,this.height);var t=this.gl.getUniformLocation(this.glResources.programs.displayProgram,"u_image");this.gl.uniform1i(t,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture()),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish()},n.prototype.drawCompositePass=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pingPong.getFramebuffer()),this.gl.useProgram(this.glResources.programs.compositeProgram),this.gl.viewport(0,0,this.width,this.height);var t=this.gl.getUniformLocation(this.glResources.programs.compositeProgram,"layerSampler");this.gl.uniform1i(t,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.texture2D),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.compositeCanvas.el);var e=this.gl.getUniformLocation(this.glResources.programs.compositeProgram,"compositeSampler");this.gl.uniform1i(e,1),this.gl.activeTexture(this.gl.TEXTURE0+1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture()),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish(),this.pingPong.swap()},t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e){var r=parseFloat(t),n=parseFloat(e),i=(180-r)*Math.PI/180,o=(180-n)*Math.PI/180;return[Math.sin(o)*Math.cos(i),Math.sin(o)*Math.sin(i),Math.cos(o)]}function i(t,e){var r=n(t.getValue("phi"),t.getValue("theta")),i=u.fromValues(r[0],r[1],r[2]),o=u.fromValues(0,0,0),a=u.fromValues(0,0,1),s=u.create();u.add(s,a,i),u.normalize(s,s);var l=u.create();u.subtract(l,o,i);var c=u.create();u.subtract(c,s,i);var h=u.create();u.cross(h,l,c),u.normalize(h,h),u.subtract(l,h,i),u.subtract(c,o,i);var f=u.create();u.cross(f,l,c),u.normalize(f,f);var g=u.create();u.scale(g,h,e.x);var p=u.create();u.scale(p,f,e.y);var d=u.create();u.scale(d,i,.3);var v=u.create();return u.add(v,d,g),u.add(v,v,p),u.normalize(v,v),{lightDir:v,viewDir:i}}function o(t){var e=this,n=t.queryDataModel,i=t.imageBuilder,o=t.lookupTableManager;this.queryDataModel=n,this.compositePipeline=this.queryDataModel.originalData.CompositePipeline,this.width=this.compositePipeline.dimensions[0],this.height=this.compositePipeline.dimensions[1],this.spriteSize=s(this.compositePipeline.offset),this.offsetList=[],this.sxyzSprite=null,this.removeLoadCallback=!1,this.closureRenderMethod=function(){e.render()},this.doLighting=!0,this.dataSubscription=n.onDataChange(function(t,r){e.sxyzSprite=t.sxyzSprite.image,e.sxyzSprite.complete?e.render():(e.removeLoadCallback=!0,e.sxyzSprite.addEventListener("load",e.closureRenderMethod))}),this.imageBuilder=i,this.lookupTableManager=o,this.lookupTableManager.addFields(this.compositePipeline.ranges,this.queryDataModel.originalData.LookupTables),this.numLutSamples=1024,this.lutMap={};for(var u in this.compositePipeline.ranges)this.lutMap[u]=new Uint8Array(4*this.numLutSamples),this.resampleLookupTable(u);return this.lookupTableManager.onChange(function(t,r){"__internal"!==t.lut.name&&e.resampleLookupTable(t.lut.name)}),this.bgColor=[1,1,1],this.lightingTextureNames=["nx","ny","nz","scalars"],this.lightingTextures={},this.lightProperties={lightTerms:{ka:.1,kd:.6,ks:.3,alpha:20},lightPosition:{x:-1,y:1},lightColor:[.8,.8,.8]},this.glCanvas=new a(this.width,this.height),this.compositeCanvas=new a(this.width,this.height),this.compositeCtx=this.compositeCanvas.get2DContext(),this.scalarCanvas=new a(this.width,this.height),this.scalarCtx=this.scalarCanvas.get2DContext(),this.nxCanvas=new a(this.width,this.height),this.nxCtx=this.nxCanvas.get2DContext(),this.nyCanvas=new a(this.width,this.height),this.nyCtx=this.nyCanvas.get2DContext(),this.nzCanvas=new a(this.width,this.height),this.nzCtx=this.nzCanvas.get2DContext(),this.gl=this.glCanvas.get3DContext(),this.gl?(this.gl.clearColor(1,1,1,0),this.glConfig={programs:{displayProgram:{vertexShader:r(1),fragmentShader:r(7),mapping:"default"},compositeLightProgram:{vertexShader:r(1),fragmentShader:r(44),mapping:"default"},compositeLutProgram:{vertexShader:r(1),fragmentShader:r(45),mapping:"default"},backgroundProgram:{vertexShader:r(1),fragmentShader:r(43),mapping:"default"}},resources:{buffers:[{id:"texCoord",data:new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])},{id:"posCoord",data:new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1])}],textures:[{id:"scalars",pixelStore:g,texParameter:f},{id:"nx",pixelStore:g,texParameter:f},{id:"ny",pixelStore:g,texParameter:f},{id:"nz",pixelStore:g,texParameter:f},{id:"lutTexture",pixelStore:g,texParameter:f},{id:"ping",pixelStore:g,texParameter:f},{id:"pong",pixelStore:g,texParameter:f}],framebuffers:[{id:"ping",width:this.width,height:this.height},{id:"pong",width:this.width,height:this.height}]},mappings:{"default":[{id:"posCoord",name:"positionLocation",attribute:"a_position",format:[2,this.gl.FLOAT,!1,0,0]},{id:"texCoord",name:"texCoordLocation",attribute:"a_texCoord",format:[2,this.gl.FLOAT,!1,0,0]}]}},this.glResources=c.createGLResources(this.gl,this.glConfig),void(this.pingPong=new c.PingPong(this.gl,[this.glResources.framebuffers.ping,this.glResources.framebuffers.pong],[this.glResources.textures.ping,this.glResources.textures.pong]))):(console.error("Unable to get WebGl context"),null)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o;var a=r(3),s=r(5),u=r(49),l=r(50),c=r(4),h=r(70),f=[["TEXTURE_MAG_FILTER","NEAREST"],["TEXTURE_MIN_FILTER","NEAREST"],["TEXTURE_WRAP_S","CLAMP_TO_EDGE"],["TEXTURE_WRAP_T","CLAMP_TO_EDGE"]],g=[["UNPACK_FLIP_Y_WEBGL",!0]];o.prototype.WIDGETS=["LookupTableManagerWidget","LightPropertiesWidget","CompositeControl","QueryDataModelWidget"],o.prototype.getLightingEnabled=function(){return this.doLighting},o.prototype.setLightingEnabled=function(t){this.doLighting=t,this.render()},o.prototype.getLightProperties=function(){return this.lightProperties},o.prototype.setLightProperties=function(t){this.lightProperties=h(this.lightProperties,t),this.render()},o.prototype.resampleLookupTable=function(t){for(var e=this.lookupTableManager.getLookupTable(t),r=this.compositePipeline.ranges[t],n=(r[1]-r[0])/this.numLutSamples,i=this.lutMap[t],o=0;o<this.numLutSamples;++o){var a=r[0]+o*n,s=4*o,u=e.getColor(a);i[s]=Math.round(255*u[0]),i[s+1]=Math.round(255*u[1]),i[s+2]=Math.round(255*u[2]),i[s+3]=1}this.render()},o.prototype.updateQuery=function(t){var e=this.compositePipeline.layers,r=e.length,n=this.compositePipeline.offset,i=this.compositePipeline.color_by_dependencies;this.offsetList=[];for(var o=0;r>o;o++){var a=t[2*o+1];if("_"!==a&&i[a]){var s=i[a];if(s.normal){var u=s.normal[0],l=s.normal[1],c=s.normal[2];this.offsetList.push({fieldName:this.compositePipeline.fields[a],scalar:this.spriteSize-n[e[o]+a],nx:this.spriteSize-n[e[o]+u],ny:this.spriteSize-n[e[o]+l],nz:this.spriteSize-n[e[o]+c]})}}}},o.prototype.render=function(){if(!this.sxyzSprite||!this.sxyzSprite.complete)return void console.log("Not enough data to render");this.removeLoadCallback&&(this.sxyzSprite.removeEventListener("load",this.closureRenderMethod),this.removeLoadCallback=!1),this.pingPong.clearFbo();var t=i(this.queryDataModel,this.lightProperties.lightPosition),e=t.lightDir,r=t.viewDir,n=0,o=0,a=this.width,s=this.height;this.compositeCtx.clearRect(0,0,a,s),this.compositeCtx.drawImage(this.sxyzSprite,0,this.spriteSize*s,a,s,0,0,a,s),this.drawBackgroundPass(this.bgColor);for(var u=0,l=this.offsetList.length;l>u;u+=1){var c=this.offsetList[u],h=c.fieldName;o=0,this.doLighting?(o=c.nx*s,this.nxCtx.clearRect(0,0,a,s),this.nxCtx.drawImage(this.sxyzSprite,n,o,a,s,0,0,a,s),o=c.ny*s,this.nyCtx.clearRect(0,0,a,s),this.nyCtx.drawImage(this.sxyzSprite,n,o,a,s,0,0,a,s),o=c.nz*s,this.nzCtx.clearRect(0,0,a,s),this.nzCtx.drawImage(this.sxyzSprite,n,o,a,s,0,0,a,s),o=c.scalar*s,this.scalarCtx.clearRect(0,0,a,s),this.scalarCtx.drawImage(this.sxyzSprite,n,o,a,s,0,0,a,s),this.drawLitCompositePass(r,e,this.lightProperties,this.lutMap[h])):(o=c.scalar*s,this.scalarCtx.clearRect(0,0,a,s),this.scalarCtx.drawImage(this.sxyzSprite,n,o,a,s,0,0,a,s),this.drawLutCompositePass(this.lutMap[h]))}this.drawDisplayPass();var f={canvas:this.glCanvas.el,area:[0,0,this.width,this.height],outputSize:[this.width,this.height],builder:this.imageBuilder};this.imageBuilder.emit(this.imageBuilder.IMAGE_READY_TOPIC,f)},o.prototype.destroy=function(){this.dataSubscription.unsubscribe(),this.dataSubscription=null,this.glResources.destroy(),this.glResources=null,this.pingPong=null},o.prototype.drawDisplayPass=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.useProgram(this.glResources.programs.displayProgram),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.viewport(0,0,this.width,this.height);var t=this.gl.getUniformLocation(this.glResources.programs.displayProgram,"u_image");this.gl.uniform1i(t,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture()),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},o.prototype.drawBackgroundPass=function(t){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pingPong.getFramebuffer()),this.gl.useProgram(this.glResources.programs.backgroundProgram),this.gl.viewport(0,0,this.width,this.height);var e=l.fromValues(t[0],t[1],t[2],1),r=this.gl.getUniformLocation(this.glResources.programs.backgroundProgram,"backgroundColor");this.gl.uniform4fv(r,e);var n=this.gl.getUniformLocation(this.glResources.programs.backgroundProgram,"backgroundSampler");this.gl.uniform1i(n,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture()),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.compositeCanvas.el),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish(),this.pingPong.swap(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},o.prototype.drawLitCompositePass=function(t,e,r,n){var i=r.lightTerms,o=r.lightColor;this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pingPong.getFramebuffer()),this.gl.useProgram(this.glResources.programs.compositeLightProgram),this.gl.viewport(0,0,this.width,this.height);var a=l.fromValues(t[0],t[1],t[2],0),s=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"viewDir");this.gl.uniform4fv(s,a);var u=l.fromValues(e[0],e[1],e[2],0),c=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"lightDir");this.gl.uniform4fv(c,u);var h=l.fromValues(i.ka,i.kd,i.ks,i.alpha),f=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"lightTerms");this.gl.uniform4fv(f,h);var g=l.fromValues(o[0],o[1],o[2],1),p=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"lightColor");this.gl.uniform4fv(p,g);var d=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"scalarSampler");this.gl.uniform1i(d,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.scalars),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.scalarCanvas.el);var v=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"nxSampler");this.gl.uniform1i(v,1),this.gl.activeTexture(this.gl.TEXTURE0+1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.nx),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.nxCanvas.el);var m=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"nySampler");this.gl.uniform1i(m,2),this.gl.activeTexture(this.gl.TEXTURE0+2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.ny),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.nyCanvas.el);var b=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"nzSampler");this.gl.uniform1i(b,3),this.gl.activeTexture(this.gl.TEXTURE0+3),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.nz),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.nzCanvas.el);var y=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"compositeSampler");this.gl.uniform1i(y,4),this.gl.activeTexture(this.gl.TEXTURE0+4),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture());var _=this.gl.getUniformLocation(this.glResources.programs.compositeLightProgram,"lutSampler");this.gl.uniform1i(_,5),this.gl.activeTexture(this.gl.TEXTURE0+5),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.lutTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.numLutSamples,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish(),this.pingPong.swap();for(var x=0;6>x;x+=1)this.gl.activeTexture(this.gl.TEXTURE0+x),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},o.prototype.drawLutCompositePass=function(t){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pingPong.getFramebuffer()),this.gl.useProgram(this.glResources.programs.compositeLutProgram),this.gl.viewport(0,0,this.width,this.height);var e=this.gl.getUniformLocation(this.glResources.programs.compositeLutProgram,"scalarSampler");this.gl.uniform1i(e,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.scalars),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.scalarCanvas.el);var r=this.gl.getUniformLocation(this.glResources.programs.compositeLutProgram,"compositeSampler");this.gl.uniform1i(r,1),this.gl.activeTexture(this.gl.TEXTURE0+1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture());var n=this.gl.getUniformLocation(this.glResources.programs.compositeLutProgram,"lutSampler");this.gl.uniform1i(n,2),this.gl.activeTexture(this.gl.TEXTURE0+2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.lutTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.numLutSamples,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish(),this.pingPong.swap();for(var i=0;3>i;i+=1)this.gl.activeTexture(this.gl.TEXTURE0+i),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e){var r=this;this.queryDataModel=t,this.metadata=t.originalData.SortedComposite,this.opacities=[],this.colors=[],this.eqCallback=null,this.useIntensity=!1,this.lookupTableManager=e,this.originalRange=[this.metadata.scalars[0],this.metadata.scalars[this.metadata.scalars.length-1]],this.lutTextureData=new Uint8Array(4*this.metadata.layers),this.dataQuery={name:"data_fetch",categories:[]},this.compositors=[new a(t,this,this.lutTextureData),new o(t,this,this.lutTextureData)],this.compositor=this.compositors[1],this.controlWidgets=["VolumeControlWidget","QueryDataModelWidget"],this.resetOpacities(),e.addFields({VolumeScalar:[0,1]},this.queryDataModel.originalData.LookupTables),this.lookupTable=e.getLookupTable(l),this.lutChangeSubscription=this.lookupTable.onChange(function(t,e){r.colors=[];for(var n=0;n<r.metadata.layers;n++){var i=r.lookupTable.getColor(r.metadata.scalars[n]);r.lutTextureData[4*n]=255*i[0],r.lutTextureData[4*n+1]=255*i[1],r.lutTextureData[4*n+2]=255*i[2],r.colors.push("rgb("+[r.lutTextureData[4*n],r.lutTextureData[4*n+1],r.lutTextureData[4*n+2]].join(",")+")")}r.emit(u),r.render()}),this.lookupTable.setScalarRange(this.originalRange[0],this.originalRange[1]),this.relayDataFetchSubscription=this.queryDataModel.onDataChange(function(){r.update()}),this.dataSubscription=t.on("data_fetch",function(t,e){r.compositor.updateData(t),r.render()})}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(2),o=r(33),a=r(32),s="image-ready",u="color-change",l="VolumeScalar";i.mixInto(n),n.prototype.getDimensions=function(){return this.metadata.dimensions},n.prototype.update=function(){this.useIntensity?this.dataQuery.categories=["_","intensity"]:this.dataQuery.categories=["_"],this.queryDataModel.fetchData(this.dataQuery)},n.prototype.updateOpacities=function(t){this.opacities=[].concat(t);for(var e=0;e<this.metadata.layers;e++)this.lutTextureData[4*e+3]=255*t[e];this.render()},n.prototype.render=function(){this.compositor.render()},n.prototype.destroy=function(){this.dataSubscription.unsubscribe(),this.dataSubscription=null,this.compositors.forEach(function(t){t.destroy()}),this.compositors=[],this.compositor=null,this.lutChangeSubscription.unsubscribe(),this.lutChangeSubscription=null,this.relayDataFetchSubscription.unsubscribe(),this.relayDataFetchSubscription=null},n.prototype.IMAGE_READY_TOPIC=s,n.prototype.onImageReady=function(t){return this.on(s,t)},n.prototype.onColorChange=function(t){return this.on(u,t)},n.prototype.getListeners=function(){return this.queryDataModel.getTonicMouseListener()},n.prototype.getControlWidgets=function(){return this.controlWidgets},n.prototype.getQueryDataModel=function(){return this.queryDataModel},n.prototype.getEqualizerLevels=function(){return this.opacities},n.prototype.getEqualizerCallback=function(){var t=this;return this.eqCallback||(this.eqCallback=function(e){t.updateOpacities(e)}),this.eqCallback},n.prototype.resetOpacities=function(){var t=1/this.metadata.layers,e=0;for(this.opacities=[];this.opacities.length<this.metadata.layers;)e+=t,this.opacities.push(e);this.updateOpacities(this.opacities)},n.prototype.getOriginalRange=function(){return this.originalRange},n.prototype.getLookupTableManager=function(){return this.lookupTableManager},n.prototype.getLookupTable=function(){return this.lookupTable},n.prototype.isIntensityUsed=function(){return this.useIntensity},n.prototype.toggleIntensityUsage=function(){this.useIntensity=!this.useIntensity},n.prototype.setIntensityUsage=function(t){this.useIntensity=t},n.prototype.useGPU=function(t){this.compositor=this.compositors[t?1:0]},n.prototype.getColors=function(){return this.colors},t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e,r){this.queryDataModel=t,this.imageBuilder=e,this.metadata=this.queryDataModel.originalData.SortedComposite,this.orderData=null,this.alphaData=null,this.intensityData=null,this.numLayers=this.metadata.layers,this.colorTable=r,this.width=this.metadata.dimensions[0],this.height=this.metadata.dimensions[1],this.bgCanvas=new i(this.width,this.height),this.imageBuffer=this.bgCanvas.get2DContext().createImageData(this.width,this.height)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(3);n.prototype.updateData=function(t){this.orderData=new Uint8Array(t.order.data),this.alphaData=new Uint8Array(t.alpha.data),t.intensity?this.intensityData=new Uint8Array(t.intensity.data):this.intensityData=null},n.prototype.setLayerColors=function(t){this.colorTable=t},n.prototype.render=function(){if(!this.alphaData||!this.orderData||!this.colorTable)return null;var t=this.width*this.height,e=this.imageBuffer.data,r=this.height,n=this.width,i=this.bgCanvas.get2DContext();if(e.fill)e.fill(0);else for(var o=n*r*4;o--;)e[o]=0;for(var a=0;a<this.numLayers;a++)for(var s=0;s<this.height;s++)for(var u=0;u<this.width;u++){var l=this.width*s+u,c=(r-s-1)*n+u,h=this.orderData[a*t+l],f=this.colorTable[4*h+3]/255,g=this.alphaData[a*t+l]/255,p=1;this.intensityData&&(p=this.intensityData[a*t+l]/255);var d=e[4*c+3]/255,v=1-d,m=[e[4*c],e[4*c+1],e[4*c+2]],b=[this.colorTable[4*h]*p*g*f*v,this.colorTable[4*h+1]*p*g*f*v,this.colorTable[4*h+2]*p*g*f*v],y=d+g*f*(1-d);e[4*c]=(m[0]*d+b[0])/y,e[4*c+1]=(m[1]*d+b[1])/y,e[4*c+2]=(m[2]*d+b[2])/y,e[4*c+3]=255*y}i.putImageData(this.imageBuffer,0,0);var _={canvas:this.bgCanvas.el,area:[0,0,this.width,this.height],outputSize:[this.width,this.height],builder:this.imageBuilder};this.imageBuilder.emit(this.imageBuilder.IMAGE_READY_TOPIC,_)},n.prototype.destroy=function(){this.bgCanvas.destroy(),this.bgCanvas=null,this.queryDataModel=null,this.imageBuilder=null},t.exports=e["default"]},function(t,e,r){"use strict";function n(t,e,n){return this.queryDataModel=t,this.imageBuilder=e,this.infoJson=this.queryDataModel.originalData,this.orderData=null,this.alphaData=null,this.intensityData=null,this.intensitySize=1,this.defaultIntensityData=new Uint8Array([255]),this.numLayers=this.infoJson.SortedComposite.layers,this.lutView=n,this.width=this.infoJson.SortedComposite.dimensions[0],this.height=this.infoJson.SortedComposite.dimensions[1],this.glCanvas=new i(this.width,this.height),this.gl=this.glCanvas.get3DContext(),this.gl?(this.gl.clearColor(1,1,1,0),this.glConfig={programs:{displayProgram:{vertexShader:r(1),fragmentShader:r(47),mapping:"default"},colorProgram:{vertexShader:r(1),fragmentShader:r(48),mapping:"default"},blendProgram:{vertexShader:r(1),fragmentShader:r(46),mapping:"default"}},resources:{buffers:[{id:"texCoord",data:new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])},{id:"posCoord",data:new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1])}],textures:[{id:"orderTexture",pixelStore:u,texParameter:a},{id:"alphaTexture",pixelStore:u,texParameter:a},{id:"intensityTexture",pixelStore:u,texParameter:a},{id:"lutTexture",pixelStore:s,texParameter:a},{id:"ping",pixelStore:s,texParameter:a},{id:"pong",pixelStore:s,texParameter:a},{id:"colorRenderTexture",pixelStore:s,texParameter:a}],framebuffers:[{id:"ping",width:this.width,height:this.height},{id:"pong",width:this.width,height:this.height},{id:"colorFbo",width:this.width,height:this.height}]},mappings:{"default":[{id:"posCoord",name:"positionLocation",attribute:"a_position",format:[2,this.gl.FLOAT,!1,0,0]},{id:"texCoord",name:"texCoordLocation",attribute:"a_texCoord",format:[2,this.gl.FLOAT,!1,0,0]}]}},this.glResources=o.createGLResources(this.gl,this.glConfig),o.bindTextureToFramebuffer(this.gl,this.glResources.framebuffers.colorFbo,this.glResources.textures.colorRenderTexture),void(this.pingPong=new o.PingPong(this.gl,[this.glResources.framebuffers.ping,this.glResources.framebuffers.pong],[this.glResources.textures.ping,this.glResources.textures.pong]))):(console.error("Unable to get WebGl context"),null)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var i=r(3),o=r(4),a=[["TEXTURE_MAG_FILTER","NEAREST"],["TEXTURE_MIN_FILTER","NEAREST"],["TEXTURE_WRAP_S","CLAMP_TO_EDGE"],["TEXTURE_WRAP_T","CLAMP_TO_EDGE"]],s=[["UNPACK_FLIP_Y_WEBGL",!0]],u=[["UNPACK_FLIP_Y_WEBGL",!0],["UNPACK_ALIGNMENT",1]];n.prototype.updateData=function(t){this.orderData=t.order.data,this.alphaData=t.alpha.data,t.intensity?(this.intensityData=t.intensity.data,this.intensitySize=[this.width,this.height]):(this.intensityData=this.defaultIntensityData,this.intensitySize=[1,1])},n.prototype.extractLayerData=function(t,e){var r=e*this.width*this.height,n=this.width*this.height;return new Uint8Array(t,r,n)},n.prototype.render=function(){if(!this.alphaData||!this.orderData||!this.lutView)return null;this.pingPong.clearFbo();for(var t=this.numLayers;t--;)this.drawColorPass(this.extractLayerData(this.orderData,t),this.extractLayerData(this.alphaData,t),this.extractLayerData(this.intensityData,t)),this.drawBlendPass();this.drawDisplayPass();var e={canvas:this.glCanvas.el,area:[0,0,this.width,this.height],outputSize:[this.width,this.height],builder:this.imageBuilder};this.imageBuilder.emit(this.imageBuilder.IMAGE_READY_TOPIC,e)},n.prototype.destroy=function(){this.glResources.destroy(),this.glResources=null,this.pingPong=null},n.prototype.drawDisplayPass=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.useProgram(this.glResources.programs.displayProgram),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.viewport(0,0,this.width,this.height);var t=this.gl.getUniformLocation(this.glResources.programs.displayProgram,"u_image");this.gl.uniform1i(t,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture()),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},n.prototype.drawBlendPass=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.pingPong.getFramebuffer()),this.gl.useProgram(this.glResources.programs.blendProgram),this.gl.viewport(0,0,this.width,this.height);var t=this.gl.getUniformLocation(this.glResources.programs.blendProgram,"underLayerSampler");this.gl.uniform1i(t,0),this.gl.activeTexture(this.gl.TEXTURE0+0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.pingPong.getRenderingTexture());var e=this.gl.getUniformLocation(this.glResources.programs.blendProgram,"overLayerSampler");this.gl.uniform1i(e,1),this.gl.activeTexture(this.gl.TEXTURE0+1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.colorRenderTexture),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish(),this.pingPong.swap();for(var r=0;2>r;r+=1)this.gl.activeTexture(this.gl.TEXTURE0+r),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},n.prototype.drawColorPass=function(t,e,r){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.glResources.framebuffers.colorFbo),this.gl.useProgram(this.glResources.programs.colorProgram),this.gl.viewport(0,0,this.width,this.height);var n=this.gl.getUniformLocation(this.glResources.programs.colorProgram,"numberOfLayers");this.gl.uniform1f(n,this.numLayers);var i=0,o=this.gl.getUniformLocation(this.glResources.programs.colorProgram,"orderSampler");this.gl.uniform1i(o,i),this.gl.activeTexture(this.gl.TEXTURE0+i),i+=1,this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.orderTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,this.width,this.height,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,t);var a=this.gl.getUniformLocation(this.glResources.programs.colorProgram,"alphaSampler");this.gl.uniform1i(a,i),this.gl.activeTexture(this.gl.TEXTURE0+i),i+=1,this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.alphaTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,this.width,this.height,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,e);var s=this.gl.getUniformLocation(this.glResources.programs.colorProgram,"intensitySampler");this.gl.uniform1i(s,i),this.gl.activeTexture(this.gl.TEXTURE0+i),i+=1,this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.intensityTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,this.intensitySize[0],this.intensitySize[1],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,r);var u=this.gl.getUniformLocation(this.glResources.programs.colorProgram,"lutSampler");this.gl.uniform1i(u,i),this.gl.activeTexture(this.gl.TEXTURE0+i),i+=1,this.gl.bindTexture(this.gl.TEXTURE_2D,this.glResources.textures.lutTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.numLayers,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.lutView),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.finish();for(var l=0;i>l;l+=1)this.gl.activeTexture(this.gl.TEXTURE0+l),this.gl.bindTexture(this.gl.TEXTURE_2D,null)},t.exports=e["default"]},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(21),i=r(22),o=r(23),a=r(24),s=r(25),u=r(27),l=r(31);e.Composite=n,e.DataProber=i,e.MagicLens=o,e.PixelOperator=a,e.QueryDataModel=s,
e.WebGlComposite=u,e.WebGLSortedComposite=l},function(t,e,r){(function(n){"use strict";function i(){var t=this;this.luts={},this.lutSubscriptions={},this.onChangeCallback=function(e,r){t.emit(s,e)}}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=i;var o=r(11),a=(r(8),r(2)),s="LookupTable.change",u="LookupTable.active.change",l="LookupTable.list.change";a.mixInto(i),i.prototype.addLookupTable=function(t,e,r){this.activeField||(this.activeField=t);var n=this.luts[t];return void 0===n&&(n=new o(t),this.luts[t]=n,this.lutSubscriptions[t]=n.onChange(this.onChangeCallback)),n.setPreset(r||"spectralflip"),n.setScalarRange(e[0],e[1]),this.emit(l,this),n},i.prototype.removeLookupTable=function(t){this.luts.hasOwn(t)&&(this.lutSubscriptions[t].unsubscribe(),this.luts[t].destroy(),delete this.luts[t],delete this.lutSubscriptions[t],this.emit(l,this))},i.prototype.updateActiveLookupTable=function(t){var e=this;n(function(){e.emit(u,t)}),this.activeField=t},i.prototype.getLookupTable=function(t){return this.luts[t]},i.prototype.addFields=function(t,e){for(var r in t){var n=this.addLookupTable(r,t[r]);e&&e[r]&&(void 0!==e[r].discrete&&(n.discrete=e[r].discrete),e[r].preset?n.setPreset(e[r].preset):e[r].controlpoints&&n.updateControlPoints(e[r].controlpoints))}},i.prototype.getActiveField=function(){return this.activeField},i.prototype.onChange=function(t){return this.on(s,t)},i.prototype.onFieldsChange=function(t){return this.on(l,t)},i.prototype.onActiveLookupTableChange=function(t){return this.on(u,t)},t.exports=e["default"]}).call(e,r(6).setImmediate)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(11),i=r(35),o=r(12);e.LookupTable=n,e.LookupTableManager=i,e.Presets=o},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(2),a="pipeline.change",s="opacity.change",u="ABCDEFGHIJKLMNOPQRSTUVWXYZ",l=function(){function t(e){function r(t){if(!a||t.length>1)return!0;var e=u.indexOf(t[0]);return"_"!==a[2*e+1]}var i=this,o=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];n(this,t),this.originalData=e,this.visibilityState={},this.activeState={},this.editMode={},this.activeColors={},this.noTrigger=!0,this.handleOpacity=o,this.opacityMap={},this.nbLayers=0;var a=e.CompositePipeline.default_pipeline;e.CompositePipeline.pipeline.forEach(function(t){i.setLayerVisible(t.ids.join(""),!0)}),e.CompositePipeline.layers.forEach(function(t){i.activeState[t]=r(t),i.activeColors[t]=e.CompositePipeline.layer_fields[t][0],i.opacityMap[t]=100,i.nbLayers++}),this.noTrigger=!1,this.triggerChange()}return i(t,[{key:"onChange",value:function(t){return this.on(a,t)}},{key:"onOpacityChange",value:function(t){return this.on(s,t)}},{key:"TopicChange",value:function(){return a}},{key:"triggerChange",value:function(){if(!this.noTrigger){var t=this.getPipelineQuery();this.emit(a,t)}}},{key:"isLayerActive",value:function(t){return this.activeState[t]}},{key:"setLayerActive",value:function(t,e){this.activeState[t]!==e&&(this.activeState[t]=e,this.triggerChange())}},{key:"toggleLayerActive",value:function(t){this.activeState[t]=!this.activeState[t],this.triggerChange()}},{key:"isLayerVisible",value:function(t){return this.visibilityState[t]}},{key:"setLayerVisible",value:function(t,e){if(this.visibilityState[t]!==e){this.visibilityState[t]=e;for(var r=t.length;r--;)this.visibilityState[t[r]]=e;this.triggerChange()}}},{key:"toggleLayerVisible",value:function(t){this.setLayerVisible(t,!this.visibilityState[t])}},{key:"toggleEditMode",value:function(t){this.editMode[t]=!this.editMode[t],this.triggerChange()}},{key:"isLayerInEditMode",value:function(t){for(var e in this.editMode)if(this.editMode[e]&&-1!==e.indexOf(t))return!0;return!1}},{key:"getColor",value:function(t){return this.originalData.CompositePipeline.layer_fields[t[0]]}},{key:"getColorToLabel",value:function(t){return this.originalData.CompositePipeline.fields[t]}},{key:"isActiveColor",value:function(t,e){return this.activeColors[t[0]]===e}},{key:"setActiveColor",value:function(t,e){for(var r=t.length;r--;)this.activeColors[t[r]]=e;this.triggerChange()}},{key:"getPipelineQuery",value:function(){var t=this,e="";return this.originalData.CompositePipeline.layers.forEach(function(r){var n=t.isLayerActive(r)&&t.isLayerVisible(r)?t.activeColors[r]:"_";e+=r,e+=n}),e}},{key:"getPipelineDescription",value:function(){return this.originalData.CompositePipeline.pipeline}},{key:"getOpacity",value:function(t){return this.opacityMap[t]}},{key:"hasOpacity",value:function(){return this.handleOpacity}},{key:"setOpacity",value:function(t,e){if(this.opacityMap[t]!==e){this.opacityMap[t]=e;for(var r=[],n=0;n<this.nbLayers;++n)r.push(this.opacityMap[u[n]]/100);this.emit(s,r)}}}]),t}();e["default"]=l,o.mixInto(l),t.exports=e["default"]},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(36),i=r(37);e.LookupTable=n,e.PipelineState=i},function(t,e,r){"use strict";function n(t){var e=arguments.length<=1||void 0===arguments[1]?"#0000FF":arguments[1],r=arguments.length<=2||void 0===arguments[2]?["#e1002a","#417dc0","#1d9a57","#e9bc2f","#9b3880"]:arguments[2];this.data=null,this.colors=r,this.markerColor=e,this.markerLocation=-1,this.showMarker=!0,this.title=t}function i(t,e,r,n){function i(t){var e=h[t];return e=e>o?a>e?e:a:o,u+c-Math.floor((e-o)*v)}for(var o=Number.MAX_VALUE,a=Number.MIN_VALUE,s=e.x,u=e.y,l=e.width,c=e.height,h=r.data,f=h.length,g=f,p=new Uint16Array(g);g--;){var d=h[g];o=Math.min(o,d),a=Math.max(a,d),p[g]=s+Math.floor(l*(g/(f-1)))}n&&(o=n[0],a=n[1]);var v=c/(a-o);t.beginPath(),t.lineWidth=1,t.strokeStyle=r.color,t.moveTo(p[0],i(0));for(var m=1;f>m;m++)isNaN(h[m])?f>m+1&&!isNaN(h[m+1])&&t.moveTo(p[m+1],i(m+1)):t.lineTo(p[m],i(m));t.stroke()}function o(t,e,r,n){if(!(0>r||r>1)){var i=e.y,o=i+e.height,a=e.x+Math.floor(r*e.width);t.beginPath(),t.lineWidth=1,t.strokeStyle=n,t.moveTo(a,i),t.lineTo(a,o),t.stroke()}}function a(t,e,r,n,i){var o=arguments.length<=5||void 0===arguments[5]?"#000000":arguments[5];t.fillStyle=o,t.font="20px serif",t.textBaseline="top",t.fillText(i,e.x+r,e.y+n)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var s=r(2),u="painter-ready";s.mixInto(n),n.prototype.updateData=function(t){var e=this;this.data=t;var r=0;t.fields.forEach(function(t){t.color||(t.color=e.colors[r++%e.colors.length])}),this.emit(u,this)},n.prototype.setTitle=function(t){this.title=t,this.emit(u,this)},n.prototype.setMarkerLocation=function(t){this.markerLocation=t,this.emit(u,this)},n.prototype.enableMarker=function(t){this.showMarker!==t&&(this.showMarker=t,this.emit(u,this))},n.prototype.isReady=function(){return null!==this.data},n.prototype.paint=function(t,e){if(this.data&&(t.clearRect(e.x-1,e.y-1,e.width+2,e.height+2),this.data.fields.forEach(function(r){i(t,e,r,r.range)}),this.showMarker&&o(t,e,this.markerLocation,this.markerColor),this.title)){var r="?";this.data.xRange&&2===this.data.xRange.length&&!isNaN(this.markerLocation)&&(r=(this.data.xRange[1]-this.data.xRange[0])*this.markerLocation+this.data.xRange[0],r.toFixed&&(r=r.toFixed(5))),a(t,e,10,10,this.title.replace(/{x}/g,""+r))}},n.prototype.onPainterReady=function(t){return this.on(u,t)},n.prototype.getControlWidgets=function(){return[]},t.exports=e["default"]},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(39);e.LineChart=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(3),i=r(4);e.CanvasOffscreenBuffer=n,e.WebGl=i},function(t,e){function r(){l=!1,a.length?u=a.concat(u):c=-1,u.length&&n()}function n(){if(!l){var t=setTimeout(r);l=!0;for(var e=u.length;e;){for(a=u,u=[];++c<e;)a&&a[c].run();c=-1,e=u.length}a=null,l=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function o(){}var a,s=t.exports={},u=[],l=!1,c=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new i(t,e)),1!==u.length||l||setTimeout(n,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=o,s.addListener=o,s.once=o,s.off=o,s.removeListener=o,s.removeAllListeners=o,s.emit=o,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e){t.exports="\nprecision mediump float;\n\nuniform sampler2D backgroundSampler;\n\nuniform vec4 backgroundColor;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n    vec4 color = texture2D(backgroundSampler, v_texCoord);\n    gl_FragColor = vec4(backgroundColor.rgb, color.a);\n}\n"},function(t,e){t.exports="\nprecision mediump float;\n\nuniform sampler2D compositeSampler;\nuniform sampler2D nxSampler;\nuniform sampler2D nySampler;\nuniform sampler2D nzSampler;\nuniform sampler2D scalarSampler;\nuniform sampler2D lutSampler;\n\nuniform vec4 viewDir;\nuniform vec4 lightDir;\nuniform vec4 lightColor;\nuniform vec4 lightTerms;\n\nvarying vec2 v_texCoord;\n\n\nfloat convert(vec4 c) {\n    float r = c.r * 255.0;\n    float g = c.g * 255.0;\n    float b = c.b * 255.0;\n\n    float value = (r * 65536.0) + (g * 256.0) + b;\n    return ((value / 16777216.0) * 2.0) - 1.0;\n}\n\n\nvec4 scalarLookup(vec4 c) {\n    float r = c.r * 255.0;\n    float g = c.g * 255.0;\n    float b = c.b * 255.0;\n\n    float value = (r * 65536.0) + (g * 256.0) + b;\n    value = value / 16777216.0;\n\n    return texture2D(lutSampler, vec2(value, 0.5));\n}\n\n\nvoid main() {\n    // Sample the texture containing what we have composited so far\n    vec4 color = texture2D(compositeSampler, v_texCoord);\n\n    // Sample the new layer to be composited in\n    vec4 scalarColor = texture2D(scalarSampler, v_texCoord);\n\n    // Choose the fragment with the greater depth value\n    if (color.a > scalarColor.a) {\n        gl_FragColor = color;\n    } else {\n\n        vec4 nx = texture2D(nxSampler, v_texCoord);\n        vec4 ny = texture2D(nySampler, v_texCoord);\n        vec4 nz = texture2D(nzSampler, v_texCoord);\n        vec4 normal = normalize(vec4(convert(nx), convert(ny), convert(nz), 0.0));\n\n        vec4 lutColor = scalarLookup(scalarColor);\n\n        float ka = lightTerms[0];\n        float kd = lightTerms[1];\n        float ks = lightTerms[2];\n        float alpha = lightTerms[3];\n\n        vec4 vDir = normalize(viewDir);\n        vec4 lDir = normalize(lightDir);\n\n        // Calculate ambient term\n        vec4 ambientColor = lutColor * ka;\n\n        // This will be used in both diffuse and specular terms\n        float lDotN = dot(lDir, normal);\n\n        // Adding this check allows us to light whichever side is facing the light\n        if (lDotN < 0.0) {\n            normal = -1.0 * normal;\n            lDotN = dot(lDir, normal);\n        }\n\n        // Calculate diffuse term\n        vec4 diffuseColor = kd * lutColor * lDotN;\n\n        // Calculate specular term\n        vec4 R = (normal * 2.0 * lDotN) - lDir;\n        float specularTerm = ks * pow(dot(R, vDir), alpha);\n        vec4 specularColor = lightColor * specularTerm; // * step(-lDotN, 0.0);\n\n        // Clamp them individually and sum them up\n        vec3 fColor = clamp(ambientColor.rgb, 0.0, 1.0) + clamp(diffuseColor.rgb, 0.0, 1.0) + clamp(specularColor.rgb, 0.0, 1.0);\n        gl_FragColor = vec4(fColor.rgb, scalarColor.a);\n\n        // Various debugging outputs\n\n        // gl_FragColor = vec4(ambientColor.rgb, scalarColor.a);\n        // gl_FragColor = vec4(diffuseColor.rgb, scalarColor.a);\n        // gl_FragColor = vec4(specularColor.rgb, scalarColor.a);\n        // gl_FragColor = vec4(lutColor.rgb, scalarColor.a);\n        // gl_FragColor = vec4(((normal.rgb + 1.0) / 2.0), scalarColor.a);\n    }\n}\n"},function(t,e){t.exports="\nprecision mediump float;\n\nuniform sampler2D compositeSampler;\nuniform sampler2D scalarSampler;\nuniform sampler2D lutSampler;\n\nvarying vec2 v_texCoord;\n\n\nfloat convert(vec4 c) {\n    float r = c.r * 255.0;\n    float g = c.g * 255.0;\n    float b = c.b * 255.0;\n\n    float value = (r * 65536.0) + (g * 256.0) + b;\n    return ((value / 16777216.0) * 2.0) - 1.0;\n}\n\n\nvec4 scalarLookup(vec4 c) {\n    float r = c.r * 255.0;\n    float g = c.g * 255.0;\n    float b = c.b * 255.0;\n\n    float value = (r * 65536.0) + (g * 256.0) + b;\n    value = value / 16777216.0;\n\n    return texture2D(lutSampler, vec2(value, 0.5));\n}\n\n\nvoid main() {\n    // Sample the texture containing what we have composited so far\n    vec4 color = texture2D(compositeSampler, v_texCoord);\n\n    // Sample the new layer to be composited in\n    vec4 scalarColor = texture2D(scalarSampler, v_texCoord);\n\n    // Choose the fragment with the greater depth value\n    if (color.a > scalarColor.a) {\n        gl_FragColor = color;\n    } else {\n        vec4 lutColor = scalarLookup(scalarColor);\n        gl_FragColor = vec4(lutColor.rgb, scalarColor.a);\n    }\n}\n"},function(t,e){t.exports='\nprecision mediump float;\n\nuniform sampler2D underLayerSampler;\nuniform sampler2D overLayerSampler;\nvarying vec2 v_texCoord;\n\nvoid main() {\n    vec4 overColor = texture2D(overLayerSampler, v_texCoord);\n    vec3 colA = overColor.rgb;\n    float alphA = overColor.a;\n\n    vec4 underColor = texture2D(underLayerSampler, v_texCoord);\n    vec3 colB = underColor.rgb;\n    float alphB = underColor.a;\n\n    // Well-known "over" operator (A over B, both partially transparent)\n    float alphOut = alphA + (alphB * (1.0 - alphA));\n    vec3 colOut = ((colA * alphA) + (colB * alphB * (1.0 - alphA))) / alphOut;\n\n    gl_FragColor = vec4(colOut.rgb, alphOut);\n}'},function(t,e){t.exports="\nprecision mediump float;\n\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, vec2(v_texCoord.x, 1.0 - v_texCoord.y));\n}"},function(t,e){t.exports="\nprecision mediump float;\n\nuniform sampler2D alphaSampler;\nuniform sampler2D intensitySampler;\nuniform sampler2D orderSampler;\nuniform sampler2D lutSampler;\n\nuniform float numberOfLayers;\n\nvarying vec2 v_texCoord;\n\n\n//\n// Main shader execution function\n//\nvoid main() {\n    // Look up the layer number to which this pixel corresponds\n    float order = texture2D(orderSampler, v_texCoord).r;\n    float alpha = texture2D(alphaSampler, v_texCoord).r;\n    float intensity = texture2D(intensitySampler, v_texCoord).r;\n\n    float layerCoord = (order * 255.0) / (numberOfLayers - 1.0);\n    vec4 lutColor = texture2D(lutSampler, vec2(layerCoord, 0.5));\n\n    gl_FragColor = vec4(lutColor.rgb * intensity, alpha * lutColor.a);\n}\n"},function(t,e,r){var n=r(15),i={};i.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.fromValues=function(t,e,r){var i=new n.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=r,i},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],u=r[2];return t[0]=i*u-o*s,t[1]=o*a-n*u,t[2]=n*s-i*a,t},i.lerp=function(t,e,r,n){var i=e[0],o=e[1],a=e[2];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t},i.hermite=function(t,e,r,n,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,l=a*(o-1),c=a*(3-2*o);return t[0]=e[0]*s+r[0]*u+n[0]*l+i[0]*c,t[1]=e[1]*s+r[1]*u+n[1]*l+i[1]*c,t[2]=e[2]*s+r[2]*u+n[2]*l+i[2]*c,t},i.bezier=function(t,e,r,n,i,o){var a=1-o,s=a*a,u=o*o,l=s*a,c=3*o*s,h=3*u*a,f=u*o;return t[0]=e[0]*l+r[0]*c+n[0]*h+i[0]*f,t[1]=e[1]*l+r[1]*c+n[1]*h+i[1]*f,t[2]=e[2]*l+r[2]*c+n[2]*h+i[2]*f,t},i.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI,i=2*n.RANDOM()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=i*e,t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,t},i.transformMat3=function(t,e,r){var n=e[0],i=e[1],o=e[2];return t[0]=n*r[0]+i*r[3]+o*r[6],t[1]=n*r[1]+i*r[4]+o*r[7],t[2]=n*r[2]+i*r[5]+o*r[8],t},i.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],u=r[2],l=r[3],c=l*n+s*o-u*i,h=l*i+u*n-a*o,f=l*o+a*i-s*n,g=-a*n-s*i-u*o;return t[0]=c*l+g*-a+h*-u-f*-s,t[1]=h*l+g*-s+f*-a-c*-u,t[2]=f*l+g*-u+c*-s-h*-a,t},i.rotateX=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.rotateY=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.rotateZ=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,o,a){var s,u;for(r||(r=3),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;u>s;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),i.angle=function(t,e){var r=i.fromValues(t[0],t[1],t[2]),n=i.fromValues(e[0],e[1],e[2]);i.normalize(r,r),i.normalize(n,n);var o=i.dot(r,n);return o>1?0:Math.acos(o)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t.exports=i},function(t,e,r){var n=r(15),i={};i.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.fromValues=function(t,e,r,i){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},i.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},i.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},i.sub=i.subtract,i.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},i.mul=i.multiply,i.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},i.div=i.divide,i.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},i.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},i.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},i.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},i.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+o*o)},i.dist=i.distance,i.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)},i.len=i.length,i.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},i.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},i.lerp=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=s+n*(r[3]-s),t},i.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),i.normalize(t,t),i.scale(t,t,e),t},i.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t},i.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],u=r[2],l=r[3],c=l*n+s*o-u*i,h=l*i+u*n-a*o,f=l*o+a*i-s*n,g=-a*n-s*i-u*o;return t[0]=c*l+g*-a+h*-u-f*-s,t[1]=h*l+g*-s+f*-a-c*-u,t[2]=f*l+g*-u+c*-s-h*-a,t[3]=e[3],t},i.forEach=function(){var t=i.create();return function(e,r,n,i,o,a){var s,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,s=n;u>s;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),i.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t.exports=i},function(t,e,r){var n;(function(t,i){(function(){function o(t,e){if(t!==e){var r=null===t,n=t===P,i=t===t,o=null===e,a=e===P,s=e===e;if(t>e&&!o||!i||r&&!a&&s||n&&s)return 1;if(e>t&&!r||!s||o&&!n&&i||a&&i)return-1}return 0}function a(t,e,r){for(var n=t.length,i=r?n:-1;r?i--:++i<n;)if(e(t[i],i,t))return i;return-1}function s(t,e,r){if(e!==e)return b(t,r);for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}function u(t){return"function"==typeof t||!1}function l(t){return null==t?"":t+""}function c(t,e){for(var r=-1,n=t.length;++r<n&&e.indexOf(t.charAt(r))>-1;);return r}function h(t,e){for(var r=t.length;r--&&e.indexOf(t.charAt(r))>-1;);return r}function f(t,e){return o(t.criteria,e.criteria)||t.index-e.index}function g(t,e,r){for(var n=-1,i=t.criteria,a=e.criteria,s=i.length,u=r.length;++n<s;){var l=o(i[n],a[n]);if(l){if(n>=u)return l;var c=r[n];return l*("asc"===c||c===!0?1:-1)}}return t.index-e.index}function p(t){return Wt[t]}function d(t){return Vt[t]}function v(t,e,r){return e?t=$t[t]:r&&(t=Kt[t]),"\\"+t}function m(t){return"\\"+Kt[t]}function b(t,e,r){for(var n=t.length,i=e+(r?0:-1);r?i--:++i<n;){var o=t[i];if(o!==o)return i}return-1}function y(t){return!!t&&"object"==typeof t}function _(t){return 160>=t&&t>=9&&13>=t||32==t||160==t||5760==t||6158==t||t>=8192&&(8202>=t||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function x(t,e){for(var r=-1,n=t.length,i=-1,o=[];++r<n;)t[r]===e&&(t[r]=W,o[++i]=r);return o}function T(t,e){for(var r,n=-1,i=t.length,o=-1,a=[];++n<i;){var s=t[n],u=e?e(s,n,t):s;n&&r===u||(r=u,a[++o]=s)}return a}function C(t){for(var e=-1,r=t.length;++e<r&&_(t.charCodeAt(e)););return e}function E(t){for(var e=t.length;e--&&_(t.charCodeAt(e)););return e}function w(t){return Qt[t]}function R(t){function e(t){if(y(t)&&!Ms(t)&&!(t instanceof i)){if(t instanceof n)return t;if(ea.call(t,"__chain__")&&ea.call(t,"__wrapped__"))return gn(t)}return new n(t)}function r(){}function n(t,e,r){this.__wrapped__=t,this.__actions__=r||[],this.__chain__=!!e}function i(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Da,this.__views__=[]}function _(){var t=new i(this.__wrapped__);return t.__actions__=te(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=te(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=te(this.__views__),t}function J(){if(this.__filtered__){var t=new i(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function nt(){var t=this.__wrapped__.value(),e=this.__dir__,r=Ms(t),n=0>e,i=r?t.length:0,o=qr(0,i,this.__views__),a=o.start,s=o.end,u=s-a,l=n?s:a-1,c=this.__iteratees__,h=c.length,f=0,g=Ca(u,this.__takeCount__);if(!r||z>i||i==u&&g==u)return rr(n&&r?t.reverse():t,this.__actions__);var p=[];t:for(;u--&&g>f;){l+=e;for(var d=-1,v=t[l];++d<h;){var m=c[d],b=m.iteratee,y=m.type,_=b(v);if(y==G)v=_;else if(!_){if(y==Y)continue t;break t}}p[f++]=v}return p}function ot(){this.__data__={}}function Wt(t){return this.has(t)&&delete this.__data__[t]}function Vt(t){return"__proto__"==t?P:this.__data__[t]}function Qt(t){return"__proto__"!=t&&ea.call(this.__data__,t)}function Zt(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function $t(t){var e=t?t.length:0;for(this.data={hash:ma(null),set:new ha};e--;)this.push(t[e])}function Kt(t,e){var r=t.data,n="string"==typeof e||ki(e)?r.set.has(e):r.hash[e];return n?0:-1}function Ht(t){var e=this.data;"string"==typeof t||ki(t)?e.set.add(t):e.hash[t]=!0}function Jt(t,e){for(var r=-1,n=t.length,i=-1,o=e.length,a=jo(n+o);++r<n;)a[r]=t[r];for(;++i<o;)a[r++]=e[i];return a}function te(t,e){var r=-1,n=t.length;for(e||(e=jo(n));++r<n;)e[r]=t[r];return e}function ee(t,e){for(var r=-1,n=t.length;++r<n&&e(t[r],r,t)!==!1;);return t}function re(t,e){for(var r=t.length;r--&&e(t[r],r,t)!==!1;);return t}function oe(t,e){for(var r=-1,n=t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function ae(t,e,r,n){for(var i=-1,o=t.length,a=n,s=a;++i<o;){var u=t[i],l=+e(u);r(l,a)&&(a=l,s=u)}return s}function se(t,e){for(var r=-1,n=t.length,i=-1,o=[];++r<n;){var a=t[r];e(a,r,t)&&(o[++i]=a)}return o}function ue(t,e){for(var r=-1,n=t.length,i=jo(n);++r<n;)i[r]=e(t[r],r,t);return i}function le(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function ce(t,e,r,n){var i=-1,o=t.length;for(n&&o&&(r=t[++i]);++i<o;)r=e(r,t[i],i,t);return r}function he(t,e,r,n){var i=t.length;for(n&&i&&(r=t[--i]);i--;)r=e(r,t[i],i,t);return r}function fe(t,e){for(var r=-1,n=t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function ge(t,e){for(var r=t.length,n=0;r--;)n+=+e(t[r])||0;return n}function pe(t,e){return t===P?e:t}function de(t,e,r,n){return t!==P&&ea.call(n,r)?t:e}function ve(t,e,r){for(var n=-1,i=Bs(e),o=i.length;++n<o;){var a=i[n],s=t[a],u=r(s,e[a],a,t,e);(u===u?u===s:s!==s)&&(s!==P||a in t)||(t[a]=u)}return t}function me(t,e){return null==e?t:ye(e,Bs(e),t)}function be(t,e){for(var r=-1,n=null==t,i=!n&&$r(t),o=i?t.length:0,a=e.length,s=jo(a);++r<a;){var u=e[r];i?s[r]=Kr(u,o)?t[u]:P:s[r]=n?P:t[u]}return s}function ye(t,e,r){r||(r={});for(var n=-1,i=e.length;++n<i;){var o=e[n];r[o]=t[o]}return r}function _e(t,e,r){var n=typeof t;return"function"==n?e===P?t:or(t,e,r):null==t?Do:"object"==n?Xe(t):e===P?ko(t):Be(t,e)}function xe(t,e,r,n,i,o,a){var s;if(r&&(s=i?r(t,n,i):r(t)),s!==P)return s;if(!ki(t))return t;var u=Ms(t);if(u){if(s=Wr(t),!e)return te(t,s)}else{var l=na.call(t),c=l==H;if(l!=et&&l!=V&&(!c||i))return qt[l]?Qr(t,l,e):i?t:{};if(s=Vr(c?{}:t),!e)return me(s,t)}o||(o=[]),a||(a=[]);for(var h=o.length;h--;)if(o[h]==t)return a[h];return o.push(t),a.push(s),(u?ee:Ae)(t,function(n,i){s[i]=xe(n,e,r,i,t,o,a)}),s}function Te(t,e,r){if("function"!=typeof t)throw new $o(q);return fa(function(){t.apply(P,r)},e)}function Ce(t,e){var r=t?t.length:0,n=[];if(!r)return n;var i=-1,o=zr(),a=o==s,u=a&&e.length>=z?pr(e):null,l=e.length;u&&(o=Kt,a=!1,e=u);t:for(;++i<r;){var c=t[i];if(a&&c===c){for(var h=l;h--;)if(e[h]===c)continue t;n.push(c)}else o(e,c,0)<0&&n.push(c)}return n}function Ee(t,e){var r=!0;return Ua(t,function(t,n,i){return r=!!e(t,n,i)}),r}function we(t,e,r,n){var i=n,o=i;return Ua(t,function(t,a,s){var u=+e(t,a,s);(r(u,i)||u===n&&u===o)&&(i=u,o=t)}),o}function Re(t,e,r,n){var i=t.length;for(r=null==r?0:+r||0,0>r&&(r=-r>i?0:i+r),n=n===P||n>i?i:+n||0,0>n&&(n+=i),i=r>n?0:n>>>0,r>>>=0;i>r;)t[r++]=e;return t}function Pe(t,e){var r=[];return Ua(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r}function De(t,e,r,n){var i;return r(t,function(t,r,o){return e(t,r,o)?(i=n?r:t,!1):void 0}),i}function Me(t,e,r,n){n||(n=[]);for(var i=-1,o=t.length;++i<o;){var a=t[i];y(a)&&$r(a)&&(r||Ms(a)||wi(a))?e?Me(a,e,r,n):le(n,a):r||(n[n.length]=a)}return n}function Se(t,e){return Na(t,e,to)}function Ae(t,e){return Na(t,e,Bs)}function Le(t,e){return Xa(t,e,Bs)}function Ie(t,e){for(var r=-1,n=e.length,i=-1,o=[];++r<n;){var a=e[r];Ii(t[a])&&(o[++i]=a)}return o}function ke(t,e,r){if(null!=t){r!==P&&r in hn(t)&&(e=[r]);for(var n=0,i=e.length;null!=t&&i>n;)t=t[e[n++]];return n&&n==i?t:P}}function Fe(t,e,r,n,i,o){return t===e?!0:null==t||null==e||!ki(t)&&!y(e)?t!==t&&e!==e:Ue(t,e,Fe,r,n,i,o)}function Ue(t,e,r,n,i,o,a){var s=Ms(t),u=Ms(e),l=Q,c=Q;s||(l=na.call(t),l==V?l=et:l!=et&&(s=Yi(t))),u||(c=na.call(e),c==V?c=et:c!=et&&(u=Yi(e)));var h=l==et,f=c==et,g=l==c;if(g&&!s&&!h)return Nr(t,e,l);if(!i){var p=h&&ea.call(t,"__wrapped__"),d=f&&ea.call(e,"__wrapped__");if(p||d)return r(p?t.value():t,d?e.value():e,n,i,o,a)}if(!g)return!1;o||(o=[]),a||(a=[]);for(var v=o.length;v--;)if(o[v]==t)return a[v]==e;o.push(t),a.push(e);var m=(s?Or:Xr)(t,e,r,n,i,o,a);return o.pop(),a.pop(),m}function Oe(t,e,r){var n=e.length,i=n,o=!r;if(null==t)return!i;for(t=hn(t);n--;){var a=e[n];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++n<i;){a=e[n];var s=a[0],u=t[s],l=a[1];if(o&&a[2]){if(u===P&&!(s in t))return!1}else{var c=r?r(u,l,s):P;if(!(c===P?Fe(l,u,r,!0):c))return!1}}return!0}function Ne(t,e){var r=-1,n=$r(t)?jo(t.length):[];return Ua(t,function(t,i,o){n[++r]=e(t,i,o)}),n}function Xe(t){var e=Yr(t);if(1==e.length&&e[0][2]){var r=e[0][0],n=e[0][1];return function(t){return null==t?!1:t[r]===n&&(n!==P||r in hn(t))}}return function(t){return Oe(t,e)}}function Be(t,e){var r=Ms(t),n=Jr(t)&&rn(e),i=t+"";return t=fn(t),function(o){if(null==o)return!1;var a=i;if(o=hn(o),(r||!n)&&!(a in o)){if(o=1==t.length?o:ke(o,Qe(t,0,-1)),null==o)return!1;a=Rn(t),o=hn(o)}return o[a]===e?e!==P||a in o:Fe(e,o[a],P,!0)}}function je(t,e,r,n,i){if(!ki(t))return t;var o=$r(e)&&(Ms(e)||Yi(e)),a=o?P:Bs(e);return ee(a||e,function(s,u){if(a&&(u=s,s=e[u]),y(s))n||(n=[]),i||(i=[]),ze(t,e,u,je,r,n,i);else{var l=t[u],c=r?r(l,s,u,t,e):P,h=c===P;h&&(c=s),c===P&&(!o||u in t)||!h&&(c===c?c===l:l!==l)||(t[u]=c)}}),t}function ze(t,e,r,n,i,o,a){for(var s=o.length,u=e[r];s--;)if(o[s]==u)return void(t[r]=a[s]);var l=t[r],c=i?i(l,u,r,t,e):P,h=c===P;h&&(c=u,$r(u)&&(Ms(u)||Yi(u))?c=Ms(l)?l:$r(l)?te(l):[]:Bi(u)||wi(u)?c=wi(l)?Qi(l):Bi(l)?l:{}:h=!1),o.push(u),a.push(c),h?t[r]=n(c,u,i,o,a):(c===c?c!==l:l===l)&&(t[r]=c)}function Ye(t){return function(e){return null==e?P:e[t]}}function Ge(t){var e=t+"";return t=fn(t),function(r){return ke(r,t,e)}}function qe(t,e){for(var r=t?e.length:0;r--;){
var n=e[r];if(n!=i&&Kr(n)){var i=n;ga.call(t,n,1)}}return t}function We(t,e){return t+ba(Ra()*(e-t+1))}function Ve(t,e,r,n,i){return i(t,function(t,i,o){r=n?(n=!1,t):e(r,t,i,o)}),r}function Qe(t,e,r){var n=-1,i=t.length;e=null==e?0:+e||0,0>e&&(e=-e>i?0:i+e),r=r===P||r>i?i:+r||0,0>r&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=jo(i);++n<i;)o[n]=t[n+e];return o}function Ze(t,e){var r;return Ua(t,function(t,n,i){return r=e(t,n,i),!r}),!!r}function $e(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}function Ke(t,e,r){var n=Br(),i=-1;e=ue(e,function(t){return n(t)});var o=Ne(t,function(t){var r=ue(e,function(e){return e(t)});return{criteria:r,index:++i,value:t}});return $e(o,function(t,e){return g(t,e,r)})}function He(t,e){var r=0;return Ua(t,function(t,n,i){r+=+e(t,n,i)||0}),r}function Je(t,e){var r=-1,n=zr(),i=t.length,o=n==s,a=o&&i>=z,u=a?pr():null,l=[];u?(n=Kt,o=!1):(a=!1,u=e?[]:l);t:for(;++r<i;){var c=t[r],h=e?e(c,r,t):c;if(o&&c===c){for(var f=u.length;f--;)if(u[f]===h)continue t;e&&u.push(h),l.push(c)}else n(u,h,0)<0&&((e||a)&&u.push(h),l.push(c))}return l}function tr(t,e){for(var r=-1,n=e.length,i=jo(n);++r<n;)i[r]=t[e[r]];return i}function er(t,e,r,n){for(var i=t.length,o=n?i:-1;(n?o--:++o<i)&&e(t[o],o,t););return r?Qe(t,n?0:o,n?o+1:i):Qe(t,n?o+1:0,n?i:o)}function rr(t,e){var r=t;r instanceof i&&(r=r.value());for(var n=-1,o=e.length;++n<o;){var a=e[n];r=a.func.apply(a.thisArg,le([r],a.args))}return r}function nr(t,e,r){var n=0,i=t?t.length:n;if("number"==typeof e&&e===e&&Aa>=i){for(;i>n;){var o=n+i>>>1,a=t[o];(r?e>=a:e>a)&&null!==a?n=o+1:i=o}return i}return ir(t,e,Do,r)}function ir(t,e,r,n){e=r(e);for(var i=0,o=t?t.length:0,a=e!==e,s=null===e,u=e===P;o>i;){var l=ba((i+o)/2),c=r(t[l]),h=c!==P,f=c===c;if(a)var g=f||n;else g=s?f&&h&&(n||null!=c):u?f&&(n||h):null==c?!1:n?e>=c:e>c;g?i=l+1:o=l}return Ca(o,Sa)}function or(t,e,r){if("function"!=typeof t)return Do;if(e===P)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)};case 5:return function(r,n,i,o,a){return t.call(e,r,n,i,o,a)}}return function(){return t.apply(e,arguments)}}function ar(t){var e=new aa(t.byteLength),r=new pa(e);return r.set(new pa(t)),e}function sr(t,e,r){for(var n=r.length,i=-1,o=Ta(t.length-n,0),a=-1,s=e.length,u=jo(s+o);++a<s;)u[a]=e[a];for(;++i<n;)u[r[i]]=t[i];for(;o--;)u[a++]=t[i++];return u}function ur(t,e,r){for(var n=-1,i=r.length,o=-1,a=Ta(t.length-i,0),s=-1,u=e.length,l=jo(a+u);++o<a;)l[o]=t[o];for(var c=o;++s<u;)l[c+s]=e[s];for(;++n<i;)l[c+r[n]]=t[o++];return l}function lr(t,e){return function(r,n,i){var o=e?e():{};if(n=Br(n,i,3),Ms(r))for(var a=-1,s=r.length;++a<s;){var u=r[a];t(o,u,n(u,a,r),r)}else Ua(r,function(e,r,i){t(o,e,n(e,r,i),i)});return o}}function cr(t){return mi(function(e,r){var n=-1,i=null==e?0:r.length,o=i>2?r[i-2]:P,a=i>2?r[2]:P,s=i>1?r[i-1]:P;for("function"==typeof o?(o=or(o,s,5),i-=2):(o="function"==typeof s?s:P,i-=o?1:0),a&&Hr(r[0],r[1],a)&&(o=3>i?P:o,i=1);++n<i;){var u=r[n];u&&t(e,u,o)}return e})}function hr(t,e){return function(r,n){var i=r?za(r):0;if(!en(i))return t(r,n);for(var o=e?i:-1,a=hn(r);(e?o--:++o<i)&&n(a[o],o,a)!==!1;);return r}}function fr(t){return function(e,r,n){for(var i=hn(e),o=n(e),a=o.length,s=t?a:-1;t?s--:++s<a;){var u=o[s];if(r(i[u],u,i)===!1)break}return e}}function gr(t,e){function r(){var i=this&&this!==ne&&this instanceof r?n:t;return i.apply(e,arguments)}var n=vr(t);return r}function pr(t){return ma&&ha?new $t(t):null}function dr(t){return function(e){for(var r=-1,n=wo(co(e)),i=n.length,o="";++r<i;)o=t(o,n[r],r);return o}}function vr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=Fa(t.prototype),n=t.apply(r,e);return ki(n)?n:r}}function mr(t){function e(r,n,i){i&&Hr(r,n,i)&&(n=P);var o=Ur(r,t,P,P,P,P,P,n);return o.placeholder=e.placeholder,o}return e}function br(t,e){return mi(function(r){var n=r[0];return null==n?n:(r.push(e),t.apply(P,r))})}function yr(t,e){return function(r,n,i){if(i&&Hr(r,n,i)&&(n=P),n=Br(n,i,3),1==n.length){r=Ms(r)?r:cn(r);var o=ae(r,n,t,e);if(!r.length||o!==e)return o}return we(r,n,t,e)}}function _r(t,e){return function(r,n,i){if(n=Br(n,i,3),Ms(r)){var o=a(r,n,e);return o>-1?r[o]:P}return De(r,n,t)}}function xr(t){return function(e,r,n){return e&&e.length?(r=Br(r,n,3),a(e,r,t)):-1}}function Tr(t){return function(e,r,n){return r=Br(r,n,3),De(e,r,t,!0)}}function Cr(t){return function(){for(var e,r=arguments.length,i=t?r:-1,o=0,a=jo(r);t?i--:++i<r;){var s=a[o++]=arguments[i];if("function"!=typeof s)throw new $o(q);!e&&n.prototype.thru&&"wrapper"==jr(s)&&(e=new n([],!0))}for(i=e?-1:r;++i<r;){s=a[i];var u=jr(s),l="wrapper"==u?ja(s):P;e=l&&tn(l[0])&&l[1]==(U|L|k|O)&&!l[4].length&&1==l[9]?e[jr(l[0])].apply(e,l[3]):1==s.length&&tn(s)?e[u]():e.thru(s)}return function(){var t=arguments,n=t[0];if(e&&1==t.length&&Ms(n)&&n.length>=z)return e.plant(n).value();for(var i=0,o=r?a[i].apply(this,t):n;++i<r;)o=a[i].call(this,o);return o}}}function Er(t,e){return function(r,n,i){return"function"==typeof n&&i===P&&Ms(r)?t(r,n):e(r,or(n,i,3))}}function wr(t){return function(e,r,n){return("function"!=typeof r||n!==P)&&(r=or(r,n,3)),t(e,r,to)}}function Rr(t){return function(e,r,n){return("function"!=typeof r||n!==P)&&(r=or(r,n,3)),t(e,r)}}function Pr(t){return function(e,r,n){var i={};return r=Br(r,n,3),Ae(e,function(e,n,o){var a=r(e,n,o);n=t?a:n,e=t?e:a,i[n]=e}),i}}function Dr(t){return function(e,r,n){return e=l(e),(t?e:"")+Lr(e,r,n)+(t?"":e)}}function Mr(t){var e=mi(function(r,n){var i=x(n,e.placeholder);return Ur(r,t,P,n,i)});return e}function Sr(t,e){return function(r,n,i,o){var a=arguments.length<3;return"function"==typeof n&&o===P&&Ms(r)?t(r,n,i,a):Ve(r,Br(n,o,4),i,a,e)}}function Ar(t,e,r,n,i,o,a,s,u,l){function c(){for(var b=arguments.length,y=b,_=jo(b);y--;)_[y]=arguments[y];if(n&&(_=sr(_,n,i)),o&&(_=ur(_,o,a)),p||v){var T=c.placeholder,C=x(_,T);if(b-=C.length,l>b){var E=s?te(s):P,w=Ta(l-b,0),R=p?C:P,D=p?P:C,A=p?_:P,L=p?P:_;e|=p?k:F,e&=~(p?F:k),d||(e&=~(M|S));var I=[t,e,r,A,R,L,D,E,u,w],U=Ar.apply(P,I);return tn(t)&&Ya(U,I),U.placeholder=T,U}}var O=f?r:this,N=g?O[t]:t;return s&&(_=un(_,s)),h&&u<_.length&&(_.length=u),this&&this!==ne&&this instanceof c&&(N=m||vr(t)),N.apply(O,_)}var h=e&U,f=e&M,g=e&S,p=e&L,d=e&A,v=e&I,m=g?P:vr(t);return c}function Lr(t,e,r){var n=t.length;if(e=+e,n>=e||!_a(e))return"";var i=e-n;return r=null==r?" ":r+"",mo(r,va(i/r.length)).slice(0,i)}function Ir(t,e,r,n){function i(){for(var e=-1,s=arguments.length,u=-1,l=n.length,c=jo(l+s);++u<l;)c[u]=n[u];for(;s--;)c[u++]=arguments[++e];var h=this&&this!==ne&&this instanceof i?a:t;return h.apply(o?r:this,c)}var o=e&M,a=vr(t);return i}function kr(t){var e=qo[t];return function(t,r){return r=r===P?0:+r||0,r?(r=la(10,r),e(t*r)/r):e(t)}}function Fr(t){return function(e,r,n,i){var o=Br(n);return null==n&&o===_e?nr(e,r,t):ir(e,r,o(n,i,1),t)}}function Ur(t,e,r,n,i,o,a,s){var u=e&S;if(!u&&"function"!=typeof t)throw new $o(q);var l=n?n.length:0;if(l||(e&=~(k|F),n=i=P),l-=i?i.length:0,e&F){var c=n,h=i;n=i=P}var f=u?P:ja(t),g=[t,e,r,n,i,c,h,o,a,s];if(f&&(nn(g,f),e=g[1],s=g[9]),g[9]=null==s?u?0:t.length:Ta(s-l,0)||0,e==M)var p=gr(g[0],g[2]);else p=e!=k&&e!=(M|k)||g[4].length?Ar.apply(P,g):Ir.apply(P,g);var d=f?Ba:Ya;return d(p,g)}function Or(t,e,r,n,i,o,a){var s=-1,u=t.length,l=e.length;if(u!=l&&!(i&&l>u))return!1;for(;++s<u;){var c=t[s],h=e[s],f=n?n(i?h:c,i?c:h,s):P;if(f!==P){if(f)continue;return!1}if(i){if(!fe(e,function(t){return c===t||r(c,t,n,i,o,a)}))return!1}else if(c!==h&&!r(c,h,n,i,o,a))return!1}return!0}function Nr(t,e,r){switch(r){case Z:case $:return+t==+e;case K:return t.name==e.name&&t.message==e.message;case tt:return t!=+t?e!=+e:t==+e;case rt:case it:return t==e+""}return!1}function Xr(t,e,r,n,i,o,a){var s=Bs(t),u=s.length,l=Bs(e),c=l.length;if(u!=c&&!i)return!1;for(var h=u;h--;){var f=s[h];if(!(i?f in e:ea.call(e,f)))return!1}for(var g=i;++h<u;){f=s[h];var p=t[f],d=e[f],v=n?n(i?d:p,i?p:d,f):P;if(!(v===P?r(p,d,n,i,o,a):v))return!1;g||(g="constructor"==f)}if(!g){var m=t.constructor,b=e.constructor;if(m!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof b&&b instanceof b))return!1}return!0}function Br(t,r,n){var i=e.callback||Ro;return i=i===Ro?_e:i,n?i(t,r,n):i}function jr(t){for(var e=t.name,r=ka[e],n=r?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==t)return i.name}return e}function zr(t,r,n){var i=e.indexOf||En;return i=i===En?s:i,t?i(t,r,n):i}function Yr(t){for(var e=eo(t),r=e.length;r--;)e[r][2]=rn(e[r][1]);return e}function Gr(t,e){var r=null==t?P:t[e];return Oi(r)?r:P}function qr(t,e,r){for(var n=-1,i=r.length;++n<i;){var o=r[n],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=Ca(e,t+a);break;case"takeRight":t=Ta(t,e-a)}}return{start:t,end:e}}function Wr(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&ea.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function Vr(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Vo),new e}function Qr(t,e,r){var n=t.constructor;switch(e){case at:return ar(t);case Z:case $:return new n(+t);case st:case ut:case lt:case ct:case ht:case ft:case gt:case pt:case dt:var i=t.buffer;return new n(r?ar(i):i,t.byteOffset,t.length);case tt:case it:return new n(t);case rt:var o=new n(t.source,kt.exec(t));o.lastIndex=t.lastIndex}return o}function Zr(t,e,r){null==t||Jr(e,t)||(e=fn(e),t=1==e.length?t:ke(t,Qe(e,0,-1)),e=Rn(e));var n=null==t?t:t[e];return null==n?P:n.apply(t,r)}function $r(t){return null!=t&&en(za(t))}function Kr(t,e){return t="number"==typeof t||Ot.test(t)?+t:-1,e=null==e?La:e,t>-1&&t%1==0&&e>t}function Hr(t,e,r){if(!ki(r))return!1;var n=typeof e;if("number"==n?$r(r)&&Kr(e,r.length):"string"==n&&e in r){var i=r[e];return t===t?t===i:i!==i}return!1}function Jr(t,e){var r=typeof t;if("string"==r&&Pt.test(t)||"number"==r)return!0;if(Ms(t))return!1;var n=!Rt.test(t);return n||null!=e&&t in hn(e)}function tn(t){var r=jr(t);if(!(r in i.prototype))return!1;var n=e[r];if(t===n)return!0;var o=ja(n);return!!o&&t===o[0]}function en(t){return"number"==typeof t&&t>-1&&t%1==0&&La>=t}function rn(t){return t===t&&!ki(t)}function nn(t,e){var r=t[1],n=e[1],i=r|n,o=U>i,a=n==U&&r==L||n==U&&r==O&&t[7].length<=e[8]||n==(U|O)&&r==L;if(!o&&!a)return t;n&M&&(t[2]=e[2],i|=r&M?0:A);var s=e[3];if(s){var u=t[3];t[3]=u?sr(u,s,e[4]):te(s),t[4]=u?x(t[3],W):te(e[4])}return s=e[5],s&&(u=t[5],t[5]=u?ur(u,s,e[6]):te(s),t[6]=u?x(t[5],W):te(e[6])),s=e[7],s&&(t[7]=te(s)),n&U&&(t[8]=null==t[8]?e[8]:Ca(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function on(t,e){return t===P?e:Ss(t,e,on)}function an(t,e){t=hn(t);for(var r=-1,n=e.length,i={};++r<n;){var o=e[r];o in t&&(i[o]=t[o])}return i}function sn(t,e){var r={};return Se(t,function(t,n,i){e(t,n,i)&&(r[n]=t)}),r}function un(t,e){for(var r=t.length,n=Ca(e.length,r),i=te(t);n--;){var o=e[n];t[n]=Kr(o,r)?i[o]:P}return t}function ln(t){for(var e=to(t),r=e.length,n=r&&t.length,i=!!n&&en(n)&&(Ms(t)||wi(t)),o=-1,a=[];++o<r;){var s=e[o];(i&&Kr(s,n)||ea.call(t,s))&&a.push(s)}return a}function cn(t){return null==t?[]:$r(t)?ki(t)?t:Vo(t):oo(t)}function hn(t){return ki(t)?t:Vo(t)}function fn(t){if(Ms(t))return t;var e=[];return l(t).replace(Dt,function(t,r,n,i){e.push(n?i.replace(Lt,"$1"):r||t)}),e}function gn(t){return t instanceof i?t.clone():new n(t.__wrapped__,t.__chain__,te(t.__actions__))}function pn(t,e,r){e=(r?Hr(t,e,r):null==e)?1:Ta(ba(e)||1,1);for(var n=0,i=t?t.length:0,o=-1,a=jo(va(i/e));i>n;)a[++o]=Qe(t,n,n+=e);return a}function dn(t){for(var e=-1,r=t?t.length:0,n=-1,i=[];++e<r;){var o=t[e];o&&(i[++n]=o)}return i}function vn(t,e,r){var n=t?t.length:0;return n?((r?Hr(t,e,r):null==e)&&(e=1),Qe(t,0>e?0:e)):[]}function mn(t,e,r){var n=t?t.length:0;return n?((r?Hr(t,e,r):null==e)&&(e=1),e=n-(+e||0),Qe(t,0,0>e?0:e)):[]}function bn(t,e,r){return t&&t.length?er(t,Br(e,r,3),!0,!0):[]}function yn(t,e,r){return t&&t.length?er(t,Br(e,r,3),!0):[]}function _n(t,e,r,n){var i=t?t.length:0;return i?(r&&"number"!=typeof r&&Hr(t,e,r)&&(r=0,n=i),Re(t,e,r,n)):[]}function xn(t){return t?t[0]:P}function Tn(t,e,r){var n=t?t.length:0;return r&&Hr(t,e,r)&&(e=!1),n?Me(t,e):[]}function Cn(t){var e=t?t.length:0;return e?Me(t,!0):[]}function En(t,e,r){var n=t?t.length:0;if(!n)return-1;if("number"==typeof r)r=0>r?Ta(n+r,0):r;else if(r){var i=nr(t,e);return n>i&&(e===e?e===t[i]:t[i]!==t[i])?i:-1}return s(t,e,r||0)}function wn(t){return mn(t,1)}function Rn(t){var e=t?t.length:0;return e?t[e-1]:P}function Pn(t,e,r){var n=t?t.length:0;if(!n)return-1;var i=n;if("number"==typeof r)i=(0>r?Ta(n+r,0):Ca(r||0,n-1))+1;else if(r){i=nr(t,e,!0)-1;var o=t[i];return(e===e?e===o:o!==o)?i:-1}if(e!==e)return b(t,i,!0);for(;i--;)if(t[i]===e)return i;return-1}function Dn(){var t=arguments,e=t[0];if(!e||!e.length)return e;for(var r=0,n=zr(),i=t.length;++r<i;)for(var o=0,a=t[r];(o=n(e,a,o))>-1;)ga.call(e,o,1);return e}function Mn(t,e,r){var n=[];if(!t||!t.length)return n;var i=-1,o=[],a=t.length;for(e=Br(e,r,3);++i<a;){var s=t[i];e(s,i,t)&&(n.push(s),o.push(i))}return qe(t,o),n}function Sn(t){return vn(t,1)}function An(t,e,r){var n=t?t.length:0;return n?(r&&"number"!=typeof r&&Hr(t,e,r)&&(e=0,r=n),Qe(t,e,r)):[]}function Ln(t,e,r){var n=t?t.length:0;return n?((r?Hr(t,e,r):null==e)&&(e=1),Qe(t,0,0>e?0:e)):[]}function In(t,e,r){var n=t?t.length:0;return n?((r?Hr(t,e,r):null==e)&&(e=1),e=n-(+e||0),Qe(t,0>e?0:e)):[]}function kn(t,e,r){return t&&t.length?er(t,Br(e,r,3),!1,!0):[]}function Fn(t,e,r){return t&&t.length?er(t,Br(e,r,3)):[]}function Un(t,e,r,n){var i=t?t.length:0;if(!i)return[];null!=e&&"boolean"!=typeof e&&(n=r,r=Hr(t,e,n)?P:e,e=!1);var o=Br();return(null!=r||o!==_e)&&(r=o(r,n,3)),e&&zr()==s?T(t,r):Je(t,r)}function On(t){if(!t||!t.length)return[];var e=-1,r=0;t=se(t,function(t){return $r(t)?(r=Ta(t.length,r),!0):void 0});for(var n=jo(r);++e<r;)n[e]=ue(t,Ye(e));return n}function Nn(t,e,r){var n=t?t.length:0;if(!n)return[];var i=On(t);return null==e?i:(e=or(e,r,4),ue(i,function(t){return ce(t,e,P,!0)}))}function Xn(){for(var t=-1,e=arguments.length;++t<e;){var r=arguments[t];if($r(r))var n=n?le(Ce(n,r),Ce(r,n)):r}return n?Je(n):[]}function Bn(t,e){var r=-1,n=t?t.length:0,i={};for(!n||e||Ms(t[0])||(e=[]);++r<n;){var o=t[r];e?i[o]=e[r]:o&&(i[o[0]]=o[1])}return i}function jn(t){var r=e(t);return r.__chain__=!0,r}function zn(t,e,r){return e.call(r,t),t}function Yn(t,e,r){return e.call(r,t)}function Gn(){return jn(this)}function qn(){return new n(this.value(),this.__chain__)}function Wn(t){for(var e,n=this;n instanceof r;){var i=gn(n);e?o.__wrapped__=i:e=i;var o=i;n=n.__wrapped__}return o.__wrapped__=t,e}function Vn(){var t=this.__wrapped__,e=function(t){return r&&r.__dir__<0?t:t.reverse()};if(t instanceof i){var r=t;return this.__actions__.length&&(r=new i(this)),r=r.reverse(),r.__actions__.push({func:Yn,args:[e],thisArg:P}),new n(r,this.__chain__)}return this.thru(e)}function Qn(){return this.value()+""}function Zn(){return rr(this.__wrapped__,this.__actions__)}function $n(t,e,r){var n=Ms(t)?oe:Ee;return r&&Hr(t,e,r)&&(e=P),("function"!=typeof e||r!==P)&&(e=Br(e,r,3)),n(t,e)}function Kn(t,e,r){var n=Ms(t)?se:Pe;return e=Br(e,r,3),n(t,e)}function Hn(t,e){return is(t,Xe(e))}function Jn(t,e,r,n){var i=t?za(t):0;return en(i)||(t=oo(t),i=t.length),r="number"!=typeof r||n&&Hr(e,r,n)?0:0>r?Ta(i+r,0):r||0,"string"==typeof t||!Ms(t)&&zi(t)?i>=r&&t.indexOf(e,r)>-1:!!i&&zr(t,e,r)>-1}function ti(t,e,r){var n=Ms(t)?ue:Ne;return e=Br(e,r,3),n(t,e)}function ei(t,e){return ti(t,ko(e))}function ri(t,e,r){var n=Ms(t)?se:Pe;return e=Br(e,r,3),n(t,function(t,r,n){return!e(t,r,n)})}function ni(t,e,r){if(r?Hr(t,e,r):null==e){t=cn(t);var n=t.length;return n>0?t[We(0,n-1)]:P}var i=-1,o=Vi(t),n=o.length,a=n-1;for(e=Ca(0>e?0:+e||0,n);++i<e;){var s=We(i,a),u=o[s];o[s]=o[i],o[i]=u}return o.length=e,o}function ii(t){return ni(t,Da)}function oi(t){var e=t?za(t):0;return en(e)?e:Bs(t).length}function ai(t,e,r){var n=Ms(t)?fe:Ze;return r&&Hr(t,e,r)&&(e=P),("function"!=typeof e||r!==P)&&(e=Br(e,r,3)),n(t,e)}function si(t,e,r){if(null==t)return[];r&&Hr(t,e,r)&&(e=P);var n=-1;e=Br(e,r,3);var i=Ne(t,function(t,r,i){return{criteria:e(t,r,i),index:++n,value:t}});return $e(i,f)}function ui(t,e,r,n){return null==t?[]:(n&&Hr(e,r,n)&&(r=P),Ms(e)||(e=null==e?[]:[e]),Ms(r)||(r=null==r?[]:[r]),Ke(t,e,r))}function li(t,e){return Kn(t,Xe(e))}function ci(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new $o(q);var r=t;t=e,e=r}return t=_a(t=+t)?t:0,function(){return--t<1?e.apply(this,arguments):void 0}}function hi(t,e,r){return r&&Hr(t,e,r)&&(e=P),e=t&&null==e?t.length:Ta(+e||0,0),Ur(t,U,P,P,P,P,e)}function fi(t,e){var r;if("function"!=typeof e){if("function"!=typeof t)throw new $o(q);var n=t;t=e,e=n}return function(){return--t>0&&(r=e.apply(this,arguments)),1>=t&&(e=P),r}}function gi(t,e,r){function n(){g&&sa(g),l&&sa(l),d=0,l=g=p=P}function i(e,r){r&&sa(r),l=g=p=P,e&&(d=ds(),c=t.apply(f,u),g||l||(u=f=P))}function o(){var t=e-(ds()-h);0>=t||t>e?i(p,l):g=fa(o,t)}function a(){i(m,g)}function s(){if(u=arguments,h=ds(),f=this,p=m&&(g||!b),v===!1)var r=b&&!g;else{l||b||(d=h);var n=v-(h-d),i=0>=n||n>v;i?(l&&(l=sa(l)),d=h,c=t.apply(f,u)):l||(l=fa(a,n))}return i&&g?g=sa(g):g||e===v||(g=fa(o,e)),r&&(i=!0,c=t.apply(f,u)),!i||g||l||(u=f=P),c}var u,l,c,h,f,g,p,d=0,v=!1,m=!0;if("function"!=typeof t)throw new $o(q);if(e=0>e?0:+e||0,r===!0){var b=!0;m=!1}else ki(r)&&(b=!!r.leading,v="maxWait"in r&&Ta(+r.maxWait||0,e),m="trailing"in r?!!r.trailing:m);return s.cancel=n,s}function pi(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new $o(q);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=t.apply(this,n);return r.cache=o.set(i,a),a};return r.cache=new pi.Cache,r}function di(t){if("function"!=typeof t)throw new $o(q);return function(){return!t.apply(this,arguments)}}function vi(t){return fi(2,t)}function mi(t,e){if("function"!=typeof t)throw new $o(q);return e=Ta(e===P?t.length-1:+e||0,0),function(){for(var r=arguments,n=-1,i=Ta(r.length-e,0),o=jo(i);++n<i;)o[n]=r[e+n];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,r[0],o);case 2:return t.call(this,r[0],r[1],o)}var a=jo(e+1);for(n=-1;++n<e;)a[n]=r[n];return a[e]=o,t.apply(this,a)}}function bi(t){if("function"!=typeof t)throw new $o(q);return function(e){return t.apply(this,e)}}function yi(t,e,r){var n=!0,i=!0;if("function"!=typeof t)throw new $o(q);return r===!1?n=!1:ki(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),gi(t,e,{leading:n,maxWait:+e,trailing:i})}function _i(t,e){return e=null==e?Do:e,Ur(e,k,P,[t],[])}function xi(t,e,r,n){return e&&"boolean"!=typeof e&&Hr(t,e,r)?e=!1:"function"==typeof e&&(n=r,r=e,e=!1),"function"==typeof r?xe(t,e,or(r,n,1)):xe(t,e)}function Ti(t,e,r){return"function"==typeof e?xe(t,!0,or(e,r,1)):xe(t,!0)}function Ci(t,e){return t>e}function Ei(t,e){return t>=e}function wi(t){return y(t)&&$r(t)&&ea.call(t,"callee")&&!ca.call(t,"callee")}function Ri(t){return t===!0||t===!1||y(t)&&na.call(t)==Z}function Pi(t){return y(t)&&na.call(t)==$}function Di(t){return!!t&&1===t.nodeType&&y(t)&&!Bi(t)}function Mi(t){return null==t?!0:$r(t)&&(Ms(t)||zi(t)||wi(t)||y(t)&&Ii(t.splice))?!t.length:!Bs(t).length}function Si(t,e,r,n){r="function"==typeof r?or(r,n,3):P;var i=r?r(t,e):P;return i===P?Fe(t,e,r):!!i}function Ai(t){return y(t)&&"string"==typeof t.message&&na.call(t)==K}function Li(t){return"number"==typeof t&&_a(t)}function Ii(t){return ki(t)&&na.call(t)==H}function ki(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Fi(t,e,r,n){return r="function"==typeof r?or(r,n,3):P,Oe(t,Yr(e),r)}function Ui(t){return Xi(t)&&t!=+t}function Oi(t){return null==t?!1:Ii(t)?oa.test(ta.call(t)):y(t)&&Ut.test(t)}function Ni(t){return null===t}function Xi(t){return"number"==typeof t||y(t)&&na.call(t)==tt}function Bi(t){var e;if(!y(t)||na.call(t)!=et||wi(t)||!ea.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e)))return!1;var r;return Se(t,function(t,e){r=e}),r===P||ea.call(t,r)}function ji(t){return ki(t)&&na.call(t)==rt}function zi(t){return"string"==typeof t||y(t)&&na.call(t)==it}function Yi(t){return y(t)&&en(t.length)&&!!Gt[na.call(t)]}function Gi(t){return t===P}function qi(t,e){return e>t}function Wi(t,e){return e>=t}function Vi(t){var e=t?za(t):0;return en(e)?e?te(t):[]:oo(t)}function Qi(t){return ye(t,to(t))}function Zi(t,e,r){var n=Fa(t);return r&&Hr(t,e,r)&&(e=P),e?me(n,e):n}function $i(t){return Ie(t,to(t))}function Ki(t,e,r){var n=null==t?P:ke(t,fn(e),e+"");return n===P?r:n}function Hi(t,e){if(null==t)return!1;var r=ea.call(t,e);if(!r&&!Jr(e)){if(e=fn(e),t=1==e.length?t:ke(t,Qe(e,0,-1)),null==t)return!1;e=Rn(e),r=ea.call(t,e)}return r||en(t.length)&&Kr(e,t.length)&&(Ms(t)||wi(t))}function Ji(t,e,r){r&&Hr(t,e,r)&&(e=P);for(var n=-1,i=Bs(t),o=i.length,a={};++n<o;){var s=i[n],u=t[s];e?ea.call(a,u)?a[u].push(s):a[u]=[s]:a[u]=s}return a}function to(t){if(null==t)return[];ki(t)||(t=Vo(t));var e=t.length;e=e&&en(e)&&(Ms(t)||wi(t))&&e||0;for(var r=t.constructor,n=-1,i="function"==typeof r&&r.prototype===t,o=jo(e),a=e>0;++n<e;)o[n]=n+"";for(var s in t)a&&Kr(s,e)||"constructor"==s&&(i||!ea.call(t,s))||o.push(s);return o}function eo(t){t=hn(t);for(var e=-1,r=Bs(t),n=r.length,i=jo(n);++e<n;){var o=r[e];i[e]=[o,t[o]]}return i}function ro(t,e,r){var n=null==t?P:t[e];return n===P&&(null==t||Jr(e,t)||(e=fn(e),t=1==e.length?t:ke(t,Qe(e,0,-1)),n=null==t?P:t[Rn(e)]),n=n===P?r:n),Ii(n)?n.call(t):n}function no(t,e,r){if(null==t)return t;var n=e+"";e=null!=t[n]||Jr(e,t)?[n]:fn(e);for(var i=-1,o=e.length,a=o-1,s=t;null!=s&&++i<o;){var u=e[i];ki(s)&&(i==a?s[u]=r:null==s[u]&&(s[u]=Kr(e[i+1])?[]:{})),s=s[u]}return t}function io(t,e,r,n){var i=Ms(t)||Yi(t);if(e=Br(e,n,4),null==r)if(i||ki(t)){var o=t.constructor;r=i?Ms(t)?new o:[]:Fa(Ii(o)?o.prototype:P)}else r={};return(i?ee:Ae)(t,function(t,n,i){return e(r,t,n,i)}),r}function oo(t){return tr(t,Bs(t))}function ao(t){return tr(t,to(t))}function so(t,e,r){return e=+e||0,r===P?(r=e,e=0):r=+r||0,t>=Ca(e,r)&&t<Ta(e,r)}function uo(t,e,r){r&&Hr(t,e,r)&&(e=r=P);var n=null==t,i=null==e;if(null==r&&(i&&"boolean"==typeof t?(r=t,t=1):"boolean"==typeof e&&(r=e,i=!0)),n&&i&&(e=1,i=!1),t=+t||0,i?(e=t,t=0):e=+e||0,r||t%1||e%1){var o=Ra();return Ca(t+o*(e-t+ua("1e-"+((o+"").length-1))),e)}return We(t,e)}function lo(t){return t=l(t),t&&t.charAt(0).toUpperCase()+t.slice(1)}function co(t){return t=l(t),t&&t.replace(Nt,p).replace(At,"")}function ho(t,e,r){t=l(t),e+="";var n=t.length;return r=r===P?n:Ca(0>r?0:+r||0,n),r-=e.length,r>=0&&t.indexOf(e,r)==r}function fo(t){return t=l(t),t&&Tt.test(t)?t.replace(_t,d):t}function go(t){return t=l(t),t&&St.test(t)?t.replace(Mt,v):t||"(?:)"}function po(t,e,r){t=l(t),e=+e;var n=t.length;if(n>=e||!_a(e))return t;var i=(e-n)/2,o=ba(i),a=va(i);return r=Lr("",a,r),r.slice(0,o)+t+r}function vo(t,e,r){return(r?Hr(t,e,r):null==e)?e=0:e&&(e=+e),t=_o(t),wa(t,e||(Ft.test(t)?16:10))}function mo(t,e){var r="";if(t=l(t),e=+e,1>e||!t||!_a(e))return r;do e%2&&(r+=t),e=ba(e/2),t+=t;while(e);return r}function bo(t,e,r){return t=l(t),r=null==r?0:Ca(0>r?0:+r||0,t.length),t.lastIndexOf(e,r)==r}function yo(t,r,n){var i=e.templateSettings;n&&Hr(t,r,n)&&(r=n=P),t=l(t),r=ve(me({},n||r),i,de);var o,a,s=ve(me({},r.imports),i.imports,de),u=Bs(s),c=tr(s,u),h=0,f=r.interpolate||Xt,g="__p += '",p=Qo((r.escape||Xt).source+"|"+f.source+"|"+(f===wt?It:Xt).source+"|"+(r.evaluate||Xt).source+"|$","g"),d="//# sourceURL="+("sourceURL"in r?r.sourceURL:"lodash.templateSources["+ ++Yt+"]")+"\n";t.replace(p,function(e,r,n,i,s,u){return n||(n=i),g+=t.slice(h,u).replace(Bt,m),r&&(o=!0,g+="' +\n__e("+r+") +\n'"),s&&(a=!0,g+="';\n"+s+";\n__p += '"),n&&(g+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),h=u+e.length,e}),g+="';\n";var v=r.variable;v||(g="with (obj) {\n"+g+"\n}\n"),g=(a?g.replace(vt,""):g).replace(mt,"$1").replace(bt,"$1;"),g="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+g+"return __p\n}";var b=Ks(function(){return Go(u,d+"return "+g).apply(P,c)});if(b.source=g,Ai(b))throw b;return b}function _o(t,e,r){var n=t;return(t=l(t))?(r?Hr(n,e,r):null==e)?t.slice(C(t),E(t)+1):(e+="",t.slice(c(t,e),h(t,e)+1)):t}function xo(t,e,r){var n=t;return t=l(t),t?(r?Hr(n,e,r):null==e)?t.slice(C(t)):t.slice(c(t,e+"")):t}function To(t,e,r){var n=t;return t=l(t),t?(r?Hr(n,e,r):null==e)?t.slice(0,E(t)+1):t.slice(0,h(t,e+"")+1):t}function Co(t,e,r){r&&Hr(t,e,r)&&(e=P);var n=N,i=X;if(null!=e)if(ki(e)){var o="separator"in e?e.separator:o;n="length"in e?+e.length||0:n,i="omission"in e?l(e.omission):i}else n=+e||0;if(t=l(t),n>=t.length)return t;var a=n-i.length;if(1>a)return i;var s=t.slice(0,a);if(null==o)return s+i;if(ji(o)){if(t.slice(a).search(o)){var u,c,h=t.slice(0,a);for(o.global||(o=Qo(o.source,(kt.exec(o)||"")+"g")),o.lastIndex=0;u=o.exec(h);)c=u.index;s=s.slice(0,null==c?a:c)}}else if(t.indexOf(o,a)!=a){var f=s.lastIndexOf(o);f>-1&&(s=s.slice(0,f))}return s+i}function Eo(t){return t=l(t),t&&xt.test(t)?t.replace(yt,w):t}function wo(t,e,r){return r&&Hr(t,e,r)&&(e=P),t=l(t),t.match(e||jt)||[]}function Ro(t,e,r){return r&&Hr(t,e,r)&&(e=P),y(t)?Mo(t):_e(t,e)}function Po(t){return function(){return t}}function Do(t){return t}function Mo(t){return Xe(xe(t,!0))}function So(t,e){return Be(t,xe(e,!0))}function Ao(t,e,r){if(null==r){var n=ki(e),i=n?Bs(e):P,o=i&&i.length?Ie(e,i):P;(o?o.length:n)||(o=!1,r=e,e=t,t=this)}o||(o=Ie(e,Bs(e)));var a=!0,s=-1,u=Ii(t),l=o.length;r===!1?a=!1:ki(r)&&"chain"in r&&(a=r.chain);for(;++s<l;){var c=o[s],h=e[c];t[c]=h,u&&(t.prototype[c]=function(e){return function(){var r=this.__chain__;if(a||r){var n=t(this.__wrapped__),i=n.__actions__=te(this.__actions__);return i.push({func:e,args:arguments,thisArg:t}),n.__chain__=r,n}return e.apply(t,le([this.value()],arguments))}}(h))}return t}function Lo(){return ne._=ia,this}function Io(){}function ko(t){return Jr(t)?Ye(t):Ge(t)}function Fo(t){return function(e){return ke(t,fn(e),e+"")}}function Uo(t,e,r){r&&Hr(t,e,r)&&(e=r=P),t=+t||0,r=null==r?1:+r||0,null==e?(e=t,t=0):e=+e||0;for(var n=-1,i=Ta(va((e-t)/(r||1)),0),o=jo(i);++n<i;)o[n]=t,t+=r;return o}function Oo(t,e,r){if(t=ba(t),1>t||!_a(t))return[];var n=-1,i=jo(Ca(t,Ma));for(e=or(e,r,1);++n<t;)Ma>n?i[n]=e(n):e(n);return i}function No(t){var e=++ra;return l(t)+e}function Xo(t,e){return(+t||0)+(+e||0)}function Bo(t,e,r){return r&&Hr(t,e,r)&&(e=P),e=Br(e,r,3),1==e.length?ge(Ms(t)?t:cn(t),e):He(t,e)}t=t?ie.defaults(ne.Object(),t,ie.pick(ne,zt)):ne;var jo=t.Array,zo=t.Date,Yo=t.Error,Go=t.Function,qo=t.Math,Wo=t.Number,Vo=t.Object,Qo=t.RegExp,Zo=t.String,$o=t.TypeError,Ko=jo.prototype,Ho=Vo.prototype,Jo=Zo.prototype,ta=Go.prototype.toString,ea=Ho.hasOwnProperty,ra=0,na=Ho.toString,ia=ne._,oa=Qo("^"+ta.call(ea).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),aa=t.ArrayBuffer,sa=t.clearTimeout,ua=t.parseFloat,la=qo.pow,ca=Ho.propertyIsEnumerable,ha=Gr(t,"Set"),fa=t.setTimeout,ga=Ko.splice,pa=t.Uint8Array,da=Gr(t,"WeakMap"),va=qo.ceil,ma=Gr(Vo,"create"),ba=qo.floor,ya=Gr(jo,"isArray"),_a=t.isFinite,xa=Gr(Vo,"keys"),Ta=qo.max,Ca=qo.min,Ea=Gr(zo,"now"),wa=t.parseInt,Ra=qo.random,Pa=Wo.NEGATIVE_INFINITY,Da=Wo.POSITIVE_INFINITY,Ma=4294967295,Sa=Ma-1,Aa=Ma>>>1,La=9007199254740991,Ia=da&&new da,ka={};e.support={};e.templateSettings={escape:Ct,evaluate:Et,interpolate:wt,variable:"",imports:{_:e}};var Fa=function(){function t(){}return function(e){if(ki(e)){t.prototype=e;var r=new t;t.prototype=P}return r||{}}}(),Ua=hr(Ae),Oa=hr(Le,!0),Na=fr(),Xa=fr(!0),Ba=Ia?function(t,e){return Ia.set(t,e),t}:Do,ja=Ia?function(t){return Ia.get(t)}:Io,za=Ye("length"),Ya=function(){var t=0,e=0;return function(r,n){var i=ds(),o=j-(i-e);if(e=i,o>0){if(++t>=B)return r}else t=0;return Ba(r,n)}}(),Ga=mi(function(t,e){return y(t)&&$r(t)?Ce(t,Me(e,!1,!0)):[]}),qa=xr(),Wa=xr(!0),Va=mi(function(t){for(var e=t.length,r=e,n=jo(h),i=zr(),o=i==s,a=[];r--;){var u=t[r]=$r(u=t[r])?u:[];n[r]=o&&u.length>=120?pr(r&&u):null}var l=t[0],c=-1,h=l?l.length:0,f=n[0];t:for(;++c<h;)if(u=l[c],(f?Kt(f,u):i(a,u,0))<0){for(var r=e;--r;){var g=n[r];if((g?Kt(g,u):i(t[r],u,0))<0)continue t}f&&f.push(u),a.push(u)}return a}),Qa=mi(function(t,e){e=Me(e);var r=be(t,e);return qe(t,e.sort(o)),r}),Za=Fr(),$a=Fr(!0),Ka=mi(function(t){return Je(Me(t,!1,!0))}),Ha=mi(function(t,e){return $r(t)?Ce(t,e):[]}),Ja=mi(On),ts=mi(function(t){var e=t.length,r=e>2?t[e-2]:P,n=e>1?t[e-1]:P;return e>2&&"function"==typeof r?e-=2:(r=e>1&&"function"==typeof n?(--e,n):P,n=P),t.length=e,Nn(t,r,n)}),es=mi(function(t){return t=Me(t),this.thru(function(e){return Jt(Ms(e)?e:[hn(e)],t)})}),rs=mi(function(t,e){return be(t,Me(e))}),ns=lr(function(t,e,r){ea.call(t,r)?++t[r]:t[r]=1}),is=_r(Ua),os=_r(Oa,!0),as=Er(ee,Ua),ss=Er(re,Oa),us=lr(function(t,e,r){ea.call(t,r)?t[r].push(e):t[r]=[e]}),ls=lr(function(t,e,r){t[r]=e}),cs=mi(function(t,e,r){var n=-1,i="function"==typeof e,o=Jr(e),a=$r(t)?jo(t.length):[];return Ua(t,function(t){var s=i?e:o&&null!=t?t[e]:P;a[++n]=s?s.apply(t,r):Zr(t,e,r)}),a}),hs=lr(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]}),fs=Sr(ce,Ua),gs=Sr(he,Oa),ps=mi(function(t,e){if(null==t)return[];var r=e[2];return r&&Hr(e[0],e[1],r)&&(e.length=1),Ke(t,Me(e),[])}),ds=Ea||function(){return(new zo).getTime()},vs=mi(function(t,e,r){var n=M;if(r.length){var i=x(r,vs.placeholder);n|=k}return Ur(t,n,e,r,i)}),ms=mi(function(t,e){e=e.length?Me(e):$i(t);for(var r=-1,n=e.length;++r<n;){var i=e[r];t[i]=Ur(t[i],M,t)}return t}),bs=mi(function(t,e,r){var n=M|S;if(r.length){var i=x(r,bs.placeholder);n|=k}return Ur(e,n,t,r,i)}),ys=mr(L),_s=mr(I),xs=mi(function(t,e){return Te(t,1,e)}),Ts=mi(function(t,e,r){return Te(t,e,r)}),Cs=Cr(),Es=Cr(!0),ws=mi(function(t,e){if(e=Me(e),"function"!=typeof t||!oe(e,u))throw new $o(q);var r=e.length;return mi(function(n){for(var i=Ca(n.length,r);i--;)n[i]=e[i](n[i]);return t.apply(this,n)})}),Rs=Mr(k),Ps=Mr(F),Ds=mi(function(t,e){return Ur(t,O,P,P,P,Me(e))}),Ms=ya||function(t){return y(t)&&en(t.length)&&na.call(t)==Q},Ss=cr(je),As=cr(function(t,e,r){return r?ve(t,e,r):me(t,e)}),Ls=br(As,pe),Is=br(Ss,on),ks=Tr(Ae),Fs=Tr(Le),Us=wr(Na),Os=wr(Xa),Ns=Rr(Ae),Xs=Rr(Le),Bs=xa?function(t){var e=null==t?P:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&$r(t)?ln(t):ki(t)?xa(t):[]}:ln,js=Pr(!0),zs=Pr(),Ys=mi(function(t,e){if(null==t)return{};if("function"!=typeof e[0]){var e=ue(Me(e),Zo);return an(t,Ce(to(t),e))}var r=or(e[0],e[1],3);return sn(t,function(t,e,n){return!r(t,e,n)})}),Gs=mi(function(t,e){return null==t?{}:"function"==typeof e[0]?sn(t,or(e[0],e[1],3)):an(t,Me(e))}),qs=dr(function(t,e,r){return e=e.toLowerCase(),t+(r?e.charAt(0).toUpperCase()+e.slice(1):e)}),Ws=dr(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()}),Vs=Dr(),Qs=Dr(!0),Zs=dr(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()}),$s=dr(function(t,e,r){return t+(r?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}),Ks=mi(function(t,e){try{return t.apply(P,e)}catch(r){return Ai(r)?r:new Yo(r)}}),Hs=mi(function(t,e){return function(r){return Zr(r,t,e)}}),Js=mi(function(t,e){return function(r){return Zr(t,r,e)}}),tu=kr("ceil"),eu=kr("floor"),ru=yr(Ci,Pa),nu=yr(qi,Da),iu=kr("round");return e.prototype=r.prototype,n.prototype=Fa(r.prototype),n.prototype.constructor=n,i.prototype=Fa(r.prototype),i.prototype.constructor=i,ot.prototype["delete"]=Wt,ot.prototype.get=Vt,ot.prototype.has=Qt,ot.prototype.set=Zt,$t.prototype.push=Ht,pi.Cache=ot,e.after=ci,e.ary=hi,e.assign=As,e.at=rs,
e.before=fi,e.bind=vs,e.bindAll=ms,e.bindKey=bs,e.callback=Ro,e.chain=jn,e.chunk=pn,e.compact=dn,e.constant=Po,e.countBy=ns,e.create=Zi,e.curry=ys,e.curryRight=_s,e.debounce=gi,e.defaults=Ls,e.defaultsDeep=Is,e.defer=xs,e.delay=Ts,e.difference=Ga,e.drop=vn,e.dropRight=mn,e.dropRightWhile=bn,e.dropWhile=yn,e.fill=_n,e.filter=Kn,e.flatten=Tn,e.flattenDeep=Cn,e.flow=Cs,e.flowRight=Es,e.forEach=as,e.forEachRight=ss,e.forIn=Us,e.forInRight=Os,e.forOwn=Ns,e.forOwnRight=Xs,e.functions=$i,e.groupBy=us,e.indexBy=ls,e.initial=wn,e.intersection=Va,e.invert=Ji,e.invoke=cs,e.keys=Bs,e.keysIn=to,e.map=ti,e.mapKeys=js,e.mapValues=zs,e.matches=Mo,e.matchesProperty=So,e.memoize=pi,e.merge=Ss,e.method=Hs,e.methodOf=Js,e.mixin=Ao,e.modArgs=ws,e.negate=di,e.omit=Ys,e.once=vi,e.pairs=eo,e.partial=Rs,e.partialRight=Ps,e.partition=hs,e.pick=Gs,e.pluck=ei,e.property=ko,e.propertyOf=Fo,e.pull=Dn,e.pullAt=Qa,e.range=Uo,e.rearg=Ds,e.reject=ri,e.remove=Mn,e.rest=Sn,e.restParam=mi,e.set=no,e.shuffle=ii,e.slice=An,e.sortBy=si,e.sortByAll=ps,e.sortByOrder=ui,e.spread=bi,e.take=Ln,e.takeRight=In,e.takeRightWhile=kn,e.takeWhile=Fn,e.tap=zn,e.throttle=yi,e.thru=Yn,e.times=Oo,e.toArray=Vi,e.toPlainObject=Qi,e.transform=io,e.union=Ka,e.uniq=Un,e.unzip=On,e.unzipWith=Nn,e.values=oo,e.valuesIn=ao,e.where=li,e.without=Ha,e.wrap=_i,e.xor=Xn,e.zip=Ja,e.zipObject=Bn,e.zipWith=ts,e.backflow=Es,e.collect=ti,e.compose=Es,e.each=as,e.eachRight=ss,e.extend=As,e.iteratee=Ro,e.methods=$i,e.object=Bn,e.select=Kn,e.tail=Sn,e.unique=Un,Ao(e,e),e.add=Xo,e.attempt=Ks,e.camelCase=qs,e.capitalize=lo,e.ceil=tu,e.clone=xi,e.cloneDeep=Ti,e.deburr=co,e.endsWith=ho,e.escape=fo,e.escapeRegExp=go,e.every=$n,e.find=is,e.findIndex=qa,e.findKey=ks,e.findLast=os,e.findLastIndex=Wa,e.findLastKey=Fs,e.findWhere=Hn,e.first=xn,e.floor=eu,e.get=Ki,e.gt=Ci,e.gte=Ei,e.has=Hi,e.identity=Do,e.includes=Jn,e.indexOf=En,e.inRange=so,e.isArguments=wi,e.isArray=Ms,e.isBoolean=Ri,e.isDate=Pi,e.isElement=Di,e.isEmpty=Mi,e.isEqual=Si,e.isError=Ai,e.isFinite=Li,e.isFunction=Ii,e.isMatch=Fi,e.isNaN=Ui,e.isNative=Oi,e.isNull=Ni,e.isNumber=Xi,e.isObject=ki,e.isPlainObject=Bi,e.isRegExp=ji,e.isString=zi,e.isTypedArray=Yi,e.isUndefined=Gi,e.kebabCase=Ws,e.last=Rn,e.lastIndexOf=Pn,e.lt=qi,e.lte=Wi,e.max=ru,e.min=nu,e.noConflict=Lo,e.noop=Io,e.now=ds,e.pad=po,e.padLeft=Vs,e.padRight=Qs,e.parseInt=vo,e.random=uo,e.reduce=fs,e.reduceRight=gs,e.repeat=mo,e.result=ro,e.round=iu,e.runInContext=R,e.size=oi,e.snakeCase=Zs,e.some=ai,e.sortedIndex=Za,e.sortedLastIndex=$a,e.startCase=$s,e.startsWith=bo,e.sum=Bo,e.template=yo,e.trim=_o,e.trimLeft=xo,e.trimRight=To,e.trunc=Co,e.unescape=Eo,e.uniqueId=No,e.words=wo,e.all=$n,e.any=ai,e.contains=Jn,e.eq=Si,e.detect=is,e.foldl=fs,e.foldr=gs,e.head=xn,e.include=Jn,e.inject=fs,Ao(e,function(){var t={};return Ae(e,function(r,n){e.prototype[n]||(t[n]=r)}),t}(),!1),e.sample=ni,e.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return ni(e,t)}):ni(this.value())},e.VERSION=D,ee(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){e[t].placeholder=e}),ee(["drop","take"],function(t,e){i.prototype[t]=function(r){var n=this.__filtered__;if(n&&!e)return new i(this);r=null==r?1:Ta(ba(r)||0,0);var o=this.clone();return n?o.__takeCount__=Ca(o.__takeCount__,r):o.__views__.push({size:r,type:t+(o.__dir__<0?"Right":"")}),o},i.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),ee(["filter","map","takeWhile"],function(t,e){var r=e+1,n=r!=G;i.prototype[t]=function(t,e){var i=this.clone();return i.__iteratees__.push({iteratee:Br(t,e,1),type:r}),i.__filtered__=i.__filtered__||n,i}}),ee(["first","last"],function(t,e){var r="take"+(e?"Right":"");i.prototype[t]=function(){return this[r](1).value()[0]}}),ee(["initial","rest"],function(t,e){var r="drop"+(e?"":"Right");i.prototype[t]=function(){return this.__filtered__?new i(this):this[r](1)}}),ee(["pluck","where"],function(t,e){var r=e?"filter":"map",n=e?Xe:ko;i.prototype[t]=function(t){return this[r](n(t))}}),i.prototype.compact=function(){return this.filter(Do)},i.prototype.reject=function(t,e){return t=Br(t,e,1),this.filter(function(e){return!t(e)})},i.prototype.slice=function(t,e){t=null==t?0:+t||0;var r=this;return r.__filtered__&&(t>0||0>e)?new i(r):(0>t?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==P&&(e=+e||0,r=0>e?r.dropRight(-e):r.take(e-t)),r)},i.prototype.takeRightWhile=function(t,e){return this.reverse().takeWhile(t,e).reverse()},i.prototype.toArray=function(){return this.take(Da)},Ae(i.prototype,function(t,r){var o=/^(?:filter|map|reject)|While$/.test(r),a=/^(?:first|last)$/.test(r),s=e[a?"take"+("last"==r?"Right":""):r];s&&(e.prototype[r]=function(){var e=a?[1]:arguments,r=this.__chain__,u=this.__wrapped__,l=!!this.__actions__.length,c=u instanceof i,h=e[0],f=c||Ms(u);f&&o&&"function"==typeof h&&1!=h.length&&(c=f=!1);var g=function(t){return a&&r?s(t,1)[0]:s.apply(P,le([t],e))},p={func:Yn,args:[g],thisArg:P},d=c&&!l;if(a&&!r)return d?(u=u.clone(),u.__actions__.push(p),t.call(u)):s.call(P,this.value())[0];if(!a&&f){u=d?u:new i(this);var v=t.apply(u,e);return v.__actions__.push(p),new n(v,r)}return this.thru(g)})}),ee(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var r=(/^(?:replace|split)$/.test(t)?Jo:Ko)[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:join|pop|replace|shift)$/.test(t);e.prototype[t]=function(){var t=arguments;return i&&!this.__chain__?r.apply(this.value(),t):this[n](function(e){return r.apply(e,t)})}}),Ae(i.prototype,function(t,r){var n=e[r];if(n){var i=n.name,o=ka[i]||(ka[i]=[]);o.push({name:r,func:n})}}),ka[Ar(P,S).name]=[{name:"wrapper",func:P}],i.prototype.clone=_,i.prototype.reverse=J,i.prototype.value=nt,e.prototype.chain=Gn,e.prototype.commit=qn,e.prototype.concat=es,e.prototype.plant=Wn,e.prototype.reverse=Vn,e.prototype.toString=Qn,e.prototype.run=e.prototype.toJSON=e.prototype.valueOf=e.prototype.value=Zn,e.prototype.collect=e.prototype.map,e.prototype.head=e.prototype.first,e.prototype.select=e.prototype.filter,e.prototype.tail=e.prototype.rest,e}var P,D="3.10.1",M=1,S=2,A=4,L=8,I=16,k=32,F=64,U=128,O=256,N=30,X="...",B=150,j=16,z=200,Y=1,G=2,q="Expected a function",W="__lodash_placeholder__",V="[object Arguments]",Q="[object Array]",Z="[object Boolean]",$="[object Date]",K="[object Error]",H="[object Function]",J="[object Map]",tt="[object Number]",et="[object Object]",rt="[object RegExp]",nt="[object Set]",it="[object String]",ot="[object WeakMap]",at="[object ArrayBuffer]",st="[object Float32Array]",ut="[object Float64Array]",lt="[object Int8Array]",ct="[object Int16Array]",ht="[object Int32Array]",ft="[object Uint8Array]",gt="[object Uint8ClampedArray]",pt="[object Uint16Array]",dt="[object Uint32Array]",vt=/\b__p \+= '';/g,mt=/\b(__p \+=) '' \+/g,bt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yt=/&(?:amp|lt|gt|quot|#39|#96);/g,_t=/[&<>"'`]/g,xt=RegExp(yt.source),Tt=RegExp(_t.source),Ct=/<%-([\s\S]+?)%>/g,Et=/<%([\s\S]+?)%>/g,wt=/<%=([\s\S]+?)%>/g,Rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,Pt=/^\w*$/,Dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,Mt=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,St=RegExp(Mt.source),At=/[\u0300-\u036f\ufe20-\ufe23]/g,Lt=/\\(\\)?/g,It=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,kt=/\w*$/,Ft=/^0[xX]/,Ut=/^\[object .+?Constructor\]$/,Ot=/^\d+$/,Nt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Xt=/($^)/,Bt=/['\n\r\u2028\u2029\\]/g,jt=function(){var t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",e="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(t+"+(?="+t+e+")|"+t+"?"+e+"|"+t+"+|[0-9]+","g")}(),zt=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],Yt=-1,Gt={};Gt[st]=Gt[ut]=Gt[lt]=Gt[ct]=Gt[ht]=Gt[ft]=Gt[gt]=Gt[pt]=Gt[dt]=!0,Gt[V]=Gt[Q]=Gt[at]=Gt[Z]=Gt[$]=Gt[K]=Gt[H]=Gt[J]=Gt[tt]=Gt[et]=Gt[rt]=Gt[nt]=Gt[it]=Gt[ot]=!1;var qt={};qt[V]=qt[Q]=qt[at]=qt[Z]=qt[$]=qt[st]=qt[ut]=qt[lt]=qt[ct]=qt[ht]=qt[tt]=qt[et]=qt[rt]=qt[it]=qt[ft]=qt[gt]=qt[pt]=qt[dt]=!0,qt[K]=qt[H]=qt[J]=qt[nt]=qt[ot]=!1;var Wt={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},Vt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Qt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Zt={"function":!0,object:!0},$t={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Kt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ht=Zt[typeof e]&&e&&!e.nodeType&&e,Jt=Zt[typeof t]&&t&&!t.nodeType&&t,te=Ht&&Jt&&"object"==typeof i&&i&&i.Object&&i,ee=Zt[typeof self]&&self&&self.Object&&self,re=Zt[typeof window]&&window&&window.Object&&window,ne=(Jt&&Jt.exports===Ht&&Ht,te||re!==(this&&this.window)&&re||ee||this),ie=R();ne._=ie,n=function(){return ie}.call(e,r,e,t),!(n!==P&&(t.exports=n))}).call(this)}).call(e,r(14)(t),function(){return this}())},function(t,e,r){var n,i;!function(o,a){"object"==typeof t&&t.exports?t.exports=a(r(16)):(n=[r(16)],i=function(t){return a(t,o)}.apply(e,n),!(void 0!==i&&(t.exports=i)))}(this,function(t,e,r){function n(e){return t.isArray(e)?"array":t.isDate(e)?"date":t.isRegExp(e)?"regex":typeof e}function i(t){var e=n(t);return u[e]?e:"*"}function o(e){return t.each(a.call(arguments,1),function(r){t.each(r,function(t,r){u[i(t)](e,r,t)})}),e}var a=Array.prototype.slice,s=function(){for(var t=a.call(arguments,0);t.length;)s.rivet(t.shift())},u={"*":function(t,e,r){t[e]=r},object:function(t,e,r){t[e]=o(t[e]||{},r)},array:function(e,r,n){e[r]=[],t.each(n,function(t,n){u[i(t)](e[r],n,t)},this)}};return s.rivet=function(t){t.hasOwnProperty("extend")||(t.extend=function(e,r,n){return s.extend(t,e,r,n)}),t.hasOwnProperty("compose")||(t.compose=function(){return s.compose.apply(this,[t].concat(a.call(arguments,0)))}),t.hasOwnProperty("inherits")||(t.inherits=function(e,r,n){return s.inherits(t,e,r,n)}),t.hasOwnProperty("mixin")||(t.mixin=function(){return s.mixin.apply(this,[t].concat(a.call(arguments,0)))}),t.hasOwnProperty("punch")||(t.punch=function(){return s.punch.apply(this,[t].concat(a.call(arguments,0)))})},s.inherits=function(e,r,n,i){i=i||{};var a,u=function(){},l=function(){r.apply(this,arguments)};return"object"==typeof e?(e.hasOwnProperty("constructor")&&(l=e.constructor),a=e):(l=e,a=e.prototype),s.rivet(l),i.deep?o(l,r,n):t.defaults(l,r,n),u.prototype=r.prototype,l.prototype=new u,i.deep?o(l.prototype,a,{constructor:l}):t.extend(l.prototype,a,{constructor:l}),l.__super=r,l.__super__=r.prototype,l},s.extend=function(t,e,r,n){return s.inherits(e,t,r,n)},s.compose=function(){var e=a.call(arguments,0),r=e.shift();s.rivet(r);var n=t.reduce(e,function(t,e){return e.hasOwnProperty("_preInit")&&t.preInit.push(e._preInit),e.hasOwnProperty("_postInit")&&t.postInit.push(e._postInit),e=e.mixin||e,t.items.push(e),t},{items:[],preInit:[],postInit:[]}),i=r.extend({constructor:function(){var e=a.call(arguments,0);t.each(n.preInit,function(t){t.apply(this,e)},this),r.prototype.constructor.apply(this,e),t.each(n.postInit,function(t){t.apply(this,e)},this)}});return s.rivet(i),t.defaults(i.prototype,t.extend.apply(null,[{}].concat(n.items))),i},s.mixin=function(){var e=a.call(arguments,0),r=e.shift();return s.rivet(r),t.defaults(r.prototype,t.extend.apply(null,[{}].concat(e))),r},s.punch=function(){var e=a.call(arguments,0),r=e.shift();return s.rivet(r),t.extend(r.prototype,t.extend.apply(null,[{}].concat(e))),r},s})},function(t,e,r){function n(t,e,r){if(null!=t&&t.length){if(t.length&&!e)return Math.max.apply(Math,t);e=i(e,r);for(var n,o,a,s=-(1/0),u=-1,l=t.length;++u<l;)o=t[u],a=e(o,u,t),a>s&&(s=a,n=o);return n}return 1/0}var i=r(55);t.exports=n},function(t,e){function r(t){return t}t.exports=r},function(t,e,r){function n(t,e){if(null==t)return i;switch(typeof t){case"function":return"undefined"!=typeof e?function(r,n,i){return t.call(e,r,n,i)}:t;case"object":return function(e){return a(e,t)};case"string":case"number":return o(t)}}var i=r(54),o=r(56),a=r(60);t.exports=n},function(t,e){function r(t){return function(e){return e[t]}}t.exports=r},function(t,e,r){var n=r(58),i=Array.isArray||function(t){return n(t,"Array")};t.exports=i},function(t,e,r){function n(t,e){return i(t)===e}var i=r(59);t.exports=n},function(t,e){function r(t){return null===t?"Null":t===n?"Undefined":i.exec(o.call(t))[1]}var n,i=/^\[object (.*)\]$/,o=Object.prototype.toString;t.exports=r},function(t,e,r){function n(t,e){for(var r=-1,n=t.length;++r<n;)if(a(t[r],e))return!0;return!1}function i(t,e){for(var r=-1,i=e.length;++r<i;)if(!n(t,e[r]))return!1;return!0}function o(t,e){var r=!0;return s(e,function(e,n){return a(t[n],e)?void 0:r=!1}),r}function a(t,e){return t&&"object"==typeof t?u(t)&&u(e)?i(t,e):o(t,e):t===e}var s=r(17),u=r(57);t.exports=a},function(t,e,r){function n(){s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=!0;for(var t in{toString:null})a=!1}function i(t,e,r){var i,l=0;null==a&&n();for(i in t)if(o(e,t,i,r)===!1)break;if(a)for(var c=t.constructor,h=!!c&&t===c.prototype;(i=s[l++])&&("constructor"===i&&(h||!u(t,i))||t[i]===Object.prototype[i]||o(e,t,i,r)!==!1););}function o(t,e,r,n){return t.call(n,e[r],r,e)}var a,s,u=r(8);t.exports=i},function(t,e,r){function n(t){var e=[];return i(t,function(t,r){e.push(t)}),e}var i=r(17);t.exports=n},function(t,e,r){var n,i;n=[r(64)],i=function(t){function e(e,r){return-1!==t(e,r)}return e}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n;n=function(){function t(t,e,r){if(r=r||0,null==t)return-1;for(var n=t.length,i=0>r?n+r:r;n>i;){if(t[i]===e)return i;i++}return-1}return t}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))},function(t,e,r){var n,i;n=[r(9),r(18),r(71)],i=function(t,e,r){function n(e){switch(t(e)){case"Object":return i(e);case"Array":return s(e);case"RegExp":return o(e);case"Date":return a(e);default:return e}}function i(t){return e(t)?r({},t):t}function o(t){var e="";return e+=t.multiline?"m":"",e+=t.global?"g":"",e+=t.ignoreCase?"i":"",new RegExp(t.source,e)}function a(t){return new Date(+t)}function s(t){return t.slice()}return n}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(65),r(19),r(9),r(18)],i=function(t,e,r,n){function i(e,n){switch(r(e)){case"Object":return o(e,n);case"Array":return a(e,n);default:return t(e)}}function o(t,r){if(n(t)){var o={};return e(t,function(t,e){this[e]=i(t,r)},o),o}return r?r(t):t}function a(t,e){for(var r=[],n=-1,o=t.length;++n<o;)r[n]=i(t[n],e);return r}return i}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(9)],i=function(t){function e(e,r){return t(e)===r}return e}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(67)],i=function(t){function e(e){return t(e,"Object")}return e}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(10)],i=function(t){function e(){o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=!0;for(var t in{toString:null})i=!1}function r(r,a,s){var u,l=0;null==i&&e();for(u in r)if(n(a,r,u,s)===!1)break;if(i)for(var c=r.constructor,h=!!c&&r===c.prototype;(u=o[l++])&&("constructor"===u&&(h||!t(r,u))||r[u]===Object.prototype[u]||n(a,r,u,s)!==!1););}function n(t,e,r,n){return t.call(n,e[r],r,e)}var i,o;return r}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(10),r(66),r(68)],i=function(t,e,r){function n(){var i,o,a,s,u=1;for(s=e(arguments[0]);a=arguments[u++];)for(i in a)t(a,i)&&(o=a[i],r(o)&&r(s[i])?s[i]=n(s[i],o):s[i]=e(o));return s}return n}.apply(e,n),!(void 0!==i&&(t.exports=i))},function(t,e,r){var n,i;n=[r(19)],i=function(t){function e(e,n){for(var i,o=0,a=arguments.length;++o<a;)i=arguments[o],null!=i&&t(i,r,e);return e}function r(t,e){this[e]=t}return e}.apply(e,n),!(void 0!==i&&(t.exports=i))}]);